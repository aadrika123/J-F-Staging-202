import{j as e}from"./mui-105b4636.js";import{r as o,a as K,u as Q}from"./router-894402c5.js";import{M as X}from"./index-82be3ecd.js";import{R as U}from"./RazorpayPaymentScreen-2a07c9c0.js";import{W as M}from"./WaterApiList-a3ed6c50.js";import{i as D}from"./success-39308b33.js";import{i as z,c as ee,d as F,u as se,A as Y,R as J}from"./index-02c19d18.js";import{a as ne}from"./axios-67d8a945.js";import{a as H}from"./index.esm-9bec7f4a.js";import{a as Z}from"./index.esm-bc36f73a.js";const te="/assets/pending-daaf9508.png",le=l=>{var A,W,T,V,B,E,G,L,q,$;const[C,m]=o.useState(!1),[_,u]=o.useState(!1),[s,j]=o.useState(""),{notify:g}=o.useContext(z),{api_WaterGetDetailsById:O,header:v,api_rzpWaterOrderId:r}=M(),i=l==null?void 0:l.paymentData,x=t=>{if(!(t==null||t==""))return JSON.parse(t)},f=ee({isInstallment:F().required("Require"),installment:F().when([],{is:()=>n.values.isInstallment=="yes",then:F().required("Select Installment")})}),n=se({enableReinitialize:!0,initialValues:{isInstallment:"no",installment:""},onSubmit:t=>{N(t)},validationSchema:f}),b=t=>{var P,S,k;const c=t.target.name,R=t.target.value;R=="no"&&n.setFieldValue("installment",""),c=="installment"&&((P=x(R))==null?void 0:P.amount)==Number((S=s==null?void 0:s.calculation)==null?void 0:S.penalty)&&((k=s==null?void 0:s.calculation)==null?void 0:k.paidStatus)!=1&&(n.setFieldValue("installment",""),n.setFieldValue("isInstallment","no"))},p=()=>{l.closeModal()};o.useEffect(()=>{var t,c;((t=s==null?void 0:s.calculation)==null?void 0:t.paidStatus)==1&&((c=s==null?void 0:s.calculation)==null?void 0:c.chargeCatagoryId)==2&&n.setFieldValue("isInstallment","yes")},[s]);const a=()=>{var t;u(!0),ne.post(O,{applicationId:(t=i==null?void 0:i.connectionCharges)==null?void 0:t.applicationId},v).then(function(c){j(c.data.data),u(!1)}).catch(function(c){u(!1),g("Something Went Wrong","error")})};o.useEffect(()=>{a()},[i]);const d=t=>{(t==null?void 0:t.status)==!0?(l.fetchTransactionDetails(t),l.success(10),g("Payment Successful","success")):g("Payment Failed","error")},N=t=>{var P,S,k;let c;t.isInstallment=="yes"&&(c=((P=x(t==null?void 0:t.installment))==null?void 0:P.ids).split(","));const R={id:(S=i==null?void 0:i.connectionCharges)==null?void 0:S.applicationId,applycationType:(k=i==null?void 0:i.connectionCharges)==null?void 0:k.type,isInstallment:t.isInstallment,penaltyIds:c};m(!0),Y.post(r,R,v).then(I=>{m(!1),I.data.status==!0?U(I.data.data,d):g(I.data.message,"error")}).catch(I=>{m(!1),g(I.message,"error")})},y=t=>t==NaN||t==null?0:t;let h=0,w;return n.values.isInstallment=="yes"&&(w=0),n.values.isInstallment=="no"&&(w=Number((A=s==null?void 0:s.calculation)==null?void 0:A.penalty)/10),e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:n.handleSubmit,onChange:b,children:e.jsxs("div",{className:"bg-white #789fde shadow-2xl border border-red-200 p-5 rounded-md",children:[e.jsx("p",{onClick:p,className:"float-right absolute right-6 top-6 hover:bg-gray-300 bg-gray-200 p-1 cursor-pointer",children:e.jsx(H,{})}),e.jsxs("div",{className:"border-b-2  pl-3 font-semibold border-red-400 flex",children:[e.jsx(Z,{size:20,className:"mt-0.5 mr-1"}),"Regularization Payment"]}),e.jsx("p",{className:"text-center text-green-800 font-semibold",children:"Note: 10% rebate on penalty in case the whole penalty is paid"}),e.jsx("div",{className:"flex justify-center py-4",children:e.jsx("img",{src:"https://img.freepik.com/free-vector/hand-holding-phone-with-credit-card-screen-man-making-purchase-shopping-paying-online-using-banking-app-flat-vector-illustration-transaction-e-commerce-concept_74855-26014.jpg?w=1380&t=st=1686898919~exp=1686899519~hmac=4b0ddb44860ec647fa33a1a0416ea0c1cc8167693a13fdba3f09058d099f0e76",alt:"My Image",width:200,height:100})}),e.jsxs("div",{className:"flex items-center px-10",children:[e.jsx("div",{className:"font-semibold text-lg text-gray-500",children:e.jsx("p",{children:"Application No.-"})}),e.jsx("p",{className:"font-semibold text-lg text-gray-500",children:(W=i==null?void 0:i.connectionCharges)==null?void 0:W.applicationNo})]}),e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"font-semibold text-lg text-green-500",children:e.jsx("p",{children:"Total Amount ₹-"})}),e.jsxs("p",{className:"font-semibold text-lg text-green-500",children:[n.values.isInstallment==="yes"&&Number((T=s==null?void 0:s.calculation)==null?void 0:T.connectionFee)+Number(y((V=x(n.values.installment))==null?void 0:V.amount))-w,n.values.isInstallment==="no"&&Number((B=s==null?void 0:s.calculation)==null?void 0:B.connectionFee)+Number((E=s==null?void 0:s.calculation)==null?void 0:E.penalty)-w]})]}),e.jsxs("div",{className:"grid grid-cols-12 px-4 py-2 text-sm gap-y-2",children:[e.jsx("div",{className:"col-span-12 mt-2 text-gray-800",children:e.jsxs("div",{className:"grid grid-cols-12 text-base rounded",children:[e.jsxs("div",{className:"col-span-6 space-y-2",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Payment For:"})," ",(G=s==null?void 0:s.calculation)==null?void 0:G.chargeCatagory]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Connection Fee:"})," ₹"," ",(L=s==null?void 0:s.calculation)==null?void 0:L.connectionFee]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Penalty:"})," ₹"," ",(q=s==null?void 0:s.calculation)==null?void 0:q.penalty]})]}),e.jsxs("div",{className:"col-span-6",children:[e.jsxs("p",{className:"font-semibold",children:["Rebate: ₹ ",w]}),e.jsx("div",{className:"flex",children:e.jsxs("div",{children:[e.jsxs("label",{children:[e.jsx("span",{className:"font-semibold",children:"Installment Payment"}),e.jsx("input",{type:"radio",name:"isInstallment",value:"yes",checked:n.values.isInstallment==="yes",onChange:n.handleChange,onBlur:n.handleBlur}),"Yes",e.jsx("input",{type:"radio",name:"isInstallment",value:"no",checked:n.values.isInstallment==="no",onChange:n.handleChange,onBlur:n.handleBlur,disabled:(($=s==null?void 0:s.calculation)==null?void 0:$.paidStatus)===1}),"No"]}),e.jsx("p",{className:"text-red-500 text-xs font-semibold",children:n.touched.isInstallment&&n.errors.isInstallment?n.errors.isInstallment:null})]})}),e.jsxs("div",{className:`${n.values.isInstallment==="no"?"opacity-50":""} flex gap-2 disabled:opacity-60`,children:[e.jsx("p",{className:"font-semibold",children:"Select Installment"}),e.jsxs("select",{onChange:n.handleChange,disabled:n.values.isInstallment==="no",value:n.values.installment,name:"installment",className:"disabled:opacity-60 disabled:border-0 border border-gray-800 rounded shadow text-sm h-6",children:[e.jsx("option",{value:"",children:"Select"}),s&&(s==null?void 0:s.penaltyInstallments.map((t,c)=>(h+=Number(t.balance_amount),e.jsx("option",{value:JSON.stringify({ids:t.ids,amount:h}),children:h},c))))]})]}),e.jsx("p",{className:"text-red-500 text-xs text-center font-semibold",children:n.touched.installment&&n.errors.installment?n.errors.installment:null})]})]})}),e.jsx("div",{className:"col-span-12 mt-2",children:e.jsx("div",{className:"text-center font-light rounded",children:e.jsx("p",{children:"Note: You can pay using Card / UPI / Netbanking / Wallet etc."})})}),e.jsx("div",{className:"col-span-12 mt-2",children:e.jsx("div",{className:"flex justify-center",children:C?e.jsx(J,{strokeColor:"grey",strokeWidth:"5",animationDuration:"0.75",width:"30",visible:!0}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:l.closeModal,className:"mx-3 bg-red-600 hover:bg-red-700 transition duration-200 hover:scale-105 font-normal text-white px-4 py-2 text-sm rounded-sm shadow-xl",children:"Cancel"}),e.jsx("button",{type:"submit",className:"mx-3 bg-indigo-600 hover:bg-indigo-700 transition duration-200 hover:scale-105 font-normal text-white px-4 py-2 text-sm rounded-sm shadow-xl",children:"Pay Now"})]})})})]})]})})})},ie=l=>{var f,n,b,p,a;const[C,m]=o.useState(!1),[_,u]=o.useState(),s=l==null?void 0:l.paymentData,{notify:j}=o.useContext(z),{api_rzpWaterOrderId:g,api_getTranNo:O,header:v}=M(),r=()=>{l.closeModal()},i=d=>{d.status==!0&&(j("Payment Done successfully","success"),u({orderId:d.data.razorpay_order_id,paymentId:d.data.razorpay_payment_id}),l.fetchTransactionDetails(d),l==null||l.refechList())},x=()=>{var N,y;m(!0);const d={id:(N=s==null?void 0:s.connectionCharges)==null?void 0:N.applicationId,applycationType:(y=s==null?void 0:s.connectionCharges)==null?void 0:y.type};Y.post(g,d,v).then(h=>{m(!1),h.data.status==!0?U(h.data.data,i):j(h.data.message,"error")}).catch(h=>{m(!1),j(h.message,"error")})};return e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsxs("p",{onClick:r,className:"float-right absolute right-12 top-12 hover:bg-gray-300 bg-gray-200 p-1 cursor-pointer ",children:[" ",e.jsx(H,{})," "]}),e.jsxs("div",{className:"bg-white shadow-2xl border border-blue-200 md:p-5 md:m-5 rounded-md",children:[e.jsxs("div",{className:" border-b-2 py-1 pl-3 font-semibold border-red-400 flex",children:[e.jsx(Z,{size:20,className:"mt-0.5 mr-1"}),"Make Payment "]}),e.jsx("div",{className:"flex justify-center py-6",children:e.jsx("img",{src:"https://img.freepik.com/free-vector/hand-holding-phone-with-credit-card-screen-man-making-purchase-shopping-paying-online-using-banking-app-flat-vector-illustration-transaction-e-commerce-concept_74855-26014.jpg?w=1380&t=st=1686898919~exp=1686899519~hmac=4b0ddb44860ec647fa33a1a0416ea0c1cc8167693a13fdba3f09058d099f0e76",alt:"My Image",width:200,height:100})}),e.jsxs("div",{className:"flex items-center px-28",children:[e.jsx("div",{className:"font-semibold text-2xl text-gray-500",children:e.jsx("p",{children:"Application No.-"})}),e.jsx("p",{className:"font-semibold text-2xl text-gray-500",children:(f=s==null?void 0:s.connectionCharges)==null?void 0:f.applicationNo})]}),e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"font-semibold text-2xl text-green-500",children:e.jsx("p",{children:"Amount-Rs"})}),e.jsx("p",{className:"font-semibold text-2xl text-green-500",children:((n=s==null?void 0:s.connectionCharges)==null?void 0:n.amount)||"N/A"})]}),e.jsx("h1",{className:"text-center font-semibold",children:"Amount Breakup"}),e.jsxs("div",{className:"grid grid-cols-6 px-24",children:[e.jsxs("div",{className:"col-span-3 ",children:[e.jsxs("h1",{children:["Payment For : ",(b=s==null?void 0:s.connectionCharges)==null?void 0:b.charge_category]}),e.jsxs("h1",{children:["Penalty : ₹ ",(p=s==null?void 0:s.connectionCharges)==null?void 0:p.penalty]})]}),e.jsx("div",{className:"col-span-3",children:e.jsxs("h1",{children:["Connection Fee : ₹ ",(a=s==null?void 0:s.connectionCharges)==null?void 0:a.conn_fee]})})]}),e.jsx("div",{className:"md:col-span-12 col-span-12 md:mt-5 mt-2",children:e.jsx("div",{className:"text-center font-extralight px-2 rounded",children:e.jsx("p",{children:"Note : You can pay using Card / UPI / Netbanking / Wallet etc."})})}),e.jsx("div",{className:"col-span-12 md:mt-5 mt-2",children:e.jsx("div",{className:"flex justify-center",children:C?e.jsx(J,{strokeColor:"grey",strokeWidth:"5",animationDuration:"0.75",width:"30",visible:!0}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:r,className:"mx-3 bg-red-600 hover:bg-red-700 transition duration-200 hover:scale-105 font-normal text-white px-6 py-2 text-sm rounded-sm shadow-xl",children:"Cancel"}),e.jsx("button",{onClick:x,className:"mx-3 bg-indigo-600 hover:bg-indigo-700 transition duration-200 hover:scale-105 font-normal text-white px-5 py-2 text-sm  rounded-sm shadow-xl",children:"Pay Now"})]})})})]})]})})},ae={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",background:"transparent",border:"none"}};function je(l){var n,b,p;const[C,m]=K.useState(!1),[_,u]=o.useState(!1),[s,j]=o.useState(),[g,O]=o.useState(),v=Q();o.useContext(z),M();const r=l.paymentData;o.useEffect(()=>{m(!0)},[]);function i(){}function x(){m(!1),u(!1),j(!1),O(!1),l==null||l.openPaymentModal(!1)}const f=a=>{var d,N,y;a!=null&&a.status&&u(!0),(d=a==null?void 0:a.data)==null||d.razorpay_order_id,(N=a==null?void 0:a.data)==null||N.razorpay_payment_id,(y=a==null?void 0:a.data)==null||y.razorpay_signature};return e.jsx("div",{className:"",children:e.jsxs(X,{isOpen:C,onAfterOpen:i,onRequestClose:x,style:ae,contentLabel:"Example Modal",children:[_&&e.jsxs("div",{className:`${s?"bg-green-200":"bg-yellow-50"} shadow-2xl border border-sky-200 md:p-5 md:m-5 rounded-md`,children:[e.jsxs("div",{className:"flex justify-center",children:[s&&e.jsx("img",{src:D,className:"h-16",alt:"Payment Success",srcset:""}),!s&&e.jsx("img",{src:te,className:"h-12",alt:"Payment Pending",srcset:""})]}),e.jsxs("div",{className:"py-1 pl-3 font-semibold text-center text-2xl text-gray-800",children:[s?"Payment Completed Successfully":"Payment Under Processing"," "]}),(s==null?void 0:s.transectionNo)&&e.jsxs("p",{className:"text-center",children:[e.jsx("span",{className:"text-base",children:" Payment Transaction No"})," ",e.jsx("span",{className:"font-bold text-blue-700 text-xl",children:s==null?void 0:s.transectionNo})]}),!(s!=null&&s.transectionNo)&&e.jsxs("p",{className:"text-center font-semibold",children:[e.jsx("span",{className:"text-base",children:" Payment Status"})," ",e.jsx("span",{className:" text-blue-500 text-base",children:"Pending"})]}),e.jsx("p",{className:"border-b border-gray-300 mx-10 py-1"}),e.jsxs("div",{className:"grid grid-cols-12 px-8 py-3 leading-8 space-x-8 text-sm",children:[e.jsx("div",{className:"md:col-span-6 col-span-12",children:e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsxs("div",{className:"col-span-6 font-semibold",children:[e.jsx("p",{children:"Application No"}),e.jsx("p",{children:"Connection Type"})]}),e.jsxs("div",{className:"col-span-6 ml-3",children:[e.jsx("p",{children:(s==null?void 0:s.applicationNo)||((n=r==null?void 0:r.connectionCharges)==null?void 0:n.applicationNo)}),e.jsx("p",{children:(s==null?void 0:s.tranType)||((b=r==null?void 0:r.connectionCharges)==null?void 0:b.charge_category)})]})]})}),e.jsx("div",{className:"md:col-span-6 col-span-12",children:e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsxs("div",{className:"col-span-6 font-semibold",children:[e.jsx("p",{children:"Amount"}),e.jsx("p",{children:"Payment Date"})]}),e.jsxs("div",{className:"col-span-6",children:[e.jsx("p",{children:(s==null?void 0:s.amount)||((p=r==null?void 0:r.connectionCharges)==null?void 0:p.amount)}),e.jsx("p",{children:(s==null?void 0:s.transectionDate)||"Pending"})]})]})}),e.jsx("div",{className:"col-span-12 md:mt-4 mt-10",children:e.jsxs("div",{className:"flex justify-center",children:[e.jsx("button",{onClick:x,className:"mx-2 bg-sky-600 hover:bg-sky-700 transition duration-200 hover:scale-105 font-normal text-white px-6 py-1 text-sm rounded-sm shadow-xl",children:"Dashboard"}),s&&e.jsx("button",{onClick:()=>v(`/waterConnReceipt/${s==null?void 0:s.transectionNo}`),className:"mx-2 bg-indigo-600 hover:bg-indigo-700 transition duration-200 hover:scale-105 font-normal text-white px-4 py-2 text-sm  rounded-sm shadow-xl",children:"View Receipt"}),!s&&e.jsx("button",{onClick:()=>f(),className:"mx-2 bg-indigo-600 hover:bg-indigo-700 transition duration-200 hover:scale-105 font-normal text-white px-4 py-2 text-sm  rounded-sm shadow-xl",children:"Check Status"})]})})]})]}),!_&&((l==null?void 0:l.category)=="Regulaization"?e.jsx(le,{closeModal:x,fetchTransactionDetails:f,paymentData:r}):e.jsx(ie,{closeModal:x,fetchTransactionDetails:f,paymentData:r}))]})})}export{je as W};
