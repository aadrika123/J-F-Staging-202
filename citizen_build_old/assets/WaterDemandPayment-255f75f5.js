import{j as e}from"./mui-105b4636.js";import{a as F,u as S,r as l,f as J}from"./router-894402c5.js";import{f as M}from"./index.esm-3a2d9baa.js";import{h as x}from"./moment-4682f801.js";import{m as K,A as p,c as Q,d as k,u as X}from"./index-5f3b1ea2.js";import{W as Z}from"./WaterApiList-dd1966fd.js";import{R as D}from"./RazorpayPaymentScreen-817b40ba.js";import{B as ee}from"./BarLoader-1722e4a7.js";import{M as se}from"./index-82be3ecd.js";import{a as te}from"./index.esm-9bec7f4a.js";import{i as re}from"./success-39308b33.js";import"./react-40db4358.js";import"./reactIcons-58c2a0d8.js";import"./axios-67d8a945.js";import"./redux-b8f144fa.js";import"./i18next-e2c66b9b.js";import"./CitizenApplyApiList-f021fd1b.js";const oe={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",background:"transparent",border:"none"}};function ae(t){const[f,u]=F.useState(!1),r=t==null?void 0:t.transData,d=S();t.paymentData,l.useEffect(()=>{u(!0)},[]);function g(){}function o(){u(!1),d("/water-dashboard")}return e.jsx("div",{className:"",children:e.jsx(se,{isOpen:f,onAfterOpen:g,onRequestClose:o,style:oe,contentLabel:"Example Modal",children:e.jsx("div",{children:e.jsxs("div",{className:"bg-green-200 shadow-2xl border border-sky-200 p-5 m-5 rounded-md",children:[e.jsxs("div",{onClick:o,className:"absolute cursor-pointer bg-green-100 hover:bg-gray-300 p-1 rounded-md",children:[e.jsx(te,{})," "]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:re,className:"h-20",alt:"",srcset:""})}),e.jsx("div",{className:"py-1 pl-3 font-semibold text-center text-2xl text-gray-800",children:" Payment Completed Successfully "}),e.jsxs("p",{className:"text-center",children:[e.jsx("span",{className:"text-base",children:" Payment Transaction No"})," ",e.jsx("span",{className:"font-bold text-blue-700 text-xl",children:r==null?void 0:r.transectionNo})]}),e.jsx("p",{className:"border-b border-gray-300 mx-10 py-1"}),e.jsxs("div",{className:"grid grid-cols-12 px-8 py-3 leading-8 space-x-8 text-sm",children:[e.jsx("div",{className:"md:col-span-6 col-span-12",children:e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsxs("div",{className:"col-span-6 font-semibold",children:[e.jsx("p",{children:"Application No"}),e.jsx("p",{children:"Transaction Type"})]}),e.jsxs("div",{className:"col-span-6 ml-3",children:[e.jsx("p",{children:(r==null?void 0:r.applicationNo)||"NA"}),e.jsx("p",{children:(r==null?void 0:r.tranType)||"NA"})]})]})}),e.jsx("div",{className:"md:col-span-6 col-span-12",children:e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsxs("div",{className:"col-span-6 font-semibold",children:[e.jsx("p",{children:"Amount"}),e.jsx("p",{children:"Payment Date"})]}),e.jsxs("div",{className:"col-span-6",children:[e.jsx("p",{children:r==null?void 0:r.amount}),e.jsx("p",{children:r==null?void 0:r.transectionDate})]})]})}),e.jsx("div",{className:"col-span-12 md:mt-4 mt-10",children:e.jsxs("div",{className:"flex justify-center",children:[e.jsx("button",{onClick:o,className:"mx-2 bg-sky-600 hover:bg-sky-700 transition duration-200 hover:scale-105 font-normal text-white px-6 py-1 text-sm rounded-sm shadow-xl",children:"Close"}),r&&e.jsx("button",{onClick:()=>d(`/waterUserReceipt/${r==null?void 0:r.transectionNo}`),className:"mx-2 bg-indigo-600 hover:bg-indigo-700 transition duration-200 hover:scale-105 font-normal text-white px-4 py-2 text-sm  rounded-sm shadow-xl",children:"View Receipt"})]})})]})]})})})})}const we=()=>{var w,_,A;const[t,f]=l.useState(),[u,r]=l.useState(!1),[d,g]=l.useState(),[o,y]=l.useState(),[m,P]=l.useState(),[b,Y]=l.useState(),[R,U]=l.useState(!1),[T,I]=l.useState(),{id:i}=J(),L=S(),{notify:j}=l.useContext(K),{api_getTranNo:E,api_waterApprovedApplicationDetails:O,api_waterListDemand:q,api_waterDemandCalculation:z,api_waterDemandPayment:B,header:h}=Z();l.useEffect(()=>{C(),v()},[i]),l.useEffect(()=>{W()},[b,m]);const W=()=>{if(b==""||m=="")return y();r(!0);const s={consumerId:i,demandFrom:m,demandUpto:b};p.post(z,s,h).then(function(n){y(n.data.data),r(!1)}).catch(function(n){r(!1)})},C=()=>{r(!0),p.post(O,{id:i},h).then(function(s){f(s.data.data),r(!1)}).catch(function(s){r(!1)})},v=()=>{p.post(q,{ConsumerId:i},h).then(s=>{g(s.data.data)}).catch(s=>{})},V=s=>{if(s.status==!0){j("Payment Done successfully","success"),U(!0);const n={orderId:s.data.razorpay_order_id,paymentId:s.data.razorpay_payment_id};p.post(E,n,h).then(c=>{c.data.status==!0&&I(c.data.data)}).catch(c=>{})}v()},$=()=>{r(!0);const s={consumerId:i,demandFrom:m,demandUpto:b,amount:o==null?void 0:o.totalPayAmount,paymentMode:"online",remarks:"citizen payment"};p.post(B,s,h).then(n=>{n.data.status?(r(!1),n.data.status==!0?D(n.data.data,V):j(n.data.message,"error")):r(!1)}).catch(n=>{r(!1)})},G=Q({monthFrom:k().required("Require Field"),monthUpto:k().required("Require Field")}),a=X({enableReinitialize:!0,initialValues:{monthFrom:"",monthUpto:"",penalty:"",rebate:"",advanced:""},onSubmit:(s,n)=>{$()},validationSchema:G}),H=s=>{let n=s.target.name,c=s.target.value;n=="monthFrom"&&P(c),n=="monthUpto"&&Y(c)},N=(w=d==null?void 0:d.consumerDemands)==null?void 0:w.filter(s=>x(s.demand_upto,"YYYY-MM-DD").format("yy-MM").toString()>=x(m,"YYYY-MM-DD").format("yy-MM"));return e.jsxs(e.Fragment,{children:[u&&e.jsx(ee,{}),R&&e.jsx(ae,{transData:T}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-12 lg:grid-cols-12 gap-2 container mx-auto w-full",children:e.jsxs("div",{className:"col-span-12 rounded-lg p-4 max-sm:p-0",children:[e.jsx("div",{className:"p-4 max-sm:p-2",children:e.jsxs("div",{className:"",children:[e.jsxs("h1",{className:"px-1 font-semibold font-serif  text-gray-500",children:[e.jsx(M,{className:"inline"})," Basic Details"]}),e.jsx("div",{className:"py-6 mt-2 bg-white rounded-lg shadow-xl p-4",children:e.jsxs("div",{className:"flex space-x-5 pl-4 max-sm:flex-col max-sm:space-x-0 max-sm:space-y-2 ",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-sm",children:t!=null&&t.ulb_name?t==null?void 0:t.ulb_name:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"ULB Name"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-sm",children:t!=null&&t.ward_name?t==null?void 0:t.ward_name:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Ward No."})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-sm",children:t!=null&&t.consumer_no?t==null?void 0:t.consumer_no:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Consumer No"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-sm",children:t!=null&&t.connection_through?t==null?void 0:t.connection_through:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Connection Through"})]}),(t==null?void 0:t.connection_through)=="SAF"?e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-md",children:t!=null&&t.saf_no?t==null?void 0:t.saf_no:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"SAF No"})]}):e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-md",children:t!=null&&t.holding_no?t==null?void 0:t.holding_no:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Holding No"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-md",children:t!=null&&t.owner_char_type?t==null?void 0:t.owner_char_type:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Ownership Type"})]})]})})]})}),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mt-5 p-4",children:[e.jsxs("h1",{className:"px-1 font-semibold font-serif text-gray-500",children:[e.jsx(M,{className:"inline"}),"Due Demand Details"]}),e.jsx("div",{className:"overflow-auto",children:e.jsxs("table",{className:"min-w-full leading-normal mt-2 bg-white rounded-lg shadow-xl p-4",children:[e.jsx("thead",{className:"font-bold text-left text-sm border text-gray-800 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"#"}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Demand From"}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Demand Upto"}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Demand Amount"}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Penalty"}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Connection Type"}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Payable Amount "})]})}),e.jsx("tbody",{className:"text-sm",children:e.jsx(e.Fragment,{children:(_=d==null?void 0:d.consumerDemands)==null?void 0:_.map((s,n)=>e.jsxs("tr",{className:"bg-white shadow-xl border-b border-gray-200",children:[e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:n+1}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:s!=null&&s.demand_from?x(s==null?void 0:s.demand_from,"YYYY-MM-DD").format("DD-MMM-yy"):"N/A"}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:s!=null&&s.demand_upto?x(s==null?void 0:s.demand_upto,"YYYY-MM-DD").format("DD-MMM-yy"):"N/A"}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:s!=null&&s.balance_amount?s==null?void 0:s.balance_amount:"N/A"}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:s!=null&&s.penalty?s==null?void 0:s.penalty:"N/A"}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:s!=null&&s.connection_type?s==null?void 0:s.connection_type:"N/A"}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:s!=null&&s.amount?"₹ "+(s==null?void 0:s.amount):"N/A"})]}))})})]})})]})}),e.jsx("div",{className:"col-span-12 rounded-lg p-4",children:e.jsx("div",{className:"py-6 mt-2 bg-white rounded-lg shadow-xl border border-y-gray-200 p-4",children:e.jsx("form",{onSubmit:a.handleSubmit,onChange:H,className:"p-4 relative",children:e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Select Month From"]}),e.jsxs("select",{...a.getFieldProps("monthFrom"),type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md",children:[e.jsx("option",{value:"",children:"Select"}),(A=d==null?void 0:d.consumerDemands)==null?void 0:A.map((s,n)=>e.jsx("option",{value:s.demand_from,children:x(s.demand_from,"YYYY-MM-DD").format("MMM-yy")},n))]}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:a.touched.monthFrom&&a.errors.monthFrom?a.errors.monthFrom:null})]}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Select Month Upto"]}),e.jsxs("select",{...a.getFieldProps("monthUpto"),type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md",children:[e.jsx("option",{value:"",children:"Select"}),N==null?void 0:N.map((s,n)=>e.jsx("option",{value:s.demand_upto,children:x(s.demand_upto,"YYYY-MM-DD").format("MMM-yy")},n))]}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:a.touched.monthUpto&&a.errors.monthUpto?a.errors.monthUpto:null})]}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsx("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:"Total Demand"}),e.jsx("input",{...a.getFieldProps("amount"),value:(o==null?void 0:o.totalDemand)||0,disabled:!0,type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md bg-slate-200"}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:a.touched.amount&&a.errors.amount?a.errors.amount:null})]}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsx("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:"Penalty"}),e.jsx("input",{...a.getFieldProps("penalty"),value:(o==null?void 0:o.totalPenalty)||0,disabled:!0,type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md bg-slate-200"}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:a.touched.penalty&&a.errors.penalty?a.errors.penalty:null})]}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsx("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:"Rebate"}),e.jsx("input",{...a.getFieldProps("rebate"),value:(o==null?void 0:o.totalRebate)||0,disabled:!0,type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md bg-slate-200"}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:a.touched.rebate&&a.errors.rebate?a.errors.rebate:null})]}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsx("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:"Advanced"}),e.jsx("input",{...a.getFieldProps("advanced"),value:(o==null?void 0:o.totalAdvance)||0,disabled:!0,type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md bg-slate-200"}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:a.touched.advanced&&a.errors.advanced?a.errors.advanced:null})]}),e.jsx("div",{className:"form-group mb-4 col-span-12 md:col-span-6 md:px-4",children:e.jsxs("p",{children:["Remain Advance : ",e.jsx("span",{className:"text-orange-700 font-semibold",children:(o==null?void 0:o.remaningAdvanceAmount)||0})]})}),e.jsx("div",{className:"form-group mb-4 col-span-12 md:col-span-6 md:px-4",children:e.jsxs("p",{children:[" Payable Amount : ",e.jsx("span",{className:"text-green-700 font-semibold",children:o!=null&&o.totalPayAmount?"₹"+(o==null?void 0:o.totalPayAmount):0})]})}),e.jsxs("div",{className:"col-span-12 grid grid-cols-2 mt-10",children:[e.jsx("div",{className:""}),e.jsxs("div",{className:"md:pl-10 text-right space-x-5 max-sm:space-x-0 max-sm:pl-0 max-sm:space-y-2",children:[e.jsx("button",{type:"button",onClick:()=>L(-1),className:" px-6 py-2.5 max-sm:px-8 bg-sky-600 text-white font-medium text-xs leading-tight  rounded shadow-md hover:bg-sky-700 hover:shadow-lg focus:bg-sky-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-indigo-800 active:shadow-lg transition duration-150 ease-in-out cursor-pointer",children:"Back"}),e.jsx("button",{type:"submit",className:" px-6 py-2.5 bg-indigo-600 text-white font-medium text-xs leading-tight  rounded shadow-md hover:bg-indigo-600 hover:shadow-lg focus:bg-indigo-700 focus:shadow-lg focus:outline-none focus:ring-0 active:shadow-lg transition duration-150 ease-in-out cursor-pointer",children:"Pay Now"})]})]})]})})})})]})})]})};export{we as default};
