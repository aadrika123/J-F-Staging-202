import{r as s,j as r}from"./index-fTDQSGTw.js";const D=({onCaptchaChange:c,error:i,length:f=6,width:o=180,height:n=60,className:M="",placeholder:j="Enter the captcha text",refreshButtonClassName:N="",inputClassName:S=""})=>{const b=s.useRef(null),[h,R]=s.useState(""),[d,p]=s.useState(""),[m,C]=s.useState(!1),l={characters:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",noiseLines:5,noiseDots:20,fontFamily:"Arial",fontSize:24,backgroundColor:"#f8f9fa"},g=s.useCallback(()=>{let e="";for(let a=0;a<f;a++)e+=l.characters.charAt(Math.floor(Math.random()*l.characters.length));return e},[f,l.characters]),$=()=>`hsl(${Math.random()*360}, 70%, 30%)`,v=()=>`hsl(${Math.random()*360}, 50%, 70%)`,w=e=>{for(let a=0;a<l.noiseLines;a++)e.strokeStyle=v(),e.lineWidth=1,e.beginPath(),e.moveTo(Math.random()*o,Math.random()*n),e.lineTo(Math.random()*o,Math.random()*n),e.stroke()},L=e=>{for(let a=0;a<l.noiseDots;a++)e.fillStyle=v(),e.beginPath(),e.arc(Math.random()*o,Math.random()*n,2,0,Math.PI*2),e.fill()},T=(e,a)=>{e.font=`bold ${l.fontSize}px ${l.fontFamily}`,e.textAlign="center",e.textBaseline="middle";const t=o/2,I=n/2;for(let u=0;u<a.length;u++){e.save();const A=t-a.length*12/2+u*24+Math.random()*6-3,P=I+Math.random()*10-5;e.translate(A,P),e.rotate((Math.random()-.5)*.4),e.scale(.9+Math.random()*.2,.9+Math.random()*.2),e.fillStyle=$(),e.fillText(a[u],0,0),e.restore()}},y=s.useCallback(e=>{const a=b.current;if(!a)return;const t=a.getContext("2d");t&&(t.clearRect(0,0,o,n),t.fillStyle=l.backgroundColor,t.fillRect(0,0,o,n),t.strokeStyle="#dee2e6",t.lineWidth=1,t.strokeRect(0,0,o,n),w(t),L(t),T(t,e))},[o,n,l.backgroundColor]),k=s.useCallback(async()=>{C(!0),await new Promise(a=>setTimeout(a,200));const e=g();R(e),y(e),p(""),c("",!1),C(!1)},[g,y,c]),E=e=>{const a=e.target.value;p(a)},x=s.useCallback((e,a)=>e.toLowerCase().trim()===a.toLowerCase().trim()&&e.length>0,[]);return s.useEffect(()=>{k()},[]),s.useEffect(()=>{const e=x(d,h);c(d,e)},[d,h,c,x]),r.jsxs("div",{className:`space-y-3 ${M}`,children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsxs("div",{className:"border border-gray-300 rounded-md p-2 bg-gray-50 relative",children:[r.jsx("canvas",{ref:b,width:o,height:n,className:"block",role:"img","aria-label":"Captcha image"}),m&&r.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-75 flex items-center justify-center",children:r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"})})]}),r.jsx("button",{type:"button",onClick:k,disabled:m,className:`p-2 text-blue-600 hover:text-blue-800 border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors ${N}`,title:"Refresh Captcha","aria-label":"Generate new captcha",children:r.jsx("svg",{className:`w-5 h-5 ${m?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),r.jsxs("div",{children:[r.jsx("input",{type:"text",value:d,onChange:E,placeholder:j,className:`py-3 px-4 w-full border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${i?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300"} ${S}`,"aria-describedby":i?"captcha-error":void 0,autoComplete:"off",spellCheck:"false"}),i&&r.jsx("p",{id:"captcha-error",className:"text-red-500 text-sm mt-1",role:"alert",children:i})]})]})},W=D;export{W as C};
