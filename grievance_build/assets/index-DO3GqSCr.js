import{u as Q,b6 as ie,r as j,b as ne,o as oe,j as e,D as me,B as U,F as xe,C as X,a0 as he,R as je,t as ue,v as pe,G as p,w as fe,S as ge,a2 as m,L as Z,A as be,c as ye,d as Ne,g as u,_ as i,I as ve}from"./index-BHykvb2J.js";import{g as we}from"./services-KQnp_8oA.js";import{T as Ce,a as Se,b as W,c as n,d as Te,e as o}from"./table-D6_WuBvl.js";const Oe=ye().shape({complaintNo:Ne().required("Complaint No. is Required")});function Pe(){var g,b,y,N,v,w,C,S,T,O,P,R,k,F,E,L,_,B,A,$,D,H,z,I,V,q,G,J,K;const M=Q({}),ee=Q({}),a=ie(),[ae,x]=j.useState(!1),[se,te]=j.useState(!1),[f,re]=j.useState(""),h=ne({resolver:oe(Oe)}),le=async s=>{var l,c;try{const t=await a.mutateAsync({api:`${u.getComplaintDetailsByComplaintNo}/${s==null?void 0:s.complaintNo}`});(l=t.data)!=null&&l.success?ce(t):i.error((c=t==null?void 0:t.data)==null?void 0:c.message)}catch(t){console.log(t)}},ce=async s=>{var l,c,t;try{const d=await M.mutateAsync({api:u.sendOtp,data:{email:(c=(l=s==null?void 0:s.data)==null?void 0:l.data)==null?void 0:c.email}});(t=d==null?void 0:d.data)!=null&&t.success?(i.success("OTP sent to your email"),x(!0)):i.error("Error sending OTP")}catch{}},de=async()=>{var s,l,c,t,d,Y;try{const r=await ee.mutateAsync({api:u.verifyEmailOtp,data:{otp:f,email:(c=(l=(s=a==null?void 0:a.data)==null?void 0:s.data)==null?void 0:l.data)==null?void 0:c.email}});(t=r==null?void 0:r.data)!=null&&t.success?(i.success((d=r==null?void 0:r.data)==null?void 0:d.message),x(!1),te(!0)):i.error((Y=r==null?void 0:r.data)==null?void 0:Y.message)}catch(r){i.error(we(r.message))}};return e.jsxs(e.Fragment,{children:[e.jsx(me,{open:ae,setOpen:x,title:"OTP Send to your Registered Email",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-bold mb-4",children:"Enter OTP"}),e.jsxs("form",{onSubmit:s=>s.preventDefault(),children:[e.jsx("input",{value:f,onChange:s=>re(s.target.value),type:"text",placeholder:"Enter OTP",className:"input-field w-full border border-gray-300 rounded-md p-2"}),e.jsx("div",{children:e.jsx(U,{type:"button",onClick:de,className:"w-full rounded-xl py-6 px-4 mt-2 shadow-none",variant:"outline",children:"Verify OTP"})})]})]})}),e.jsx(xe,{methods:h,onSubmit:h.handleSubmit(le),children:e.jsxs("div",{className:"md:px-24 space-y-4",children:[e.jsx(X,{className:"text-xl text-primary font-bold",children:"Track Complaint"}),e.jsxs("div",{children:[e.jsx(he,{htmlFor:"complaintNo",children:"Complaint Number"}),e.jsx(je,{className:"bg-background",name:"complaintNo",placeholder:""})]}),e.jsx("div",{className:"col-span-3",children:e.jsx(U,{isLoading:h.formState.isSubmitting,type:"submit",className:"w-auto rounded-xl px-10 float-right",children:"Submit"})})]})}),((b=(g=a==null?void 0:a.data)==null?void 0:g.data)==null?void 0:b.success)&&se&&e.jsx("div",{className:"mt-20 md:px-24",children:e.jsxs(ue,{children:[e.jsx(pe,{className:"px-7",children:e.jsx(p,{children:"Complaint List"})}),e.jsx(fe,{children:a.isPending?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(ge,{})}):e.jsxs(Ce,{children:[e.jsx(Se,{children:e.jsxs(W,{children:[e.jsx(n,{children:"Complaint No."}),e.jsx(n,{children:"Citizen Name"}),e.jsx(n,{children:"Mobile No."}),e.jsx(n,{children:"Status"}),e.jsx(n,{children:"View"})]})}),e.jsx(Te,{children:e.jsxs(W,{children:[e.jsx(o,{children:(v=(N=(y=a==null?void 0:a.data)==null?void 0:y.data)==null?void 0:N.data)==null?void 0:v.complaintRefNo}),e.jsx(o,{children:(S=(C=(w=a==null?void 0:a.data)==null?void 0:w.data)==null?void 0:C.data)==null?void 0:S.citizenName}),e.jsx(o,{children:(P=(O=(T=a==null?void 0:a.data)==null?void 0:T.data)==null?void 0:O.data)==null?void 0:P.mobileNo}),e.jsxs(o,{children:[((F=(k=(R=a==null?void 0:a.data)==null?void 0:R.data)==null?void 0:k.data)==null?void 0:F.wf_status)===3&&e.jsx(m,{className:"bg-amber-400 text-white",children:"Pending (re-opened)"}),((_=(L=(E=a==null?void 0:a.data)==null?void 0:E.data)==null?void 0:L.data)==null?void 0:_.wf_status)===2&&e.jsx(m,{variant:"destructive",children:"Rejected"}),(($=(A=(B=a==null?void 0:a.data)==null?void 0:B.data)==null?void 0:A.data)==null?void 0:$.wf_status)===1&&e.jsx(m,{variant:"success",children:"Resolved"}),((z=(H=(D=a==null?void 0:a.data)==null?void 0:D.data)==null?void 0:H.data)==null?void 0:z.wf_status)===0&&e.jsx(m,{variant:"secondary",children:"Pending"})]}),e.jsx(o,{children:e.jsx(Z,{to:`/grievance/citizen/complaint-details?complaintRefNo=${(q=(V=(I=a==null?void 0:a.data)==null?void 0:I.data)==null?void 0:V.data)==null?void 0:q.complaintRefNo}&complaintId=${(K=(J=(G=a==null?void 0:a.data)==null?void 0:G.data)==null?void 0:J.data)==null?void 0:K._id}`,children:e.jsx(be,{className:"bg-primary",children:"View"})})})]})})]})})]})})]})}function Ee(){return e.jsxs("div",{className:"grid sm:grid-cols-4 grid-cols-1",children:[e.jsxs("div",{className:"col-span-4 md:col-span-1 flex items-center flex-col md:px-10 mt-10 space-y-4 hidden sm:block",children:[e.jsx(X,{className:"text-xl text-primary font-bold",children:"Track your complaint here"}),e.jsx(ve,{src:"/images/complain_boy.png",className:"w-40"}),e.jsx(p,{className:"text-center",children:"Fee free to give us your feedback"}),e.jsxs(p,{className:"text-center",children:["Your feedback is very important for us to enhance our system, Please feel free to give us your valuable feedback.",e.jsx(Z,{target:"_blank",className:"underline hover:text-primary",to:"https://maps.app.goo.gl/ncVp959LoSja4uAh8",children:"Jan Seva Kendra"})," for further query. & Feel free to contact us on +918458697845"]})]}),e.jsx("div",{className:"col-span-4 md:col-span-3 p-2 sm:p-10 bg-gray-50 h-screen",children:e.jsx(Pe,{})})]})}export{Ee as default};
