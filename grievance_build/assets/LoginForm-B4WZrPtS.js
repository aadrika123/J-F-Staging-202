import{b as y,r as l,u as b,d as _,o as D,j as e,D as M,B as j,F as q,R as B,L as V,c as z,a as w,_ as i,e as G,g as H}from"./index-fTDQSGTw.js";import{g as v}from"./services-KQnp_8oA.js";import{R as I}from"./RHFPasswordField-Bh2MQ-jP.js";import{G as O,L as T}from"./LoginTitle-D9bnT8_N.js";import{C as Y}from"./CaptchaComponent-CdXZdvCV.js";const $=z({email:w().email("Please enter a valid email address").required("Email is required"),password_123:w().min(3,"Password must be at least 3 characters").required("Password is required")});function Z(){const{currentLanguage:N}=y(),[C,c]=l.useState(!1),[u,g]=l.useState(!1),[J,P]=l.useState(!1),[n,h]=l.useState(""),[d,x]=l.useState({value:"",isValid:!1,error:""}),L=b({}),S=b({}),{login:F}=y(),m=_({defaultValues:{email:"",password_123:""},resolver:D($)}),E=(a,o)=>{x(r=>({...r,value:a,isValid:o,error:r.error&&o?"":r.error}))},k=()=>!d.isValid||!d.value.trim()?(x(a=>({...a,error:"Please enter the correct captcha code"})),!1):!0,p=a=>{a.preventDefault(),i.error("Pasting is not allowed in this field.")},A=async a=>{var r,s,f;if(!k())return;const o={email:a.email,password:a.password_123,captcha:d.value};try{const t=await L.mutateAsync({api:G.citizenLogin,data:o});(r=t==null?void 0:t.data)!=null&&r.success?(await F(t),i.success(((s=t==null?void 0:t.data)==null?void 0:s.message)||"Login successful!")):i.error(((f=t==null?void 0:t.data)==null?void 0:f.message)||"Login failed")}catch(t){i.error(v(t.message)||"An error occurred during login")}},R=async()=>{var a,o,r;if(!n.trim()){i.error("Please enter your email address");return}g(!0);try{const s=await S.mutateAsync({api:H.forgetPassword,data:{email:n}});(a=s==null?void 0:s.data)!=null&&a.success?(c(!1),h(""),i.success(((o=s==null?void 0:s.data)==null?void 0:o.message)||"Password reset link sent successfully!")):i.error(((r=s==null?void 0:s.data)==null?void 0:r.message)||"Failed to send reset link")}catch(s){i.error(v(s.message)||"An error occurred")}finally{g(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(M,{open:C,setOpen:c,title:"Reset Your Password",setEdit:P,children:e.jsx("div",{className:"p-4",children:e.jsxs("form",{onSubmit:a=>a.preventDefault(),children:[e.jsx("input",{value:n,onChange:a=>h(a.target.value),type:"email",placeholder:"Your email address",className:"input-field w-full border border-gray-300 rounded-md p-1.5"}),e.jsx("div",{children:e.jsx(j,{type:"button",onClick:R,disabled:u||!n.trim(),className:"w-full rounded-xl py-5 px-4 mt-4 shadow-none",variant:"outline",children:u?"Sending...":"Send"})})]})})}),e.jsx("div",{className:"bg-gradient-to-r from-blue-200 via-blue-300 to-blue-400 p-6 min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"w-full max-w-4xl bg-white rounded-lg shadow-lg overflow-hidden flex flex-col lg:flex-row",children:[e.jsxs("div",{className:"flex-1 p-10",children:[e.jsx("h2",{className:"text-xl font-bold text-center text-gray-800 mb-6",children:N==="en"?"Citizen Login":"नागरिक लॉगिन"}),e.jsx(q,{methods:m,onSubmit:m.handleSubmit(A),children:e.jsxs("div",{className:"space-y-4 max-w-md mx-auto",children:[e.jsx("input",{type:"password",name:"fake-password",autoComplete:"new-password",style:{display:"none"},"aria-hidden":"true"}),e.jsx("div",{className:"space-y-2",children:e.jsx(B,{className:"rounded-lg py-5 px-5 w-full bg-gray-100 border border-gray-300",name:"email",inputValidation:["removeSpace"],placeholder:"Enter your Email",onPaste:p,autoComplete:"off"})}),e.jsx("div",{className:"space-y-2",children:e.jsx(I,{className:"rounded-lg py-5 px-5 w-full bg-gray-100 border border-gray-300",name:"password_123",placeholder:"Enter your Password",onPaste:p,autoComplete:"off"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Security Verification"}),e.jsx(Y,{onCaptchaChange:E,error:d.error,length:6,width:250,height:30,placeholder:"Enter captcha code",className:"w-full",inputClassName:"px-5",refreshButtonClassName:"hover:bg-blue-50"})]}),e.jsx("div",{children:e.jsx(j,{type:"submit",isLoading:m.formState.isSubmitting,className:"w-full rounded-lg py-5 px-4 mt-2 bg-green-600 text-white font-medium hover:bg-green-700 transition duration-200",variant:"outline",children:"Login"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("hr",{className:"flex-1 border-gray-300"}),e.jsx("span",{className:"text-gray-500",children:"or"}),e.jsx("hr",{className:"flex-1 border-gray-300"})]}),e.jsx("div",{children:e.jsx(O,{})}),e.jsx("div",{children:e.jsx(V,{to:"https://epramaan.meripehchaan.gov.in/",children:e.jsx("div",{className:"flex cursor-pointer text-md font-medium text-white bg-green-600 py-1.5 justify-center hover:bg-green-700 transition duration-200",children:"Sign in with ePramaan"})})}),e.jsx("div",{className:"text-center mt-4",children:e.jsx("button",{className:"text-sm text-blue-600 hover:underline",type:"button",onClick:()=>c(!0),children:"Forgot password?"})})]})})]}),e.jsx("div",{className:"flex-1 bg-gradient-to-b from-gray-200 to-gray-300 flex justify-center items-center lg:block hidden",children:e.jsx(T,{})})]})})]})}export{Z as default};
