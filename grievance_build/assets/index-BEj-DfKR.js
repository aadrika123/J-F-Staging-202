import{u as W,x as K,s as O,g as b,b as X,o as Z,r as g,j as e,F as ee,R as L,H as ae,S as Q,B as se,c as le,d as v,J as re,_ as u,z as V,t as ne,v as de,A as te,w as oe,I as ce,D as ie}from"./index-0_eOYziX.js";import{P as ue}from"./index-DThTelrn.js";import{T as xe,a as he,b as G,c as t,d as ge,e as o}from"./table-COa44yxU.js";import{D as pe}from"./index-Cld17Xid.js";import{g as je}from"./services-KQnp_8oA.js";import{P as me}from"./index-u3PxukHO.js";import{S as fe}from"./index-C276sS_p.js";import{S as Ne}from"./Spinner-BmvVMya1.js";import{q as be}from"./switch-DCGhywId.js";const Se=le().shape({moduleName:v().required("Module Name is required"),uniqueString:v().required("Enter unique label for the module"),fixedNoLabel:v().nullable(),tempNoLabel:v().nullable(),imageUrl:re().nullable()});function ye({open:P,setOpen:x,title:q,id:i,edit:h,setEdit:p,refetch:w}){const $=W({}),j=K({}),{data:n,isFetching:E}=O({api:`${b.getModuleById}/${i}`,key:"getModuleById",options:{enabled:h}}),c=X({defaultValues:{moduleName:""},resolver:Z(Se)}),S=async s=>{var y,m,f,N;const d=new FormData;d.append("moduleName",s.moduleName),d.append("fixedNoLabel",s.fixedNoLabel||""),d.append("tempNoLabel",s.tempNoLabel||""),d.append("imageUrl",s.imageUrl);try{if(h&&s){d.append("uniqueString",s.uniqueString);const l=await j.mutateAsync({api:`${b.updateModule}/${i}`,data:d});(y=l.data)!=null&&y.success?u.success((m=l==null?void 0:l.data)==null?void 0:m.message):u.error("Module not updated successfully")}else{d.append("uniqueString",s.uniqueString);const l=await $.mutateAsync({api:b.createModule,data:d});(f=l.data)!=null&&f.success?u.success((N=l==null?void 0:l.data)==null?void 0:N.message):u.error("Module not created successfully"),c.reset({moduleName:""})}x(!1),p(!1),w()}catch(l){console.log(l)}};return g.useEffect(()=>{h&&n?c.reset({moduleName:n.data.moduleName,uniqueString:n.data.uniqueString,fixedNoLabel:n.data.fixedNoLabel,tempNoLabel:n.data.tempNoLabel,imageUrl:n.data.imageUrl}):c.reset({moduleName:""})},[h,n]),e.jsx(pe,{open:P,setOpen:x,title:q,setEdit:p,edit:h,isLoading:E,children:e.jsx(ee,{methods:c,onSubmit:c.handleSubmit(S),children:e.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[e.jsx("div",{children:e.jsx(L,{name:"moduleName",placeholder:"Enter your module name"})}),e.jsx("div",{children:e.jsx(L,{name:"uniqueString",placeholder:"Enter unique string"})}),e.jsx("div",{children:e.jsx(L,{name:"fixedNoLabel",placeholder:"Enter fixed no. label"})}),e.jsx("div",{children:e.jsx(L,{name:"tempNoLabel",placeholder:"Enter temp no. label"})}),e.jsx("div",{children:e.jsx(ae,{name:"imageUrl",placeholder:"Upload your Images"})}),e.jsx(Q,{}),e.jsx("div",{children:e.jsx(se,{isLoading:c.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function Me(){var m,f,N,l,F,A,C,I,T,U,k;const P=K({}),[x,q]=g.useState(1),[i,h]=g.useState(10),[p,w]=g.useState(""),[$,j]=g.useState(!1),[n,E]=g.useState(""),[c,S]=g.useState(!1),s=O({api:`${b.getAllModule}?page=${x}&limit=${i}&q=${p}`,key:"getAllModule",value:[x,i],options:{enabled:!0}}),d=a=>{S(!0),j(!0),E(a)},y=async a=>{var M,B,H,R,_,Y,D,z,J;try{const r=await P.mutateAsync({api:`${(M=b)==null?void 0:M.updateModuleStatus}/${a}`,data:{id:n}});(B=r==null?void 0:r.data)!=null&&B.success?(s.refetch(),((R=(H=r==null?void 0:r.data)==null?void 0:H.data)==null?void 0:R.status)==1&&u.success((_=r.data)==null?void 0:_.message),((D=(Y=r==null?void 0:r.data)==null?void 0:Y.data)==null?void 0:D.status)==0&&u.error((z=r.data)==null?void 0:z.message)):u.error((J=r.data)==null?void 0:J.message)}catch(r){u.error(je(r))}};return e.jsxs("main",{className:"grid items-start",children:[e.jsx(ye,{open:$,setOpen:j,title:c?"Edit Module Name":"Add Module Name",id:n,edit:c,setEdit:S,refetch:s.refetch}),e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsxs("div",{className:"flex w-full justify-between gap-2",children:[e.jsx("div",{children:e.jsx(fe,{search:p,setSearch:w,refetch:s.refetch,isFetching:s.isLoading})}),e.jsx("div",{children:e.jsx(V,{className:"flex items-center gap-2",onClick:()=>j(!0),children:"Add New"})})]}),e.jsxs(ne,{children:[e.jsx(de,{className:"px-7",children:e.jsxs(te,{children:["Module  List (",(f=(m=s.data)==null?void 0:m.data)==null?void 0:f.totalDocs,")"]})}),e.jsx(oe,{children:s.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(Ne,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(xe,{children:[e.jsx(he,{children:e.jsxs(G,{children:[e.jsx(t,{className:"",children:"#"}),e.jsx(t,{className:"",children:"Image"}),e.jsx(t,{className:"",children:"Module Name"}),e.jsx(t,{className:"",children:"Unique Label"}),e.jsx(t,{className:"",children:"FixedNo. Label"}),e.jsx(t,{className:"",children:"TempNo. Label"}),e.jsx(t,{className:"",children:"Id"}),e.jsx(t,{className:"",children:"Created at"}),e.jsx(t,{className:"",children:"Status"}),e.jsx(t,{children:"Action"})]})}),e.jsx(ge,{children:(F=(l=(N=s==null?void 0:s.data)==null?void 0:N.data)==null?void 0:l.docs)==null?void 0:F.map((a,M)=>e.jsxs(G,{children:[e.jsx(o,{children:x*i-i+M+1}),e.jsx(o,{style:{margin:5,width:"50px",height:"50px",backgroundSize:"cover",backgroundPosition:"center",borderRadius:"50%",display:"flex",justifyContent:"center",alignItems:"center",padding:0},children:e.jsx(ce,{src:a==null?void 0:a.fullImgUrl,alt:a==null?void 0:a.imageUrl,className:"h-12 w-12 rounded-full"})}),e.jsx(o,{children:a==null?void 0:a.moduleName}),e.jsx(o,{children:a==null?void 0:a.uniqueString}),e.jsx(o,{children:a==null?void 0:a.fixedNoLabel}),e.jsx(o,{children:a==null?void 0:a.tempNoLabel}),e.jsx(o,{children:a==null?void 0:a._id}),e.jsx(o,{children:ie(a.createdAt).format("DD-MM-YYYY")}),e.jsx(o,{children:e.jsxs(be,{checked:(a==null?void 0:a.status)==1,onChange:()=>y(a==null?void 0:a._id),className:`${a!=null&&a.status?"bg-primary":"bg-gray-200"} relative inline-flex items-center h-6 rounded-full w-11`,children:[e.jsx("span",{className:"sr-only",children:"Enable notifications"}),e.jsx("span",{className:`${a!=null&&a.status?"translate-x-6":"translate-x-1"} inline-block w-4 h-4 transform bg-white rounded-full`})]})}),e.jsx(o,{children:e.jsx(V,{className:"bg-primary",onClick:()=>d(a==null?void 0:a._id),children:"Edit"})})]},a==null?void 0:a._id))})]}),e.jsx(Q,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(me,{page:x,perPage:i,totalPage:(C=(A=s==null?void 0:s.data)==null?void 0:A.data)==null?void 0:C.totalDocs,hasNextPage:(T=(I=s==null?void 0:s.data)==null?void 0:I.data)==null?void 0:T.hasNextPage,hasPrevPage:(k=(U=s==null?void 0:s.data)==null?void 0:U.data)==null?void 0:k.hasPrevPage,setPage:q,setPerPage:h})})]})})]})]})]})}function Ce(){return e.jsx(ue,{title:"Module List",subTitle:"Manage all the Module Name here",children:e.jsx("div",{children:e.jsx(Me,{})})})}export{Ce as default};
