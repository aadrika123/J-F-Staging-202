import{a as I,r as n,k as L,u as T,c as ee,d as se,b as te,o as ae,j as e,b2 as re,aO as j,_ as p,g as ne,C as ie,I as le,H as C}from"./index-Dz7olP6D.js";function oe(){const{currentLanguage:t}=I(),[ce,k]=n.useState(null),i=new URLSearchParams(L().search).get("type"),[pe,U]=n.useState(null),M=T({}),_={};n.useEffect(()=>{(async()=>{try{const o=await(await j.post("http://172.18.1.108:8000/api/property/details/get-owner-details")).data;U(o)}catch(l){console.error("Error fetching user details:",l)}})()},[]),n.useEffect(()=>{k(i?_[i]:null),W()},[i,_]);const[h,b]=n.useState(""),[u,f]=n.useState([]),[F,x]=n.useState(!1),[m,B]=n.useState("default_type"),[D,N]=n.useState(!1),[s,v]=n.useState(null),[g,w]=n.useState(!1),[O,P]=n.useState(!1),[$,G]=n.useState();n.useState(!1),n.useState("");const[q,me]=n.useState("");n.useState(null),n.useState(!1),n.useState(!1);const[H,y]=n.useState(!1);n.useState({}),n.useEffect(()=>{f([]),x(!1)},[m]);const S=async()=>{var l;if(!h.trim()){alert("Please enter a valid search query.");return}const a={MOBILE_NUMBER:"mobileNo",HOLDING_NUMBER:"holdingNo",SAF_NUMBER:"safNo",CONSUMER_NUMBER:"consumerNo",APPLICATION_NUMBER:"applicationNo",LICENSE_NUMBER:"licenseNo"};w(!0);try{const o=A(i)||"http://172.18.1.108:8000/api/property/details/get-owner-details",d=await j.post(o,{filterBy:a[m],filterValue:h});d.status===200&&((l=d.data)!=null&&l.data)?(f(d.data.data),x(!0),p.success("Data Search successful!"),b("")):(p.error("No results found."),f([]),x(!1))}catch(o){console.error("Error fetching data:",o),p.error("Failed to fetch owner details. Please try again later.")}finally{w(!1)}},z=async a=>{v(a),y(!0);try{const l=A(i);if(l){const o=await j.post(l);console.log(`API Response for ${i}:`,o.data),y(!1),x(!0)}}catch(l){console.error(`Error fetching data for ${i}:`,l),y(!1)}},V=a=>{v(a),N(!0)},A=a=>({property:"http://172.18.1.108:8000/api/property/details/get-owner-details",water:"http://172.18.1.108:8000/api/water/consumer/get-owner-details",trade_License:"http://172.18.1.108:8000/api/trade/application-search/get-owner-details",septic_Tank_Cleaning:"http://172.18.1.108:8000/api/septic/details",pet_Registration:"http://172.18.1.108:8001/api/pet/application/searh-pet-details",water_Tanker_Booking:"http://172.18.1.108:8000/api/water/tanker",lodge_And_Banquet_Registration:"http://172.18.1.108:8000/api/lodge/details",solid_Waste_User_Charge:"http://172.18.1.108:3000/api/swm/consumerDetalsInformation",Rig_Machine_Registration:"http://172.18.1.108:4000/api/rig/application/searh-application"})[a],W=a=>{},K=ee().shape({description:se().required("Description is required")}),{register:Y,handleSubmit:J,reset:Q,formState:{errors:E}}=te({resolver:ae(K)}),X=async a=>{var l,o,d,R;try{const r=new FormData;r.append("citizenName",(s==null?void 0:s.owner_name)||""),r.append("email",""),r.append("mobileNo",(s==null?void 0:s.mobile_no)||""),r.append("complaintTitle",""),r.append("complaintDescription",a.description||""),r.append("moduleName",q),r.append("ulbName",(s==null?void 0:s.ulb_name)||""),r.append("ulbId","66f3fdb76609dc9d192199d1"),r.append("customAddress",""),r.append("complaintTypeId",""),r.append("imageUrl",void 0),r.append("isTransactionIssue","false"),r.append("transactionNo",""),r.append("isCitizen","1"),r.append("wardNo",""),r.append("area",""),r.append("latitude",""),r.append("longitude",""),r.append("holdingNo",(s==null?void 0:s.holding_no)||""),r.append("safNo",(s==null?void 0:s.saf_no)||""),r.append("grievanceLocation","");const c=await M.mutateAsync({api:ne.createComplaintApplicationDirect,data:r});(l=c.data)!=null&&l.success?(p.success(((o=c==null?void 0:c.data)==null?void 0:o.message)||"Grievance created successfully"),G((d=c==null?void 0:c.data)==null?void 0:d.data),P(!0),Q({description:""}),N(!1)):p.error(((R=c==null?void 0:c.data)==null?void 0:R.message)||"Grievance not created successfully")}catch(r){console.error("Error in onSubmit:",r),p.error("An error occurred while processing the grievance")}};if(n.useEffect(()=>{b("")},[m]),O)return e.jsx(re,{currentLanguage:t,formResponse:$});const Z=()=>i==="property"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Holding Number"}),e.jsx("input",{type:"text",value:(s==null?void 0:s.holding_no)||"",className:"w-full rounded-lg border px-4 py-2 focus:outline-none focus:ring focus:ring-amber-500",disabled:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"SAF Number"}),e.jsx("input",{type:"text",value:(s==null?void 0:s.saf_no)||"",className:"w-full rounded-lg border px-4 py-2 focus:outline-none focus:ring focus:ring-amber-500",disabled:!0})]})]}):i==="water"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Consumer Number"}),e.jsx("input",{type:"text",value:(s==null?void 0:s.consumer_no)||"",className:"w-full rounded-lg border px-4 py-2 focus:outline-none focus:ring focus:ring-amber-500",disabled:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Application Number"}),e.jsx("input",{type:"text",value:(s==null?void 0:s.application_no)||"",className:"w-full rounded-lg border px-4 py-2 focus:outline-none focus:ring focus:ring-amber-500",disabled:!0})]})]}):i==="trade_License"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"License Number"}),e.jsx("input",{type:"text",value:(s==null?void 0:s.license_no)||"",className:"w-full rounded-lg border px-4 py-2 focus:outline-none focus:ring focus:ring-amber-500",disabled:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Application Number"}),e.jsx("input",{type:"text",value:(s==null?void 0:s.application_no)||"",className:"w-full rounded-lg border px-4 py-2 focus:outline-none focus:ring focus:ring-amber-500",disabled:!0})]})]}):i==="Rig_Machine_Registration"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Application number"}),e.jsx("input",{type:"text",value:(s==null?void 0:s.application_no)||"",className:"w-full rounded-lg border px-4 py-2 focus:outline-none focus:ring focus:ring-amber-500",disabled:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:t==null?void 0:t.MOBILE_NO}),e.jsx("input",{type:"text",value:(s==null?void 0:s.application_no)||"",className:"w-full rounded-lg border px-4 py-2 focus:outline-none focus:ring focus:ring-amber-500",disabled:!0})]})]}):i==="pet_Registration"?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Application number"}),e.jsx("input",{type:"text",value:(s==null?void 0:s.application_no)||"",className:"w-full rounded-lg border px-4 py-2 focus:outline-none focus:ring focus:ring-amber-500",disabled:!0})]})}):null;return e.jsxs("div",{children:[e.jsx("div",{className:"min-h-screen bg-gray-100 p-4 md:p-8",children:e.jsxs("div",{className:"mx-auto max-w-7xl rounded-lg bg-white p-4 md:p-8",children:[e.jsx("div",{className:"flex justify-between",children:e.jsxs("h1",{className:"mb-4 text-lg font-bold uppercase text-blue-800 md:mb-6 md:text-xl",children:["TRACK YOUR ",i?i.replace(/_/g," "):""," DETAILS"]})}),e.jsx("div",{className:"mt-1 border-b border-[#99B37C]"}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[e.jsxs("select",{value:m,onChange:a=>B(a.target.value),className:"rounded-lg border px-4 py-2 focus:outline-none focus:ring focus:ring-amber-500",children:[i==="property"&&e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"SAF_NUMBER",children:"SAF Number"}),e.jsx("option",{value:"HOLDING_NUMBER",children:"Holding Number"})]}),i==="water"&&e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"CONSUMER_NUMBER",children:"Consumer Number"}),e.jsx("option",{value:"APPLICATION_NUMBER",children:"Application Number"})]}),i==="trade_License"&&e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"LICENSE_NUMBER",children:"License Number"}),e.jsx("option",{value:"APPLICATION_NUMBER",children:"Application Number"})]}),i==="Rig_Machine_Registration"&&e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"APPLICATION_NUMBER",children:"Application Number"})]}),i==="solid_Waste_User_Charge"&&e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"CONSUMER_NUMBER",children:"Consumer Number"})]}),i==="pet_Registration"&&e.jsxs(e.Fragment,{children:["\\",e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"APPLICATION_NUMBER",children:"Application Number"})]})]}),e.jsx("input",{type:"text",value:h,onChange:a=>b(a.target.value),onKeyDown:a=>{a.key==="Enter"&&S()},placeholder:`Enter your ${m.replace(/_/g," ").toLowerCase()}`,className:"w-full rounded-lg border px-4 py-2 uppercase focus:outline-none focus:ring focus:ring-amber-500"}),e.jsx("button",{type:"button",onClick:S,disabled:g===!0,className:`px-4 py-2 ${g===!0?"bg-gray-500":"bg-amber-500 hover:bg-amber-600"}  rounded-lg font-semibold text-white transition`,children:g?"Searching...":"Search"})]}),F&&(u.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full table-auto border-collapse mt-16 px-8",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-700 uppercase tracking-wide",children:t==null?void 0:t.GRIEVANCE_NO}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-700 uppercase tracking-wide",children:(t==null?void 0:t.USER_NAME)||"User Name"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-700 uppercase tracking-wide",children:(t==null?void 0:t.MOBILE_NO)||"Mobile Number"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-700 uppercase tracking-wide",children:(t==null?void 0:t.ADDR_AT)||"Address"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-700 uppercase tracking-wide",children:(t==null?void 0:t.STATUS)||"Status"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-700 uppercase tracking-wide",children:t==null?void 0:t.VIEW}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-700 uppercase tracking-wide",children:(t==null?void 0:t.ACTION)||"Action"})]})}),e.jsx("tbody",{className:"bg-white",children:Array.isArray(u)&&u.length>0?u.map((a,l)=>e.jsxs("tr",{className:"transition-all duration-200 ease-in-out hover:bg-gray-50 hover:shadow-md",children:[e.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:a.consumer_id||l+1}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:a.owner_name&&a.applicant_name&&applicant_name?`${a.owner_name} | ${a.applicant_name} | ${a.applicant_name}`:a.owner_name||a.applicant_name||a.applicant_name||"N/A"}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:a.mobile_no||"N/A"}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:a.prop_address&&a.address?`${a.prop_address} | ${a.address}`:a.prop_address||a.address||"N/A"}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:a.status==="Active"?e.jsx("span",{className:"inline-flex items-center rounded-full bg-green-500 px-4 py-2 text-white text-xs font-medium capitalize shadow-md",children:t==null?void 0:t.A}):e.jsx("span",{className:"inline-flex items-center rounded-full bg-red-500 px-4 py-2 text-white text-xs font-medium capitalize shadow-md",children:t==null?void 0:t.IA})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("button",{className:"bg-gray-600 px-6 py-3 text-sm font-semibold text-white rounded-lg shadow-md transition duration-300 ease-in-out transform hover:bg-gray-700 hover:scale-105",onClick:()=>z(a),children:H?e.jsx("span",{className:"animate-pulse",children:"Loading..."}):t==null?void 0:t.VIEW})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("button",{className:"bg-blue-600 px-6 py-3 text-sm font-semibold text-white rounded-lg shadow-md transition duration-300 ease-in-out transform hover:bg-blue-700 hover:scale-105",onClick:()=>V(a),children:"Proceed As Grievance"})})]},a.id||l)):e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-6 py-4 text-sm text-center text-gray-700",children:"No data available"})})})]})}):e.jsx("div",{className:"text-base font-semibold text-gray-600 md:text-lg",children:(t==null?void 0:t.NO_DATA_FOUND)||"No Data Found"}))]})]})}),D&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"w-full max-w-4xl rounded-lg bg-white p-6 shadow-lg",children:[e.jsx("h2",{className:"mb-4 text-xl font-bold",children:"Proceed with Grievance"}),e.jsxs("form",{onSubmit:J(X),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"User Name"}),e.jsx("input",{type:"text",value:`${(s==null?void 0:s.owner_name)||""} ${(s==null?void 0:s.applicant_name)||""}`,className:"w-full rounded-lg border px-4 py-2 focus:outline-none focus:ring focus:ring-amber-500",disabled:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:t==null?void 0:t.MOBILE_NO}),e.jsx("input",{type:"text",value:(s==null?void 0:s.mobile_no)||"",className:"w-full rounded-lg border px-4 py-2 focus:outline-none focus:ring focus:ring-amber-500",disabled:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Address"}),e.jsx("input",{type:"text",value:`${(s==null?void 0:s.prop_address)||""} ${(s==null?void 0:s.address)||""}`,className:"w-full rounded-lg border px-4 py-2 focus:outline-none focus:ring focus:ring-amber-500",disabled:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"ULB Name"}),e.jsx("input",{type:"text",value:(s==null?void 0:s.ulb_name)||"",className:"w-full rounded-lg border px-4 py-2 focus:outline-none focus:ring focus:ring-amber-500",disabled:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"ULB ID"}),e.jsx("input",{type:"text",value:"66f3fdb76609dc9d192199d1",className:"w-full rounded-lg border px-4 py-2 focus:outline-none focus:ring focus:ring-amber-500",disabled:!0})]}),Z()]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),e.jsx("textarea",{...Y("description",{required:!0}),className:"w-full rounded-lg border px-4 py-2 focus:outline-none focus:ring focus:ring-amber-500",placeholder:"Enter your description here"}),E.description&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:E.description.message})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>N(!1),className:"rounded-lg bg-gray-300 px-4 py-2 font-semibold text-gray-800 transition hover:bg-gray-400",children:"No"}),e.jsx("button",{type:"submit",className:"rounded-lg bg-amber-500 px-4 py-2 font-semibold text-white transition hover:bg-amber-600",children:"Proceed"})]})]})]})})]})}function xe(){const{currentLanguage:t}=I();return e.jsxs("div",{className:"grid sm:grid-cols-4 grid-cols-1",children:[e.jsxs("div",{className:"col-span-4 md:col-span-1 flex items-center flex-col md:px-10 mt-10 space-y-4 hidden sm:block",children:[e.jsx(ie,{className:"text-xl text-primary font-bold",children:t==null?void 0:t.TRACK_GR}),e.jsx(le,{src:"/images/complain_boy.png",className:"w-40"}),e.jsx(C,{className:"text-center",children:t==null?void 0:t.FF_FB}),e.jsx(C,{className:"text-center",children:t==null?void 0:t.YF_FB})]}),e.jsx("div",{className:"col-span-4 md:col-span-3 p-2 sm:p-10 bg-gray-50 h-screen",children:e.jsx(oe,{})})]})}export{xe as default};
