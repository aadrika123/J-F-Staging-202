import{z as ba,r as m,b as Na,o as ya,s as o,g as d,j as a,F as fa,y as da,a0 as c,R as v,J as i,B as ma,t as va,v as Ia,H as Ta,w as Aa,S as wa,x as ca,a2 as u,L as Sa,G as I,c as Pa,d as n,P as $a,_ as T}from"./index-ZzU_zvvp.js";import{T as Da,a as ka,b as oa,c as r,d as Fa,e as t}from"./table-DWuBJSpA.js";import{P as Ca}from"./index-DNX4xoqE.js";import{P as Ra}from"./index-B9n1nnQb.js";const _a=Pa().shape({ulbId:n(),moduleId:n(),complaintTypeId:n(),priorityId:n(),targetTypeId:n(),complaintSourceTypeId:n(),departmentId:n(),fDate:n(),slaStatusSearch:n(),toDate:n(),complaintRefNo:n()});function Ma(){var A,w,S,P,$,D,k,F,C,R,_,M,H,G,B,L,Y,U,O,z,E,V,J,q,K,Q,W,X,Z,aa,ea,la,sa,ra;const ia=ba({}),[x,ha]=m.useState(1),[h,pa]=m.useState(10),l=Na({resolver:ya(_a),defaultValues:{ulbId:"",moduleId:"",complaintTypeId:"",priorityId:"",targetTypeId:"",slaStatusSearch:"",complaintSourceTypeId:"",departmentId:"",fDate:"",toDate:"",complaintRefNo:""}});console.log("methods");const ua=async()=>{s.refetch()},s=o({api:`${d.complaintReport}?page=${x}&limit=${h}&priority=${l.watch("priorityId")}&ulb=${l.watch("ulbId")}&complaintType=${l.watch("complaintTypeId")}&targetType=${l.watch("targetTypeId")}&module=${l.watch("moduleId")}&source=${l.watch("complaintSourceTypeId")}&fDate=${l.watch("fDate")}&toDate=${l.watch("toDate")}&complaintRefNo=${l.watch("complaintRefNo")}&slaStatusSearch=${l.watch("slaStatusSearch")}&departmentId=${l.watch("departmentId")}`,key:"searchAllComplaints",value:[x,h],options:{enabled:!0}}),xa=o({api:`${(A=d)==null?void 0:A.getAllUlb}?page=1&limit=10000`,key:"getAllUlb",options:{enabled:!0}});o({api:`${(w=d)==null?void 0:w.getAllModule}?page=1&limit=10000`,key:"geAllModules",options:{enabled:!0}});const j=o({api:`${(S=d)==null?void 0:S.getAllComplaintType}?page=1&limit=10000`,key:"getAllComplaintTypes",options:{enabled:!0}}),b=o({api:`${(P=d)==null?void 0:P.getAllPriority}?page=1&limit=10000`,key:"getAllPriority",options:{enabled:!0}}),N=o({api:`${($=d)==null?void 0:$.getAllTarget}?page=1&limit=10000`,key:"getAllTargetTypes",options:{enabled:!0}}),y=o({api:`${d.getAllComplaintSource}?page=1&limit=10000`,key:"getAllComplaintSource",options:{enabled:!0}}),f=o({api:`${d.getAllDepartment}?page=1&limit=10000`,key:"getAllDepartment",options:{enabled:!0,refetchOnMount:!1}});o({api:`${d.getAllProblemDirect}?page=1&limit=10000`,key:"getProblemData",options:{enabled:!0,refetchOnMount:!1}});const ga=m.useRef(null),ja=async e=>{$a("Do you want to highlight this complaint?","Please confirm",async()=>{var p;try{(p=(await ia.mutateAsync({api:`${d.updateComplaintApplicationById}/${e}`,data:{isHighlighted:!0}})).data)!=null&&p.success?T.success("This Application is now highlighted"):T.error("This Application is not highlighted")}catch{T.error("This Application is not highlighted")}})};return a.jsxs(a.Fragment,{children:[a.jsx(fa,{methods:l,onSubmit:l.handleSubmit(ua),children:a.jsxs("div",{className:"grid grid-cols-4 gap-x-2 gap-y-4 bg-background px-10 py-4",children:[a.jsxs("h1",{className:"col-span-4 text-xl font-bold uppercase text-blue-800",children:["Search Grievance"," "]}),a.jsx(da,{className:"col-span-4"}),a.jsxs("div",{children:[a.jsx(c,{htmlFor:"complaintRefNo",children:"Grievance No."}),a.jsx(v,{name:"complaintRefNo",className:"",placeholder:"Enter Grievance number"})]}),a.jsxs("div",{children:[a.jsx(c,{htmlFor:"fDate",children:"From Date"}),a.jsx(v,{name:"fDate",type:"date",className:""})]}),a.jsxs("div",{children:[a.jsx(c,{htmlFor:"toDate",children:"Upto Date"}),a.jsx(v,{name:"toDate",type:"date",className:""})]}),a.jsxs("div",{children:[a.jsx(c,{htmlFor:"ulbId",children:"ULB"}),a.jsx(i,{className:"cursor-pointer bg-background",name:"ulbId",data:((F=(k=(D=xa.data)==null?void 0:D.data)==null?void 0:k.docs)==null?void 0:F.map(e=>({value:e==null?void 0:e._id,label:e==null?void 0:e.ulbName})))??[]})]}),a.jsxs("div",{children:[a.jsx(c,{htmlFor:"departmentId",children:"Department"}),a.jsx(i,{className:"cursor-pointer bg-background",name:"departmentId",data:((_=(R=(C=f==null?void 0:f.data)==null?void 0:C.data)==null?void 0:R.docs)==null?void 0:_.map(e=>({value:e==null?void 0:e._id,label:e==null?void 0:e.department})))??[]})]}),a.jsxs("div",{children:[a.jsx(c,{htmlFor:"complaintTypeId",children:"Grievance Type"}),a.jsx(i,{className:"cursor-pointer bg-background",name:"complaintTypeId",data:((G=(H=(M=j==null?void 0:j.data)==null?void 0:M.data)==null?void 0:H.docs)==null?void 0:G.map(e=>({value:e==null?void 0:e._id,label:e==null?void 0:e.complaintTypeName})))??[]})]}),a.jsxs("div",{children:[a.jsx(c,{htmlFor:"priorityId",children:"Priority"}),a.jsx(i,{className:"cursor-pointer bg-background",name:"priorityId",data:((Y=(L=(B=b==null?void 0:b.data)==null?void 0:B.data)==null?void 0:L.docs)==null?void 0:Y.map(e=>({value:e==null?void 0:e._id,label:e==null?void 0:e.priorityName})))??[]})]}),a.jsxs("div",{children:[a.jsx(c,{htmlFor:"targetTypeId",children:"Target Type"}),a.jsx(i,{className:"cursor-pointer bg-background",name:"targetTypeId",data:((z=(O=(U=N==null?void 0:N.data)==null?void 0:U.data)==null?void 0:O.docs)==null?void 0:z.map(e=>({value:e==null?void 0:e._id,label:e==null?void 0:e.targetType})))??[]})]}),a.jsxs("div",{children:[a.jsx(c,{htmlFor:"complaintSourceTypeId",children:"Grievance Source Type"}),a.jsx(i,{className:"cursor-pointer bg-background",name:"complaintSourceTypeId",data:((J=(V=(E=y==null?void 0:y.data)==null?void 0:E.data)==null?void 0:V.docs)==null?void 0:J.map(e=>({value:e==null?void 0:e._id,label:e==null?void 0:e.source})))??[]})]}),a.jsxs("div",{children:[a.jsx(c,{htmlFor:"type",children:"Grievance Status"}),a.jsx(i,{name:"type",data:[{value:"0",label:"Pending"},{value:"1",label:"Resolved"},{value:"2",label:"Rejected"},{value:"3",label:"Pending (Re-Opened)"},{value:"4",label:"Close"}]})]}),a.jsx("div",{}),a.jsx("div",{className:"mt-6",children:a.jsx(ma,{isLoading:l.formState.isSubmitting,type:"submit",className:" float-right  w-auto px-10",children:"Search"})})]})}),a.jsx("div",{className:"mt-2",children:a.jsxs(va,{children:[a.jsx(Ia,{className:"px-7",children:a.jsx(Ta,{className:"flex justify-between",children:a.jsxs("h1",{children:["Grievance List (",(K=(q=s.data)==null?void 0:q.data)==null?void 0:K.totalDocs,")"]})})}),a.jsx(Aa,{children:s.isLoading?a.jsx("div",{className:"flex h-32 items-center justify-center",children:a.jsx(wa,{})}):a.jsxs("div",{children:[a.jsxs(Da,{ref:ga,children:[a.jsx(ka,{children:a.jsxs(oa,{children:[a.jsx(r,{className:"",children:"#"}),a.jsx(r,{className:"",children:"Grievance No."}),a.jsx(r,{className:"",children:"Department"}),l.watch("fDate")&&a.jsx(r,{className:"",children:"From Date"}),l.watch("toDate")&&a.jsx(r,{className:"",children:"Upto Date"}),a.jsx(r,{className:"",children:"Ulb Name"}),a.jsx(r,{className:"",children:"Module"}),a.jsx(r,{className:"",children:"Citizen Name"}),a.jsx(r,{className:"",children:"Mobile No."}),a.jsx(r,{className:"",children:"Resolve Status"}),a.jsx(r,{className:"",children:"View"}),a.jsx(r,{className:"",children:"Action"})]})}),a.jsx(Fa,{children:(X=(W=(Q=s==null?void 0:s.data)==null?void 0:Q.data)==null?void 0:W.docs)==null?void 0:X.map((e,ta)=>{var p,g,na;return a.jsxs(oa,{children:[a.jsx(t,{children:x*h-h+ta+1}),a.jsx(t,{children:e.complaintRefNo||"N/A"}),a.jsx(t,{children:((p=e==null?void 0:e.department)==null?void 0:p.department)||"N/A"}),l.watch("fDate")&&a.jsxs(t,{children:[l.watch("fDate")?ca(l.watch("fDate")).format("DD-MM-YYYY"):"N/A"," "]}),l.watch("toDate")&&a.jsx(t,{children:ca(e.createdAt).format("DD-MM-YYYY")||"N/A"}),a.jsx(t,{children:((g=e.ulb)==null?void 0:g.ulbName)||"N/A"}),a.jsx(t,{children:((na=e.module)==null?void 0:na.moduleName)||"N/A"}),a.jsx(t,{children:e.citizenName||"N/A"}),a.jsx(t,{children:e.mobileNo||"N/A"}),a.jsxs(t,{children:[(e==null?void 0:e.wf_status)===4&&a.jsx(u,{variant:"destructive",children:"Closed"}),(e==null?void 0:e.wf_status)===3&&a.jsx(u,{className:"bg-amber-500 text-white",children:"Pending(Re-Opened)"}),(e==null?void 0:e.wf_status)===2&&a.jsx(u,{variant:"destructive",children:"Rejected"}),(e==null?void 0:e.wf_status)===1&&a.jsx(u,{variant:"success",children:"Resolved"}),(e==null?void 0:e.wf_status)===0&&a.jsx(u,{variant:"secondary",children:"Pending"})]}),a.jsx(t,{children:a.jsx(Sa,{to:`/grievance/dashboard/management-complaint-details?complaintRefNo=${e==null?void 0:e.complaintRefNo}
                         &complaintId=${e==null?void 0:e._id}`,children:a.jsx(I,{className:"bg-primary",onClick:()=>{},children:"View"})})}),a.jsx(t,{children:e!=null&&e.isHighlighted?a.jsx(I,{type:"button",className:"bg-green-500",children:"Highlighted"}):a.jsx(I,{type:"button",className:"bg-red-500",onClick:()=>ja(e==null?void 0:e._id),children:"Highlight"})})]},e._id)})})]}),a.jsx(da,{className:"mb-2 mt-4"}),a.jsx("div",{className:"flex w-full justify-end",children:a.jsx(Ca,{page:x,perPage:h,totalPage:(aa=(Z=s==null?void 0:s.data)==null?void 0:Z.data)==null?void 0:aa.totalDocs,hasNextPage:(la=(ea=s==null?void 0:s.data)==null?void 0:ea.data)==null?void 0:la.hasNextPage,hasPrevPage:(ra=(sa=s==null?void 0:s.data)==null?void 0:sa.data)==null?void 0:ra.hasPrevPage,setPage:ha,setPerPage:pa})})]})})]})})]})}function Ya(){return a.jsx(Ra,{title:"",subTitle:"",children:a.jsx("div",{className:"",children:a.jsx(Ma,{})})})}export{Ya as default};
