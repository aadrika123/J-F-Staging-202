import{r as y,b as ua,o as xa,s as c,g as o,j as a,F as ja,y as ra,a0 as n,R as m,J as i,B as ga,t as ba,v as Na,H as ya,w as ma,S as va,x as da,a2 as h,L as fa,G as Ia,c as Ta,d as r}from"./index-BoebHciv.js";import{T as wa,a as Aa,b as ta,c as d,d as $a,e as t}from"./table-F8xj1UnI.js";import{P as Pa}from"./index-DFp10HXo.js";import{P as Da}from"./index-KZqQz_ZP.js";const Sa=Ta().shape({ulbId:r(),moduleId:r(),complaintTypeId:r(),priorityId:r(),targetTypeId:r(),complaintSourceTypeId:r(),departmentId:r(),fDate:r(),type:r(),toDate:r(),complaintRefNo:r()});function Fa(){var v,f,I,T,w,A,$,P,D,S,F,k,R,C,_,M,G,L,Y,H,U,B,O,E,V,z,J,q,K,Q,W,X,Z,aa;const[u,na]=y.useState(1),[p,ca]=y.useState(10),l=ua({resolver:xa(Sa),defaultValues:{ulbId:"",moduleId:"",complaintTypeId:"",priorityId:"",targetTypeId:"",type:"",complaintSourceTypeId:"",departmentId:"",fDate:"",toDate:"",complaintRefNo:""}});console.log("methods");const oa=async()=>{s.refetch()},s=c({api:`${o.complaintReport}?page=${u}&limit=${p}&priority=${l.watch("priorityId")}&ulb=${l.watch("ulbId")}&complaintType=${l.watch("complaintTypeId")}&targetType=${l.watch("targetTypeId")}&module=${l.watch("moduleId")}&source=${l.watch("complaintSourceTypeId")}&fDate=${l.watch("fDate")}&toDate=${l.watch("toDate")}&complaintRefNo=${l.watch("complaintRefNo")}&type=${l.watch("type")}&departmentId=${l.watch("departmentId")}`,key:"searchAllComplaints",value:[u,p],options:{enabled:!0}}),ia=c({api:`${(v=o)==null?void 0:v.getAllUlb}?page=1&limit=10000`,key:"getAllUlb",options:{enabled:!0}});c({api:`${(f=o)==null?void 0:f.getAllModule}?page=1&limit=10000`,key:"geAllModules",options:{enabled:!0}});const x=c({api:`${(I=o)==null?void 0:I.getAllComplaintType}?page=1&limit=10000`,key:"getAllComplaintTypes",options:{enabled:!0}}),j=c({api:`${(T=o)==null?void 0:T.getAllPriority}?page=1&limit=10000`,key:"getAllPriority",options:{enabled:!0}}),g=c({api:`${(w=o)==null?void 0:w.getAllTarget}?page=1&limit=10000`,key:"getAllTargetTypes",options:{enabled:!0}}),b=c({api:`${o.getAllComplaintSource}?page=1&limit=10000`,key:"getAllComplaintSource",options:{enabled:!0}}),N=c({api:`${o.getAllDepartment}?page=1&limit=10000`,key:"getAllDepartment",options:{enabled:!0,refetchOnMount:!1}});c({api:`${o.getAllProblemDirect}?page=1&limit=10000`,key:"getProblemData",options:{enabled:!0,refetchOnMount:!1}});const pa=y.useRef(null);return a.jsxs(a.Fragment,{children:[a.jsx(ja,{methods:l,onSubmit:l.handleSubmit(oa),children:a.jsxs("div",{className:"grid grid-cols-4 gap-x-2 gap-y-4 bg-background px-10 py-4",children:[a.jsxs("h1",{className:"col-span-4 text-xl font-bold uppercase text-blue-800",children:["Search Grievance"," "]}),a.jsx(ra,{className:"col-span-4"}),a.jsxs("div",{children:[a.jsx(n,{htmlFor:"complaintRefNo",children:"Grievance No."}),a.jsx(m,{name:"complaintRefNo",className:"",placeholder:"Enter Grievance number"})]}),a.jsxs("div",{children:[a.jsx(n,{htmlFor:"fDate",children:"From Date"}),a.jsx(m,{name:"fDate",type:"date",className:""})]}),a.jsxs("div",{children:[a.jsx(n,{htmlFor:"toDate",children:"Upto Date"}),a.jsx(m,{name:"toDate",type:"date",className:""})]}),a.jsxs("div",{children:[a.jsx(n,{htmlFor:"ulbId",children:"ULB"}),a.jsx(i,{className:"cursor-pointer bg-background",name:"ulbId",data:((P=($=(A=ia.data)==null?void 0:A.data)==null?void 0:$.docs)==null?void 0:P.map(e=>({value:e==null?void 0:e._id,label:e==null?void 0:e.ulbName})))??[]})]}),a.jsxs("div",{children:[a.jsx(n,{htmlFor:"departmentId",children:"Department"}),a.jsx(i,{className:"cursor-pointer bg-background",name:"departmentId",data:((F=(S=(D=N==null?void 0:N.data)==null?void 0:D.data)==null?void 0:S.docs)==null?void 0:F.map(e=>({value:e==null?void 0:e._id,label:e==null?void 0:e.department})))??[]})]}),a.jsxs("div",{children:[a.jsx(n,{htmlFor:"complaintTypeId",children:"Grievance Type"}),a.jsx(i,{className:"cursor-pointer bg-background",name:"complaintTypeId",data:((C=(R=(k=x==null?void 0:x.data)==null?void 0:k.data)==null?void 0:R.docs)==null?void 0:C.map(e=>({value:e==null?void 0:e._id,label:e==null?void 0:e.complaintTypeName})))??[]})]}),a.jsxs("div",{children:[a.jsx(n,{htmlFor:"priorityId",children:"Priority"}),a.jsx(i,{className:"cursor-pointer bg-background",name:"priorityId",data:((G=(M=(_=j==null?void 0:j.data)==null?void 0:_.data)==null?void 0:M.docs)==null?void 0:G.map(e=>({value:e==null?void 0:e._id,label:e==null?void 0:e.priorityName})))??[]})]}),a.jsxs("div",{children:[a.jsx(n,{htmlFor:"targetTypeId",children:"Target Type"}),a.jsx(i,{className:"cursor-pointer bg-background",name:"targetTypeId",data:((H=(Y=(L=g==null?void 0:g.data)==null?void 0:L.data)==null?void 0:Y.docs)==null?void 0:H.map(e=>({value:e==null?void 0:e._id,label:e==null?void 0:e.targetType})))??[]})]}),a.jsxs("div",{children:[a.jsx(n,{htmlFor:"complaintSourceTypeId",children:"Grievance Source Type"}),a.jsx(i,{className:"cursor-pointer bg-background",name:"complaintSourceTypeId",data:((O=(B=(U=b==null?void 0:b.data)==null?void 0:U.data)==null?void 0:B.docs)==null?void 0:O.map(e=>({value:e==null?void 0:e._id,label:e==null?void 0:e.source})))??[]})]}),a.jsxs("div",{children:[a.jsx(n,{htmlFor:"type",children:"Grievance Status"}),a.jsx(i,{name:"type",data:[{value:"0",label:"Pending"},{value:"1",label:"Resolved"},{value:"2",label:"Rejected"},{value:"3",label:"Pending (Re-Opened)"},{value:"4",label:"Close"}]})]}),a.jsx("div",{}),a.jsx("div",{className:"mt-6",children:a.jsx(ga,{isLoading:l.formState.isSubmitting,type:"submit",className:" float-right  w-auto px-10",children:"Search"})})]})}),a.jsx("div",{className:"mt-2",children:a.jsxs(ba,{children:[a.jsx(Na,{className:"px-7",children:a.jsx(ya,{className:"flex justify-between",children:a.jsxs("h1",{children:["Grievance List (",(V=(E=s.data)==null?void 0:E.data)==null?void 0:V.totalDocs,")"]})})}),a.jsx(ma,{children:s.isLoading?a.jsx("div",{className:"flex h-32 items-center justify-center",children:a.jsx(va,{})}):a.jsxs("div",{children:[a.jsxs(wa,{ref:pa,children:[a.jsx(Aa,{children:a.jsxs(ta,{children:[a.jsx(d,{className:"",children:"#"}),a.jsx(d,{className:"",children:"Grievance No."}),a.jsx(d,{className:"",children:"Department"}),l.watch("fDate")&&a.jsx(d,{className:"",children:"From Date"}),l.watch("toDate")&&a.jsx(d,{className:"",children:"Upto Date"}),a.jsx(d,{className:"",children:"Ulb Name"}),a.jsx(d,{className:"",children:"Module"}),a.jsx(d,{className:"",children:"Citizen Name"}),a.jsx(d,{className:"",children:"Mobile No."}),a.jsx(d,{className:"",children:"Resolve Status"}),a.jsx(d,{className:"",children:"View"})]})}),a.jsx($a,{children:(q=(J=(z=s==null?void 0:s.data)==null?void 0:z.data)==null?void 0:J.docs)==null?void 0:q.map((e,ha)=>{var ea,la,sa;return a.jsxs(ta,{children:[a.jsx(t,{children:u*p-p+ha+1}),a.jsx(t,{children:e.complaintRefNo||"N/A"}),a.jsx(t,{children:((ea=e==null?void 0:e.department)==null?void 0:ea.department)||"N/A"}),l.watch("fDate")&&a.jsxs(t,{children:[l.watch("fDate")?da(l.watch("fDate")).format("DD-MM-YYYY"):"N/A"," "]}),l.watch("toDate")&&a.jsx(t,{children:da(e.createdAt).format("DD-MM-YYYY")||"N/A"}),a.jsx(t,{children:((la=e.ulb)==null?void 0:la.ulbName)||"N/A"}),a.jsx(t,{children:((sa=e.module)==null?void 0:sa.moduleName)||"N/A"}),a.jsx(t,{children:e.citizenName||"N/A"}),a.jsx(t,{children:e.mobileNo||"N/A"}),a.jsxs(t,{children:[(e==null?void 0:e.wf_status)===4&&a.jsx(h,{variant:"destructive",children:"Closed"}),(e==null?void 0:e.wf_status)===3&&a.jsx(h,{className:"bg-amber-500 text-white",children:"Pending(Re-Opened)"}),(e==null?void 0:e.wf_status)===2&&a.jsx(h,{variant:"destructive",children:"Rejected"}),(e==null?void 0:e.wf_status)===1&&a.jsx(h,{variant:"success",children:"Resolved"}),(e==null?void 0:e.wf_status)===0&&a.jsx(h,{variant:"secondary",children:"Pending"})]}),a.jsx(t,{children:a.jsx(fa,{to:`/grievance/dashboard/management-complaint-details?complaintRefNo=${e==null?void 0:e.complaintRefNo}
                         &complaintId=${e==null?void 0:e._id}`,children:a.jsx(Ia,{className:"bg-primary",onClick:()=>{},children:"View"})})})]},e._id)})})]}),a.jsx(ra,{className:"mb-2 mt-4"}),a.jsx("div",{className:"flex w-full justify-end",children:a.jsx(Pa,{page:u,perPage:p,totalPage:(Q=(K=s==null?void 0:s.data)==null?void 0:K.data)==null?void 0:Q.totalDocs,hasNextPage:(X=(W=s==null?void 0:s.data)==null?void 0:W.data)==null?void 0:X.hasNextPage,hasPrevPage:(aa=(Z=s==null?void 0:s.data)==null?void 0:Z.data)==null?void 0:aa.hasPrevPage,setPage:na,setPerPage:ca})})]})})]})})]})}function Ma(){return a.jsx(Da,{title:"",subTitle:"",children:a.jsx("div",{className:"",children:a.jsx(Fa,{})})})}export{Ma as default};
