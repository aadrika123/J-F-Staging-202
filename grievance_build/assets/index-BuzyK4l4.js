import{r as te,b as me,o as je,s as c,g as i,j as e,F as be,S as oe,Z as r,R as f,G as p,B as ge,t as Ne,v as ye,A as fe,w as we,D as ve,L as Te,z as Ie,c as Ae,d as n}from"./index-DM7OnLOQ.js";import{T as Se,a as Ce,b as re,c as t,d as Pe,e as o}from"./table-DZNEA4zA.js";import{P as ke}from"./index-B78fZc9N.js";import{S as $e}from"./Spinner-CtQw-0Oe.js";import{P as Fe}from"./index-DWmfyQt7.js";const De="/assets/csv1-D7gXXuPV.png",Me="/assets/xcl-CsJ75Zye.png",Re="/assets/pdf-DRnJaAAA.png",Le=Ae().shape({ulbId:n(),moduleId:n(),complaintTypeId:n(),priorityId:n(),targetTypeId:n(),complaintSourceTypeId:n(),fDate:n(),toDate:n(),complaintRefNo:n()});function _e(){var w,v,T,I,A,S,C,P,k,$,F,D,M,R,L,_,U,B,H,z,Y,E,V,J,X,Z,G,W,q,K,O,Q,ee,ae;const[j,ne]=te.useState(1),[h,ce]=te.useState(10),s=me({resolver:je(Le),defaultValues:{ulbId:"",moduleId:"",complaintTypeId:"",priorityId:"",targetTypeId:"",complaintSourceTypeId:"",fDate:"",toDate:"",complaintRefNo:""}});console.log("methods");const ie=async()=>{d.refetch()},d=c({api:`${i.complaintReport}?page=${j}&limit=${h}&priority=${s.watch("priorityId")}&ulb=${s.watch("ulbId")}&complaintType=${s.watch("complaintTypeId")}&module=${s.watch("moduleId")}&source=${s.watch("complaintSourceTypeId")}&fDate=${s.watch("fDate")}&toDate=${s.watch("toDate")}&complaintRefNo=${s.watch("complaintRefNo")}`,key:"searchAllComplaints",value:[j,h],options:{enabled:!0}}),ue=c({api:`${(w=i)==null?void 0:w.getAllUlb}?page=1&limit=10000`,key:"getAllUlb",options:{enabled:!0}}),pe=c({api:`${(v=i)==null?void 0:v.getAllModule}?page=1&limit=10000`,key:"geAllModules",options:{enabled:!0}}),b=c({api:`${(T=i)==null?void 0:T.getAllComplaintType}?page=1&limit=10000`,key:"getAllComplaintTypes",options:{enabled:!0}}),g=c({api:`${(I=i)==null?void 0:I.getAllPriority}?page=1&limit=10000`,key:"getAllPriority",options:{enabled:!0}}),N=c({api:`${(A=i)==null?void 0:A.getAllTarget}?page=1&limit=10000`,key:"getAllTargetTypes",options:{enabled:!0}}),y=c({api:`${i.getAllComplaintSource}?page=1&limit=10000`,key:"getAllComplaintSource",options:{enabled:!0}}),he=a=>{var x,m,le;const l=window.open("","_blank");l&&(l.document.write("<html><head><title>Print</title>"),l.document.write("<style>"),l.document.write("table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }"),l.document.write("th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }"),l.document.write("th { background-color: #f2f2f2; }"),l.document.write("tr:nth-child(even) { background-color: #f2f2f2; }"),l.document.write("</style></head><body>"),l.document.write("<table>"),l.document.write("<tr>"),l.document.write("<th>#</th>"),l.document.write("<th>Complaint No.</th>"),l.document.write("<th>ULB Name</th>"),l.document.write("<th>Module</th>"),l.document.write("<th>Citizen Name</th>"),l.document.write("<th>Mobile No.</th>"),l.document.write("<th>Resolve Status</th>"),l.document.write("</tr>"),(le=(m=(x=a==null?void 0:a.data)==null?void 0:x.data)==null?void 0:m.docs)==null||le.forEach((u,xe)=>{var de,se;l.document.write("<tr>"),l.document.write("<td>"+(xe+1)+"</td>"),l.document.write("<td>"+(u.complaintRefNo||"N/A")+"</td>"),l.document.write("<td>"+(((de=u.ulb)==null?void 0:de.ulbName)||"N/A")+"</td>"),l.document.write("<td>"+(((se=u.module)==null?void 0:se.moduleName)||"N/A")+"</td>"),l.document.write("<td>"+(u.citizenName||"N/A")+"</td>"),l.document.write("<td>"+(u.mobileNo||"N/A")+"</td>"),l.document.write("<td>"+(u.resolveStatus===0?"Pending":"Resolved")+"</td>"),l.document.write("</tr>")}),l.document.write("</table>"),l.document.write("</body></html>"),l.document.close(),l.print())};return e.jsxs(e.Fragment,{children:[e.jsx(be,{methods:s,onSubmit:s.handleSubmit(ie),children:e.jsxs("div",{className:"grid grid-cols-4 gap-x-2 gap-y-4 bg-background px-10 py-4",children:[e.jsx("h1",{className:"text-xl font-bold text-blue-800 uppercase col-span-4",children:"Search Your Complaint "}),e.jsx(oe,{className:"col-span-4"}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"complaintRefNo",children:"Complaint No."}),e.jsx(f,{name:"complaintRefNo",className:"",placeholder:"Enter complaint number"})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"fDate",children:"From Date"}),e.jsx(f,{name:"fDate",type:"date",className:""})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"toDate",children:"Upto Date"}),e.jsx(f,{name:"toDate",type:"date",className:""})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"ulbId",children:"ULB"}),e.jsx(p,{className:"bg-background cursor-pointer",name:"ulbId",data:((P=(C=(S=ue.data)==null?void 0:S.data)==null?void 0:C.docs)==null?void 0:P.map(a=>({value:a==null?void 0:a._id,label:a==null?void 0:a.ulbName})))??[]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"moduleId",children:"Module"}),e.jsx(p,{className:"bg-background cursor-pointer",name:"moduleId",data:((F=($=(k=pe.data)==null?void 0:k.data)==null?void 0:$.docs)==null?void 0:F.map(a=>({value:a==null?void 0:a._id,label:a==null?void 0:a.moduleName})))??[]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"complaintTypeId",children:"Complaint Type"}),e.jsx(p,{className:"bg-background cursor-pointer",name:"complaintTypeId",data:((R=(M=(D=b==null?void 0:b.data)==null?void 0:D.data)==null?void 0:M.docs)==null?void 0:R.map(a=>({value:a==null?void 0:a._id,label:a==null?void 0:a.complaintTypeName})))??[]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"priorityId",children:"Priority"}),e.jsx(p,{className:"bg-background cursor-pointer",name:"priorityId",data:((U=(_=(L=g==null?void 0:g.data)==null?void 0:L.data)==null?void 0:_.docs)==null?void 0:U.map(a=>({value:a==null?void 0:a._id,label:a==null?void 0:a.priorityName})))??[]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"targetTypeId",children:"Target Type"}),e.jsx(p,{className:"bg-background cursor-pointer",name:"targetTypeId",data:((z=(H=(B=N==null?void 0:N.data)==null?void 0:B.data)==null?void 0:H.docs)==null?void 0:z.map(a=>({value:a==null?void 0:a._id,label:a==null?void 0:a.targetType})))??[]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"complaintSourceTypeId",children:"Complaint Source Type"}),e.jsx(p,{className:"bg-background cursor-pointer",name:"complaintSourceTypeId",data:((V=(E=(Y=y==null?void 0:y.data)==null?void 0:Y.data)==null?void 0:E.docs)==null?void 0:V.map(a=>({value:a==null?void 0:a._id,label:a==null?void 0:a.source})))??[]})]}),e.jsx("div",{}),e.jsx("div",{}),e.jsx("div",{className:"mt-6",children:e.jsx(ge,{isLoading:s.formState.isSubmitting,type:"submit",className:" w-auto  px-10 float-right",children:"Search"})})]})}),e.jsx("div",{className:"mt-2",children:e.jsxs(Ne,{children:[e.jsx(ye,{className:"px-7",children:e.jsxs(fe,{className:"flex justify-between",children:[e.jsxs("h1",{children:["Complaint List (",(X=(J=d.data)==null?void 0:J.data)==null?void 0:X.totalDocs,")"]}),e.jsxs("h1",{className:"flex gap-2 ",children:[e.jsx("div",{className:"w-8 cursor-pointer",children:e.jsx("img",{src:De,alt:"csv"})}),e.jsx("div",{className:"w-8 cursor-pointer",children:e.jsx("img",{src:Me,alt:"xcl"})}),e.jsx("button",{className:"w-8 ",onClick:()=>he(d),children:e.jsx("img",{src:Re,alt:"pdf"})})]})]})}),e.jsx(we,{children:d.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx($e,{})}):e.jsxs("div",{children:[e.jsxs(Se,{children:[e.jsx(Ce,{children:e.jsxs(re,{children:[e.jsx(t,{className:"",children:"#"}),e.jsx(t,{className:"",children:"Complaint No."}),e.jsx(t,{className:"",children:"Title"}),e.jsx(t,{className:"",children:"Date"}),e.jsx(t,{className:"",children:"Date"}),e.jsx(t,{className:"",children:"Ulb Name"}),e.jsx(t,{className:"",children:"Module"}),e.jsx(t,{className:"",children:"Citizen Name"}),e.jsx(t,{className:"",children:"Mobile No."}),e.jsx(t,{className:"",children:"Status"}),e.jsx(t,{className:"",children:"Action"})]})}),e.jsx(Pe,{children:(W=(G=(Z=d==null?void 0:d.data)==null?void 0:Z.data)==null?void 0:G.docs)==null?void 0:W.map((a,l)=>{var x,m;return e.jsxs(re,{children:[e.jsx(o,{children:j*h-h+l+1}),e.jsx(o,{children:a.complaintRefNo}),e.jsx(o,{className:"font-semibold",children:a==null?void 0:a.complaintTitle}),e.jsxs(o,{children:[" ",ve(a==null?void 0:a.createdAt).format("DD-MM-YYYY")," "]}),e.jsx(o,{children:((x=a==null?void 0:a.ulb)==null?void 0:x.ulbName)||"N/A"}),e.jsx(o,{children:((m=a==null?void 0:a.module)==null?void 0:m.moduleName)||"N/A"}),e.jsx(o,{children:a==null?void 0:a.citizenName}),e.jsx(o,{children:a==null?void 0:a.mobileNo}),e.jsx(o,{children:(a==null?void 0:a.resolveStatus)==0?"Pending":"Resolved"}),e.jsx(o,{children:e.jsx(Te,{to:`/grievance/dashboard/management-complaint-details?complaintRefNo=${a==null?void 0:a.complaintRefNo}
                         &complaintId=${a==null?void 0:a._id}`,children:e.jsx(Ie,{className:"bg-primary",onClick:()=>{},children:"View"})})})]},a._id)})})]}),e.jsx(oe,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(ke,{page:j,perPage:h,totalPage:(K=(q=d==null?void 0:d.data)==null?void 0:q.data)==null?void 0:K.totalDocs,hasNextPage:(Q=(O=d==null?void 0:d.data)==null?void 0:O.data)==null?void 0:Q.hasNextPage,hasPrevPage:(ae=(ee=d==null?void 0:d.data)==null?void 0:ee.data)==null?void 0:ae.hasPrevPage,setPage:ne,setPerPage:ce})})]})})]})})]})}function Ee(){return e.jsx(Fe,{title:"",subTitle:"",children:e.jsx("div",{className:"",children:e.jsx(_e,{})})})}export{Ee as default};
