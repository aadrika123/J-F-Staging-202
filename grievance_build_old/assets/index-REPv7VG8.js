import{N as Mr,j as e,I as B,x as P,z as $,b as V,o as Q,F as X,C as L,a1 as Rr,a9 as W,a0 as J,A as Z,B as D,c as ee,d as se,g as y,_ as x,s as G,S as kr,G as I,r as A,aa as zr,ab as qr,a2 as j,a3 as z,a4 as q,a5 as H,a6 as R,L as Cr,t as Hr,w as Yr,K as Vr,k as Qr,P as Ar}from"./index-ZzU_zvvp.js";import{P as Xr}from"./index-B9n1nnQb.js";import{p as Ur,M as Y,F as Jr,a as Zr,b as Dr,c as ea,d as sa,e as da,f as ra,g as aa,h as la,i as ca,j as na,k as ia,l as ta,m as xa,n as oa}from"./module.config-CfPJoEiU.js";import{g as O}from"./services-KQnp_8oA.js";import{I as Lr}from"./info-7I8J-PlJ.js";import{T as Or,a as Gr,b as F,c as k,d as Br,e as U}from"./table-DWuBJSpA.js";import{C as ha}from"./chevron-down-Bvt4EYUb.js";import{M as ja}from"./move-right-DPXxaIZ-.js";/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=Mr("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Na=Mr("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);function fa({commentData:a}){var r,N,n;return e.jsx("div",{children:e.jsxs("div",{className:"max-w-lg mx-auto border px-6 py-2 rounded-lg mb-2",children:[e.jsxs("div",{className:"flex items-center mb-4 space-x-2",children:[e.jsx(B,{src:((r=a==null?void 0:a.userId)==null?void 0:r.fullImgUrl)||Ur,alt:"Student",className:"h-6 w-6 rounded-full"})," ",e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-800 font-semibold",children:((N=a==null?void 0:a.userId)==null?void 0:N.fullName)||""}),e.jsx("div",{className:"text-xs italic text-gray-500",children:`(${(n=a==null?void 0:a.roleId)==null?void 0:n.roleName})`||""}),e.jsx("div",{className:"text-xs text-gray-500",children:P(a==null?void 0:a.timeStamp).format("DD-MM-YYYY hh:mm a")})]})]}),e.jsx("p",{className:"text-sm leading-relaxed mb-6",children:a==null?void 0:a.comment})]})})}const va=ee().shape({comment:se().required("Write comment")});function ga({setisDialogOpen:a,complaintData:r,actionPermissions:N}){const n=$({}),t=V({resolver:Q(va)}),f=async o=>{var g,i;let w={complaintId:(i=(g=r==null?void 0:r.data)==null?void 0:g.data)==null?void 0:i._id,comment:o==null?void 0:o.comment};try{const l=await n.mutateAsync({api:y.resolveComplaint,data:w});l.data.success?(x.success(l.data.message),N.refetch(),r==null||r.refetch(),a(!1)):x.error(l.data.message)}catch(l){x.error(O(l))}};return e.jsx(X,{methods:t,onSubmit:t.handleSubmit(f),children:e.jsxs("div",{className:"gap-x-2 gap-y-4 px-10 py-10",children:[e.jsxs("div",{children:[e.jsxs(L,{className:"text-2xl flex items-center justify-between font-bold mb-6",children:[e.jsxs("div",{children:[e.jsx("span",{className:"w-7 h-7 bg-green-600 rounded-full bg-red-5500 text-white inline-flex justify-center items-center mr-2",children:e.jsx(Rr,{className:"inline"})})," Resolve Grievance"]}),e.jsx("div",{children:e.jsx(W,{className:"cursor-pointer hover:bg-red-100 rounded-lg inline",onClick:()=>a(!1)})})]}),e.jsxs(J,{className:"opacity-70 flex items-center",children:[e.jsx("div",{children:e.jsx(Lr,{size:20,className:"inline mr-1"})}),e.jsx("div",{children:"This comment will be visible to citizen."})]}),e.jsx(Z,{className:"bg-background w-full rounded-md p-4 h-40 border mt-2",name:"comment",placeholder:"Comment"})]}),e.jsx("div",{className:"mt-4",children:e.jsx(D,{isLoading:t.formState.isSubmitting,type:"submit",className:" w-full",children:"Resolve"})})]})})}const ba=ee().shape({comment:se().required("Select comment")});function ya({setisDialogOpen:a,complaintData:r,actionPermissions:N}){const n=$({}),t=V({resolver:Q(ba)}),f=async o=>{var g,i;let w={complaintId:(i=(g=r==null?void 0:r.data)==null?void 0:g.data)==null?void 0:i._id,comment:o==null?void 0:o.comment};try{const l=await n.mutateAsync({api:y.rejectComplaint,data:w});l.data.success?(x.success(l.data.message),N.refetch(),r==null||r.refetch(),a(!1)):x.error(l.data.message)}catch(l){x.error(O(l))}};return e.jsx(X,{methods:t,onSubmit:t.handleSubmit(f),children:e.jsxs("div",{className:"gap-x-2 gap-y-4 px-10 py-10",children:[e.jsxs("div",{children:[e.jsxs(L,{className:"text-2xl flex items-center justify-between font-bold mb-6",children:[e.jsxs("div",{children:[e.jsx("span",{className:"w-7 h-7 bg-red-600 rounded-full bg-red-5500 text-white inline-flex justify-center items-center mr-2",children:e.jsx(W,{})})," Reject Grievance"]}),e.jsx("div",{children:e.jsx(W,{className:"cursor-pointer hover:bg-red-100 rounded-lg inline",onClick:()=>a(!1)})})]}),e.jsxs(J,{className:"opacity-70 flex items-center",children:[e.jsx("div",{children:e.jsx(Lr,{size:20,className:"inline mr-1"})}),e.jsx("div",{children:"This comment will be visible to citizen."})]}),e.jsx(Z,{className:"bg-background w-full rounded-md p-4 h-40 border mt-2",name:"comment",placeholder:"Comment"})]}),e.jsx("div",{className:"mt-4",children:e.jsx(D,{isLoading:t.formState.isSubmitting,type:"submit",className:" w-full",children:"Reject"})})]})})}function ma({setisDialogOpen:a,complaintData:r,actionPermissions:N}){var o,w,g,i,l;const n=$({}),t=G({api:`${y.getAllWFUserMappingToTransfer}?workflowId=${(w=(o=r==null?void 0:r.data)==null?void 0:o.data)==null?void 0:w.wf_currentWorkflowId}`,key:"getWorkflowMembers",value:[],options:{enabled:!0}}),f=async h=>{var T,s,c;let M={complaintId:(s=(T=r==null?void 0:r.data)==null?void 0:T.data)==null?void 0:s._id,workflowId:null,userId:h};try{const _=await n.mutateAsync({api:(c=y)==null?void 0:c.transferComplaintToUlb,data:M});_.data.success?(x.success(_.data.message),r==null||r.refetch(),N.refetch(),a(!1)):x.error(_.data.message)}catch(_){x.error(O(_))}};return e.jsx("div",{className:"gap-x-2 gap-y-4 px-10 py-10",children:e.jsxs("div",{children:[e.jsxs(L,{className:"text-2xl flex items-center justify-between font-bold mb-6",children:[e.jsx("div",{children:"Transfer to any Members"}),e.jsx("div",{children:e.jsx(W,{className:"cursor-pointer hover:bg-red-100 rounded-lg inline",onClick:()=>a(!1)})})]}),t.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(kr,{})}):e.jsx(e.Fragment,{children:e.jsxs(Or,{children:[e.jsx(Gr,{children:e.jsxs(F,{children:[e.jsx(k,{className:"",children:"#"}),e.jsx(k,{className:"",children:"Member"}),e.jsx(k,{className:"",children:"Workflow Role"}),e.jsx(k,{children:"Action"})]})}),e.jsx(Br,{children:(l=(i=(g=t==null?void 0:t.data)==null?void 0:g.data)==null?void 0:i.docs)==null?void 0:l.map((h,M)=>e.jsxs(F,{children:[e.jsx(U,{children:M+1}),e.jsx(U,{children:h==null?void 0:h.UserName}),e.jsx(U,{children:h==null?void 0:h.workflowRoleName}),e.jsx(U,{className:"space-x-2",children:e.jsx(I,{name:"bts",type:"button",className:"mr-4",onClick:()=>f(h==null?void 0:h.userId),children:"Transfer"})})]},h._id))})]})})]})})}function wa({setisDialogOpen:a,complaintData:r}){var f,o,w,g,i;const N=$({}),n=G({api:`${(f=y)==null?void 0:f.getAllUlbDirect}?page=1&limit=10000`,key:"getAllUlbDirect",options:{enabled:!0}}),t=async l=>{var h,M,T;try{let s={complaintId:(M=(h=r==null?void 0:r.data)==null?void 0:h.data)==null?void 0:M._id,ulbId:l};const c=await N.mutateAsync({api:(T=y)==null?void 0:T.transferComplaintToUlbSpecific,data:s});c.data.success?(x.success(c.data.message),r.refetch(),a(!1)):x.error(c.data.message)}catch(s){x.error(O(s))}};return e.jsx("div",{className:"gap-x-2 gap-y-4 px-10 py-10 h-[600px] overflow-y-scroll",children:e.jsxs("div",{children:[e.jsxs(L,{className:"text-2xl flex items-center justify-between font-bold mb-6",children:[e.jsxs("div",{children:["Transfer to ULB(",(w=(o=n==null?void 0:n.data)==null?void 0:o.data)==null?void 0:w.length,")"]}),e.jsx("div",{children:e.jsx(W,{className:"cursor-pointer hover:bg-red-100 rounded-lg inline",onClick:()=>a(!1)})})]}),n.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(kr,{})}):e.jsx(e.Fragment,{children:e.jsxs(Or,{children:[e.jsx(Gr,{children:e.jsxs(F,{children:[e.jsx(k,{className:"",children:"#"}),e.jsx(k,{className:"",children:"ULB"}),e.jsx(k,{children:"Action"})]})}),e.jsx(Br,{children:(i=(g=n==null?void 0:n.data)==null?void 0:g.data)==null?void 0:i.map((l,h)=>e.jsxs(F,{children:[e.jsx(U,{children:h+1}),e.jsx(U,{children:l==null?void 0:l.ulbName}),e.jsx(U,{className:"space-x-2",children:e.jsx(I,{name:"bts",type:"button",className:"mr-4",onClick:()=>t(l==null?void 0:l._id),children:"Transfer"})})]},l._id))})]})})]})})}const Ta="https://jharkhandegovernance.com/property/search/fresh/direct/direct",Ia="https://jharkhandegovernance.com/water/waterApplicationSearch",_a="",Ea="",Sa="",pa="",Ca="",Aa="",Ma="",Ra="",ka="",Ua="",La="",Oa="",Ga="",Ba=ee().shape({comment:se().required("Comment is required")});function Pa({setsearchLink:a,setsearchLabel:r}){var de,re,ae,le,ce,ne,ie,te,xe,oe,he,je,ue,Ne,fe,ve,ge,be,ye,me,we,Te,Ie,_e,Ee,Se,pe,Ce,Ae,Me,Re,ke,Ue,Le,Oe,Ge,Be,Pe,We,$e,Fe,Ke,ze,qe,He,Ye,Ve,Qe,Xe,Je,Ze,De,es,ss,ds,rs,as,ls,cs,ns,is,ts,xs,os,hs,js,us,Ns,fs,vs,gs,bs,ys,ms,ws,Ts,Is,_s,Es,Ss,ps,Cs,As,Ms,Rs,ks,Us,Ls,Os,Gs,Bs,Ps,Ws,$s,Fs,Ks,zs,qs,Hs,Ys,Vs,Qs,Xs,Js,Zs,Ds,ed,sd,dd,rd,ad,ld,cd,nd,id,td,xd,od,hd,jd,ud,Nd,fd,vd,gd,bd,yd,md,wd,Td,Id,_d,Ed,Sd,pd,Cd,Ad,Md,Rd,kd,Ud,Ld,Od,Gd,Bd,Pd,Wd,$d,Fd,Kd,zd,qd,Hd,Yd,Vd,Qd,Xd,Jd,Zd,Dd,er,sr,dr,rr,ar,lr,cr;const[N,n]=A.useState(!1),[t,f]=A.useState(0),[o,w]=A.useState(!1),[g,i]=A.useState(!1),l=$({}),T=new URLSearchParams(Qr().search).get("complaintId"),s=G({api:`${y.getComplaintDetailsById}/${T}`,key:"ComplaintDetails",options:{enabled:!0}}),c=G({api:`${y.checkWfActions}/${T}`,key:"actionPermission",options:{enabled:!0}}),_=G({api:`${y.complaintApplicationLog}/${T}`,key:"complaintApplicationLog",options:{enabled:!0}}),E=G({api:`${y.getAllCommentsByComplaintId}/${T}`,key:"getAllComments",options:{enabled:!0}}),K=V({defaultValues:{comment:""},resolver:Q(Ba)}),{handleSubmit:Pr}=K,Wr=async(d,v)=>{var S,p;const b=v.nativeEvent.submitter.name;let u="";b==="comment"&&(u=y.openComment);let m={comment:d.comment,complaintId:(p=(S=s==null?void 0:s.data)==null?void 0:S.data)==null?void 0:p._id};try{const C=await l.mutateAsync({api:u,data:m});C.data.success?(x.success(C.data.message),s==null||s.refetch(),E==null||E.refetch(),c.refetch(),K.reset()):x.error(C.data.message)}catch(C){x.error(O(C))}},$r=async()=>{Ar("Are you sure?","Do you want to move this Grievance to your panel",async()=>{var v,b;let d={complaintId:(b=(v=s==null?void 0:s.data)==null?void 0:v.data)==null?void 0:b._id,comment:""};try{const u=await l.mutateAsync({api:y.moveComplaintToMe,data:d});u.data.success?(n(!0),s==null||s.refetch(),E==null||E.refetch(),c.refetch()):x.error(u.data.message)}catch(u){x.error(O(u))}})},Fr=async d=>{Ar("Are you sure?",`Do you want to ${d.target.checked?"Escalate":"De-Escalate"} this complaint`,async()=>{var b,u;let v={complaintId:(u=(b=s==null?void 0:s.data)==null?void 0:b.data)==null?void 0:u._id};try{const m=await l.mutateAsync({api:y.escalateAction,data:v});m.data.success?(n(!0),s.refetch()):x.error(m.data.message)}catch(m){x.error(O(m))}})},Kr=()=>{var d,v,b,u,m,S,p,C,nr,ir,tr,xr,or,hr,jr,ur,Nr,fr,vr,gr,br,yr,mr,wr,Tr,Ir,_r,Er,Sr,pr;((v=(d=s==null?void 0:s.data)==null?void 0:d.data)==null?void 0:v.moduleId)===Zr&&(a(Ta),r("Search Property Details")),((u=(b=s==null?void 0:s.data)==null?void 0:b.data)==null?void 0:u.moduleId)===Dr&&(a(Ia),r("Search Water Details")),((S=(m=s==null?void 0:s.data)==null?void 0:m.data)==null?void 0:S.moduleId)===ea&&(a(_a),r("Search Trade Details")),((C=(p=s==null?void 0:s.data)==null?void 0:p.data)==null?void 0:C.moduleId)===sa&&(a(Ea),r("Search Pet Registration Details")),((ir=(nr=s==null?void 0:s.data)==null?void 0:nr.data)==null?void 0:ir.moduleId)===Y&&(a(Sa),r("Search Other Details")),((xr=(tr=s==null?void 0:s.data)==null?void 0:tr.data)==null?void 0:xr.moduleId)===da&&(a(pa),r("Search Grievance Details")),((hr=(or=s==null?void 0:s.data)==null?void 0:or.data)==null?void 0:hr.moduleId)===ra&&(a(Ca),r("Search SWM Details")),((ur=(jr=s==null?void 0:s.data)==null?void 0:jr.data)==null?void 0:ur.moduleId)===aa&&(a(Aa),r("Search Water Tanker Details")),((fr=(Nr=s==null?void 0:s.data)==null?void 0:Nr.data)==null?void 0:fr.moduleId)===la&&(a(Ma),r("Search Advertisement Details")),((gr=(vr=s==null?void 0:s.data)==null?void 0:vr.data)==null?void 0:gr.moduleId)===ca&&(a(Ra),r("Search Septic Tank Details")),((yr=(br=s==null?void 0:s.data)==null?void 0:br.data)==null?void 0:yr.moduleId)===na&&(a(ka),r("Search Lodge/Banquet Details")),((wr=(mr=s==null?void 0:s.data)==null?void 0:mr.data)==null?void 0:wr.moduleId)===ia&&(a(Ua),r("Search Marriage Details")),((Ir=(Tr=s==null?void 0:s.data)==null?void 0:Tr.data)==null?void 0:Ir.moduleId)===ta&&(a(La),r("Search Public Transport Details")),((Er=(_r=s==null?void 0:s.data)==null?void 0:_r.data)==null?void 0:Er.moduleId)===xa&&(a(Oa),r("Search Parking Details")),((pr=(Sr=s==null?void 0:s.data)==null?void 0:Sr.data)==null?void 0:pr.moduleId)===oa&&(a(Ga),r("Search Rig Details"))};return A.useEffect(()=>{Kr()},[s==null?void 0:s.data]),A.useEffect(()=>{setTimeout(()=>{n(!1)},1600)},[N]),e.jsxs("main",{className:"grid flex-1 items-start",children:[N&&e.jsx("div",{style:{zIndex:1001},className:"fixed left-0 top-0 z-50 flex h-full w-full items-center justify-center bg-white",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx(zr,{className:"w-24",animationData:qr,loop:!0}),e.jsx("div",{className:"font-semibold",children:"Grievance Moved successfully."})]})}),e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-8 lg:col-span-2",children:[e.jsx("div",{className:"",children:e.jsx("div",{className:" bg-background",children:e.jsxs("div",{className:"mx-auto max-w-7xl  rounded-lg p-8 shadow-lg",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("h1",{className:"mb-6 text-xl font-bold uppercase text-blue-800",children:["Grievance No : ",(re=(de=s==null?void 0:s.data)==null?void 0:de.data)==null?void 0:re.complaintRefNo]}),((ce=(le=(ae=s==null?void 0:s.data)==null?void 0:ae.data)==null?void 0:le.workflow)==null?void 0:ce.workFlowName)&&e.jsxs("h1",{className:"text- Capitalize  mb-6 font-bold",children:[e.jsx("span",{className:"opacity-60",children:"Current Stage : "}),(te=(ie=(ne=s==null?void 0:s.data)==null?void 0:ne.data)==null?void 0:ie.workflow)==null?void 0:te.workFlowName]}),!((he=(oe=(xe=s==null?void 0:s.data)==null?void 0:xe.data)==null?void 0:oe.workflow)!=null&&he.workFlowName)&&e.jsxs("h1",{className:"text- Capitalize  mb-6 font-bold",children:[e.jsx("span",{className:"opacity-60",children:"Current Stage : "}),((ue=(je=s==null?void 0:s.data)==null?void 0:je.data)==null?void 0:ue.currentUser)&&`${(ve=(fe=(Ne=s==null?void 0:s.data)==null?void 0:Ne.data)==null?void 0:fe.currentUser)==null?void 0:ve.fullName} `,((be=(ge=s==null?void 0:s.data)==null?void 0:ge.data)==null?void 0:be.currentWorkflow)&&`(${(we=(me=(ye=s==null?void 0:s.data)==null?void 0:ye.data)==null?void 0:me.currentWorkflow)==null?void 0:we.workFlowName})`,!((Ie=(Te=s==null?void 0:s.data)==null?void 0:Te.data)!=null&&Ie.currentWorkflow)&&!((Ee=(_e=s==null?void 0:s.data)==null?void 0:_e.data)!=null&&Ee.currentUser)&&((pe=(Se=s==null?void 0:s.data)==null?void 0:Se.data)==null?void 0:pe.moduleId)===Y&&"State GRO",!((Ae=(Ce=s==null?void 0:s.data)==null?void 0:Ce.data)!=null&&Ae.currentWorkflow)&&!((Re=(Me=s==null?void 0:s.data)==null?void 0:Me.data)!=null&&Re.currentUser)&&((Ue=(ke=s==null?void 0:s.data)==null?void 0:ke.data)==null?void 0:Ue.moduleId)!==Y&&"ULB GRO"]}),e.jsx("h1",{className:"text-md mb-6  flex items-center font-bold",children:e.jsxs("span",{children:["Status -",((Oe=(Le=s==null?void 0:s.data)==null?void 0:Le.data)==null?void 0:Oe.wf_status)===0&&e.jsx(j,{className:"ml-2 bg-yellow-500",children:"Pending"}),((Be=(Ge=s==null?void 0:s.data)==null?void 0:Ge.data)==null?void 0:Be.wf_status)===1&&e.jsx(j,{className:"ml-2 bg-green-500",children:"Resolved"}),((We=(Pe=s==null?void 0:s.data)==null?void 0:Pe.data)==null?void 0:We.wf_status)===2&&e.jsx(j,{className:"ml-2 bg-red-500",children:"Rejected"}),((Fe=($e=s==null?void 0:s.data)==null?void 0:$e.data)==null?void 0:Fe.wf_status)===3&&e.jsx(j,{className:"ml-2 bg-yellow-500",children:"Pending(re-opened)"}),((ze=(Ke=s==null?void 0:s.data)==null?void 0:Ke.data)==null?void 0:ze.wf_status)===4&&e.jsx(j,{variant:"destructive",children:"Closed"})]})})]}),e.jsxs("p",{className:"mb-2 text-gray-600",children:["Registered on"," ",P((He=(qe=s==null?void 0:s.data)==null?void 0:qe.data)==null?void 0:He.createdAt).format("DD-MM-YYYY")]}),e.jsx("div",{className:"mt-1 border-b border-[#99B37C]"}),e.jsxs("div",{className:"mt-4  grid grid-cols-1 space-y-4   md:grid-cols-3",children:[e.jsxs("div",{className:"flex items-center  space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"Full Name : "}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:((Ve=(Ye=s==null?void 0:s.data)==null?void 0:Ye.data)==null?void 0:Ve.citizenName)||"N/A"})," "]})]}),e.jsxs("div",{className:"flex items-center  space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"Mobile No : "}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:((Xe=(Qe=s==null?void 0:s.data)==null?void 0:Qe.data)==null?void 0:Xe.mobileNo)||"N/A"})," "]})]}),e.jsxs("div",{className:"flex items-center  space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"Email : "}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:((Ze=(Je=s==null?void 0:s.data)==null?void 0:Je.data)==null?void 0:Ze.email)||"N/A"})," "]})]}),e.jsxs("div",{className:"flex items-center  space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"ULB : "}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:(ss=(es=(De=s==null?void 0:s.data)==null?void 0:De.data)==null?void 0:es.ulb)==null?void 0:ss.ulbName})," "]})]}),e.jsxs("div",{className:"flex items-center  space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"Grievance Type : "}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:((as=(rs=(ds=s==null?void 0:s.data)==null?void 0:ds.data)==null?void 0:rs.problemType)==null?void 0:as.problem)||"N/A"})," "]})]}),(((cs=(ls=s==null?void 0:s.data)==null?void 0:ls.data)==null?void 0:cs.holdingNo)||((is=(ns=s==null?void 0:s.data)==null?void 0:ns.data)==null?void 0:is.safNo)||((xs=(ts=s==null?void 0:s.data)==null?void 0:ts.data)==null?void 0:xs.consumerNo))&&e.jsxs(e.Fragment,{children:[((hs=(os=s==null?void 0:s.data)==null?void 0:os.data)==null?void 0:hs.holdingNo)&&e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"Holding No:"}),e.jsx("div",{children:e.jsx("p",{className:"opacity-90",children:s.data.data.holdingNo})})]}),((us=(js=s==null?void 0:s.data)==null?void 0:js.data)==null?void 0:us.safNo)&&e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"SAF No:"}),e.jsx("div",{children:e.jsx("p",{className:"opacity-90",children:s.data.data.safNo})})]}),((fs=(Ns=s==null?void 0:s.data)==null?void 0:Ns.data)==null?void 0:fs.consumerNo)&&e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"Consumer No:"}),e.jsx("div",{children:e.jsx("p",{className:"opacity-90",children:s.data.data.consumerNo})})]})]}),((gs=(vs=s==null?void 0:s.data)==null?void 0:vs.data)==null?void 0:gs.fixedNo)&&e.jsxs("div",{className:"flex items-center  space-x-4",children:[e.jsxs("div",{className:"font-semibold",children:[(ys=(bs=s==null?void 0:s.data)==null?void 0:bs.data)==null?void 0:ys.fixedNoLabel," :"," "]}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:(ws=(ms=s==null?void 0:s.data)==null?void 0:ms.data)==null?void 0:ws.fixedNo})," "]})]}),((Is=(Ts=s==null?void 0:s.data)==null?void 0:Ts.data)==null?void 0:Is.tempNo)&&e.jsxs("div",{className:"flex items-center  space-x-4",children:[e.jsxs("div",{className:"font-semibold",children:[(Es=(_s=s==null?void 0:s.data)==null?void 0:_s.data)==null?void 0:Es.tempNoLabel," :"," "]}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:(ps=(Ss=s==null?void 0:s.data)==null?void 0:Ss.data)==null?void 0:ps.tempNo})," "]})]}),(((As=(Cs=s==null?void 0:s.data)==null?void 0:Cs.data)==null?void 0:As.wf_status)===0||((Rs=(Ms=s==null?void 0:s.data)==null?void 0:Ms.data)==null?void 0:Rs.wf_status)===3)&&e.jsxs("div",{className:"flex items-center  space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"Pending From : "}),e.jsxs("div",{children:[e.jsxs("p",{className:"opacity-90",children:[P().diff(P((Us=(ks=s==null?void 0:s.data)==null?void 0:ks.data)==null?void 0:Us.createdAt),"days")," ","days"]})," "]})]}),((Os=(Ls=s==null?void 0:s.data)==null?void 0:Ls.data)==null?void 0:Os.priorityType)&&e.jsxs("div",{className:"flex items-center  space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"Priority Type : "}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:(Ps=(Bs=(Gs=s==null?void 0:s.data)==null?void 0:Gs.data)==null?void 0:Bs.priorityType)==null?void 0:Ps.priorityName})," "]})]}),(($s=(Ws=s==null?void 0:s.data)==null?void 0:Ws.data)==null?void 0:$s.targetType)&&e.jsxs("div",{className:"flex items-center  space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"Target Type : "}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:((zs=(Ks=(Fs=s==null?void 0:s.data)==null?void 0:Fs.data)==null?void 0:Ks.targetType)==null?void 0:zs.targetType)||"N/A"})," "]})]}),((Hs=(qs=s==null?void 0:s.data)==null?void 0:qs.data)==null?void 0:Hs.complaintType)&&e.jsxs("div",{className:"flex items-center  space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"Grievance Type : "}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:(Qs=(Vs=(Ys=s==null?void 0:s.data)==null?void 0:Ys.data)==null?void 0:Vs.complaintType)==null?void 0:Qs.complaintTypeName})," "]})]}),e.jsx("div",{className:"col-span-3 my-20 border-b border-[#99B37C]"}),e.jsxs("div",{className:"col-span-2 flex flex-col",children:[e.jsx("div",{className:"font-semibold",children:"Title : "}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:((Js=(Xs=s==null?void 0:s.data)==null?void 0:Xs.data)==null?void 0:Js.complaintTitle)||"N/A"})," "]})]}),e.jsxs("div",{className:"col-span-2 flex flex-col",children:[e.jsx("div",{className:"font-semibold",children:"Description : "}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:(Ds=(Zs=s==null?void 0:s.data)==null?void 0:Zs.data)==null?void 0:Ds.complaintDescription})," "]})]}),((sd=(ed=s==null?void 0:s.data)==null?void 0:ed.data)==null?void 0:sd.customAddress)&&e.jsxs("div",{className:"col-span-2 flex flex-col",children:[e.jsx("div",{className:"font-semibold",children:"Address : "}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:(rd=(dd=s==null?void 0:s.data)==null?void 0:dd.data)==null?void 0:rd.customAddress})," "]})]}),e.jsxs("div",{className:"col-span-3 flex flex-col",children:[e.jsx("div",{className:"font-semibold",children:"Grievance Document"}),e.jsxs(z,{children:[e.jsx(q,{}),e.jsx(H,{className:"sm:max-w-[500px]",children:e.jsx("div",{className:"py-4",children:(ld=(ad=s==null?void 0:s.data)==null?void 0:ad.data)!=null&&ld.imgUrl&&((nd=(cd=s==null?void 0:s.data)==null?void 0:cd.data)!=null&&nd.imgUrl.includes(".pdf"))?e.jsx("iframe",{src:(td=(id=s==null?void 0:s.data)==null?void 0:id.data)==null?void 0:td.imgUrl,width:"100%",height:"400px",title:"Document Preview"}):e.jsx(B,{src:(od=(xd=s==null?void 0:s.data)==null?void 0:xd.data)==null?void 0:od.imgUrl,className:"w-80"})})}),e.jsx(R,{asChild:!0,children:e.jsx("div",{className:"cursor-pointer",children:(jd=(hd=s==null?void 0:s.data)==null?void 0:hd.data)!=null&&jd.imgUrl&&((Nd=(ud=s==null?void 0:s.data)==null?void 0:ud.data)!=null&&Nd.imgUrl.includes(".pdf"))?e.jsxs("div",{className:"flex h-20  w-20 items-center justify-center",children:[" ",e.jsx(Jr,{className:"h-20 w-20 "})]}):e.jsx(B,{src:(vd=(fd=s==null?void 0:s.data)==null?void 0:fd.data)==null?void 0:vd.imgUrl,className:"w-40"})})})]})]})]}),e.jsxs("section",{className:"mt-8",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("h2",{className:"text-xl font-semibold text-blue-800",children:["Grievance Flow History"," ",e.jsxs("span",{onClick:()=>w(!o),className:"cursor-pointer",children:[!o&&e.jsxs("span",{className:"rounded-lg bg-gray-100 px-2 py-1 text-xs text-gray-400 hover:bg-gray-200 ",children:["Show ",e.jsx(ua,{size:15,className:"inline"})]}),o&&e.jsxs("span",{className:"rounded-lg bg-gray-100 px-2 py-1 text-xs text-gray-400 hover:bg-gray-200 ",children:["Hide ",e.jsx(ha,{size:15,className:"inline"})]})]})," "]}),((bd=(gd=c==null?void 0:c.data)==null?void 0:gd.permission)==null?void 0:bd.canMoveComplaint)&&e.jsx(I,{onClick:$r,children:"Move Grievance to my Panel"}),((md=(yd=c==null?void 0:c.data)==null?void 0:yd.permission)==null?void 0:md.canUpdate)&&e.jsx(Cr,{to:`/grievance/dashboard/management-complaint-form?complaintId=${(Td=(wd=s==null?void 0:s.data)==null?void 0:wd.data)==null?void 0:Td._id}`,children:e.jsx(I,{children:"Update Details"})})]}),e.jsx("div",{className:"mt-1 border-b border-[#99B37C]"}),o&&e.jsx("div",{className:"mt-4 flex flex-col space-y-4",children:(_d=(Id=_==null?void 0:_.data)==null?void 0:Id.data)==null?void 0:_d.map((d,v)=>{var b,u,m,S,p;return e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{children:v+1}),e.jsxs("div",{children:[(d==null?void 0:d.actionStatus)===0&&e.jsx(j,{className:"text-dark bg-gray-200",children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===1&&e.jsx(j,{className:"bg-green-400 text-white",children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===2&&e.jsx(j,{className:"bg-red-400 text-white",children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===3&&e.jsx(j,{children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===4&&e.jsx(j,{className:"text-dark bg-amber-200",children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===5&&e.jsx(j,{className:"text-dark bg-cyan-200",children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===6&&e.jsx(j,{className:"text-dark bg-cyan-200",children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===7&&e.jsx(j,{className:"text-dark bg-cyan-200",children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===8&&e.jsx(j,{className:"text-dark bg-cyan-200",children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===9&&e.jsx(j,{className:"text-dark bg-cyan-200",children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===10&&e.jsx(j,{className:"text-dark bg-cyan-200",children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===11&&e.jsx(j,{className:"text-dark bg-cyan-200",children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===12&&e.jsx(j,{className:"text-dark bg-cyan-200",children:d==null?void 0:d.statusText}),e.jsx("div",{className:"mt-1 text-xs font-semibold text-gray-600",children:P((u=(b=s==null?void 0:s.data)==null?void 0:b.data)==null?void 0:u.createdAt).format("DD-MM-YYYY hh:mm a")})]}),e.jsx(ja,{}),e.jsxs("div",{children:[e.jsxs(z,{children:[e.jsx(q,{}),e.jsx(H,{className:"sm:max-w-[500px]",children:e.jsx("div",{className:"py-4",children:e.jsx(B,{src:(m=d==null?void 0:d.actionBy)==null?void 0:m.fullImgUrl,className:"w-60"})})}),e.jsx(R,{asChild:!0,children:e.jsx("div",{className:"h-10 w-10 cursor-pointer overflow-hidden rounded-full border",children:e.jsx(B,{src:((S=d==null?void 0:d.actionBy)==null?void 0:S.fullImgUrl)||Ur,className:"w-10 cursor-pointer hover:scale-105"})})})]}),e.jsxs("div",{className:"text-xs text-gray-700",children:["Action by"," ",e.jsx("span",{className:"text-md font-semibold text-black",children:(d==null?void 0:d.actionByUserId)===null?"Direct Citizen":(p=d==null?void 0:d.actionBy)==null?void 0:p.fullName})]})]})]},`flow${v}`)})})]})]})})}),e.jsx(Hr,{"x-chunk":"dashboard-05-chunk-3",children:e.jsxs(Yr,{className:"grid grid-cols-3 py-10",children:[e.jsx("div",{className:"col-span-2 pr-10",children:e.jsxs(X,{methods:K,onSubmit:Pr(Wr),children:[e.jsx("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-4",children:e.jsx("div",{className:"col-span-4",children:e.jsx(Z,{className:"w-full rounded-lg border bg-background p-4",label:"Comment",name:"comment",placeholder:"Enter comment"})})}),e.jsxs(z,{open:g,children:[e.jsx(q,{}),e.jsx(H,{className:"sm:max-w-[500px]",children:e.jsxs("div",{className:"py-4",children:[t===1&&e.jsx(ga,{setisDialogOpen:i,actionPermissions:c,complaintData:s}),t===2&&e.jsx(ya,{setisDialogOpen:i,actionPermissions:c,complaintData:s}),t===3&&e.jsx(ma,{setisDialogOpen:i,complaintData:s,actionPermissions:c}),t===4&&e.jsx(wa,{setisDialogOpen:i,complaintData:s})]})}),e.jsxs("div",{className:"mt-4 flex flex-wrap items-center justify-between",children:[e.jsxs("div",{className:"mr-10",children:[((Sd=(Ed=s==null?void 0:s.data)==null?void 0:Ed.data)==null?void 0:Sd.wf_status)===1&&e.jsxs(L,{className:"mb-4 flex items-center",children:[e.jsx(Rr,{className:"mr-2 inline text-green-500"}),"Grievance Resolved"]}),((Cd=(pd=s==null?void 0:s.data)==null?void 0:pd.data)==null?void 0:Cd.wf_status)===2&&e.jsxs(L,{className:"mb-4 flex items-center",children:[e.jsx(Na,{className:"mr-2 inline text-red-500"}),"Grievance Rejected"]}),(((Md=(Ad=s==null?void 0:s.data)==null?void 0:Ad.data)==null?void 0:Md.wf_status)===0||((kd=(Rd=s==null?void 0:s.data)==null?void 0:Rd.data)==null?void 0:kd.wf_status)===3)&&e.jsxs("div",{className:"mb-4 flex items-center space-x-2",children:[e.jsx(Vr,{checked:(Ld=(Ud=s==null?void 0:s.data)==null?void 0:Ud.data)==null?void 0:Ld.isEscalated,onChange:d=>Fr(d),className:"h-5 w-5 cursor-pointer",type:"checkbox",name:"isTransactionIssue",placeholder:""}),e.jsx(J,{className:"text-amber-700 opacity-80",children:(Gd=(Od=s==null?void 0:s.data)==null?void 0:Od.data)!=null&&Gd.isEscalated?"De-Escalate":"Escalate"})]})]}),e.jsxs("div",{className:"flex justify-end",children:[e.jsx("div",{className:"col-span-4",children:e.jsx(D,{variant:"secondary",name:"comment",className:"mr-4",type:"submit",disabled:l.isPending,isLoading:l.isPending,children:"Direct Comment"})}),(((Pd=(Bd=s==null?void 0:s.data)==null?void 0:Bd.data)==null?void 0:Pd.wf_status)===0||(($d=(Wd=s==null?void 0:s.data)==null?void 0:Wd.data)==null?void 0:$d.wf_status)===3)&&e.jsxs(e.Fragment,{children:[((Kd=(Fd=c==null?void 0:c.data)==null?void 0:Fd.permission)==null?void 0:Kd.isNeededMoreDocuments)&&e.jsx("div",{className:"col-span-4",children:e.jsx(R,{onClick:()=>{i(!0),f(1)},asChild:!0,children:e.jsx(I,{variant:"secondary",name:"bts",className:"mr-4",disabled:l.isPending,children:"Need More Documents"})})}),((qd=(zd=c==null?void 0:c.data)==null?void 0:zd.permission)==null?void 0:qd.canResolve)&&e.jsx("div",{className:"col-span-4",children:e.jsx(R,{onClick:()=>{i(!0),f(1)},asChild:!0,children:e.jsx(I,{variant:"secondary",name:"bts",className:"mr-4",disabled:l.isPending,children:"Resolve"})})}),((Yd=(Hd=c==null?void 0:c.data)==null?void 0:Hd.permission)==null?void 0:Yd.canReject)&&e.jsx("div",{className:"col-span-4",children:e.jsx(R,{onClick:()=>{i(!0),f(2)},asChild:!0,children:e.jsx(I,{variant:"secondary",name:"reject",className:"mr-4",disabled:l.isPending,children:"Reject"})})}),((Qd=(Vd=c==null?void 0:c.data)==null?void 0:Vd.permission)==null?void 0:Qd.canTransferToMember)&&e.jsx("div",{className:"col-span-4",children:e.jsx(R,{onClick:()=>{i(!0),f(3)},asChild:!0,children:e.jsx(I,{name:"approve",disabled:l.isPending,className:"mr-4",children:"Transfer to Current Member"})})}),((Jd=(Xd=c==null?void 0:c.data)==null?void 0:Xd.permission)==null?void 0:Jd.canSendToUlb)&&e.jsx("div",{className:"col-span-4",children:e.jsx(R,{onClick:()=>{i(!0),f(4)},asChild:!0,children:e.jsx(I,{name:"approve",disabled:l.isPending,type:"button",className:"mr-4",children:"Transfer to Ulb"})})}),((Dd=(Zd=c==null?void 0:c.data)==null?void 0:Zd.permission)==null?void 0:Dd.canTransferToWorkflow)&&e.jsx("div",{className:"col-span-4",children:e.jsx(Cr,{to:`/grievance/dashboard/transfer-complaint?parentId=null&levelSerial=1&complaintId=${(sr=(er=s==null?void 0:s.data)==null?void 0:er.data)==null?void 0:sr._id}&complaintRefNo=${(rr=(dr=s==null?void 0:s.data)==null?void 0:dr.data)==null?void 0:rr.complaintRefNo}`,children:e.jsx(I,{name:"approve",disabled:l.isPending,type:"button",children:"Transfer to Workflow"})})})]})]})]})]})]})}),e.jsxs("div",{className:"col-span-1 h-80 overflow-y-scroll md:px-4",children:[e.jsx(L,{className:"mb-2",children:"Comments"}),(cr=(lr=(ar=E==null?void 0:E.data)==null?void 0:ar.data)==null?void 0:lr.data)==null?void 0:cr.map((d,v)=>e.jsx(fa,{commentData:d},`comment${v}`))]})]})})]})]})}function Va(){const[a,r]=A.useState(""),[N,n]=A.useState("");return e.jsx(Xr,{title:"Workflow Details",subTitle:"",searchLink:a,searchLabel:N,children:e.jsx("div",{className:"",children:e.jsx(Pa,{setsearchLink:r,setsearchLabel:n})})})}export{Va as default};
