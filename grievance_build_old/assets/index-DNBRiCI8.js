import{u as Q,bc as ne,r as h,a as M,b as me,o as oe,j as e,D as xe,B as W,F as he,C as ee,a0 as je,R as pe,t as Ne,v as fe,H as N,w as be,S as ve,a2 as j,L as ye,G as ge,c as ue,d as we,g as X,_ as m,I as Ce}from"./index-Cw6kS_bQ.js";import{g as Re}from"./services-KQnp_8oA.js";import{T as Se,a as Te,b as Z,c as o,d as Fe,e as x}from"./table-BIeRixC-.js";const Oe=ue().shape({complaintNo:we().required("Complaint No. is Required")});function _e(){var v,y,g,u,w,C,R,S,T,F,O,_,B,P,E,G,A,H,$,D,I,k,z,V,q,K,U,Y,J;Q({});const d=Q({}),a=ne(),[ae,f]=h.useState(!1),[se,de]=h.useState(!1),[le,te]=h.useState(!0),[b,ce]=h.useState(""),{currentLanguage:c}=M(),p=me({resolver:oe(Oe)});console.log(se);const ie=async t=>{var i,r,n;try{const s=await a.mutateAsync({api:`${X.getComplaintDetailsByComplaintNo}/${t==null?void 0:t.complaintNo}`});(i=s.data)!=null&&i.success?m.success((r=s==null?void 0:s.data)==null?void 0:r.message):m.error((n=s==null?void 0:s.data)==null?void 0:n.message)}catch(s){console.log(s)}},re=async()=>{var t,i,r,n,s,L;try{const l=await d.mutateAsync({api:X.verifyEmailOtp,data:{otp:b,email:(r=(i=(t=a==null?void 0:a.data)==null?void 0:t.data)==null?void 0:i.data)==null?void 0:r.email}});(n=l==null?void 0:l.data)!=null&&n.success?(m.success((s=l==null?void 0:l.data)==null?void 0:s.message),f(!1),te(!0)):m.error((L=l==null?void 0:l.data)==null?void 0:L.message)}catch(l){m.error(Re(l.message))}};return e.jsxs(e.Fragment,{children:[e.jsx(xe,{open:ae,setOpen:f,title:"OTP Send to your Registered Email",setEdit:de,children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-bold mb-4",children:"Enter OTP"}),e.jsxs("form",{onSubmit:t=>t.preventDefault(),children:[e.jsx("input",{value:b,onChange:t=>ce(t.target.value),type:"text",placeholder:"Enter OTP",className:"input-field w-full border border-gray-300 rounded-md p-2"}),e.jsx("div",{children:e.jsx(W,{type:"button",onClick:re,className:"w-full rounded-xl py-6 px-4 mt-2 shadow-none",variant:"outline",children:"Verify OTP"})})]})]})}),e.jsx(he,{methods:p,onSubmit:p.handleSubmit(ie),children:e.jsxs("div",{className:"md:px-24 space-y-4",children:[e.jsx(ee,{className:"text-xl text-primary font-bold",children:c==null?void 0:c.TRACK_GR}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"md:w-4/12",children:[e.jsx(je,{htmlFor:"complaintNo",children:"Grievance Number"}),e.jsx(pe,{className:"bg-background",name:"complaintNo",placeholder:""})]}),e.jsx("div",{className:"col-span-3 mt-7",children:e.jsx(W,{isLoading:p.formState.isSubmitting,type:"submit",className:"w-auto rounded-xl px-10 float-right",children:c==null?void 0:c.SUBMIT})})]})]})}),((y=(v=a==null?void 0:a.data)==null?void 0:v.data)==null?void 0:y.success)&&le&&e.jsx("div",{className:"mt-20 md:px-24",children:e.jsxs(Ne,{children:[e.jsx(fe,{className:"px-7",children:e.jsx(N,{children:"Grievance List"})}),e.jsx(be,{children:a.isPending?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(ve,{})}):e.jsxs(Se,{children:[e.jsx(Te,{children:e.jsxs(Z,{children:[e.jsx(o,{children:"Grievance No."}),e.jsx(o,{children:"Citizen Name"}),e.jsx(o,{children:"Mobile No."}),e.jsx(o,{children:"Status"}),e.jsx(o,{children:"View"})]})}),e.jsx(Fe,{children:e.jsxs(Z,{children:[e.jsx(x,{children:(w=(u=(g=a==null?void 0:a.data)==null?void 0:g.data)==null?void 0:u.data)==null?void 0:w.complaintRefNo}),e.jsx(x,{children:(S=(R=(C=a==null?void 0:a.data)==null?void 0:C.data)==null?void 0:R.data)==null?void 0:S.citizenName}),e.jsx(x,{children:(O=(F=(T=a==null?void 0:a.data)==null?void 0:T.data)==null?void 0:F.data)==null?void 0:O.mobileNo}),e.jsxs(x,{children:[((P=(B=(_=a==null?void 0:a.data)==null?void 0:_.data)==null?void 0:B.data)==null?void 0:P.wf_status)===3&&e.jsx(j,{className:"bg-amber-400 text-white",children:"Pending (re-opened)"}),((A=(G=(E=a==null?void 0:a.data)==null?void 0:E.data)==null?void 0:G.data)==null?void 0:A.wf_status)===2&&e.jsx(j,{variant:"destructive",children:"Rejected"}),((D=($=(H=a==null?void 0:a.data)==null?void 0:H.data)==null?void 0:$.data)==null?void 0:D.wf_status)===1&&e.jsx(j,{variant:"success",children:"Resolved"}),((z=(k=(I=a==null?void 0:a.data)==null?void 0:I.data)==null?void 0:k.data)==null?void 0:z.wf_status)===0&&e.jsx(j,{variant:"secondary",children:"Pending"})]}),e.jsx(x,{children:e.jsx(ye,{to:`/grievance/citizen/complaint-details?complaintRefNo=${(K=(q=(V=a==null?void 0:a.data)==null?void 0:V.data)==null?void 0:q.data)==null?void 0:K.complaintRefNo}&complaintId=${(J=(Y=(U=a==null?void 0:a.data)==null?void 0:U.data)==null?void 0:Y.data)==null?void 0:J._id}`,children:e.jsx(ge,{className:"bg-primary",children:"View"})})})]})})]})})]})})]})}function Ge(){const{currentLanguage:d}=M();return e.jsxs("div",{className:"grid sm:grid-cols-4 grid-cols-1",children:[e.jsxs("div",{className:"col-span-4 md:col-span-1 flex items-center flex-col md:px-10 mt-10 space-y-4 hidden sm:block",children:[e.jsx(ee,{className:"text-xl text-primary font-bold",children:d==null?void 0:d.TRACK_GR}),e.jsx(Ce,{src:"/images/complain_boy.png",className:"w-40"}),e.jsx(N,{className:"text-center",children:d==null?void 0:d.FF_FB}),e.jsx(N,{className:"text-center",children:d==null?void 0:d.YF_FB})]}),e.jsx("div",{className:"col-span-4 md:col-span-3 p-2 sm:p-10 bg-gray-50 h-screen",children:e.jsx(_e,{})})]})}export{Ge as default};
