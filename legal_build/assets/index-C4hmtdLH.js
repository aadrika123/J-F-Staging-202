import{r as d,j as e,l as N,_ as l,B as L}from"./index-BrFK6v_x.js";import{a as K}from"./index-Woh3rRl7.js";import{h as O}from"./moment-C5S46NFB.js";import{S as z,C as Q,a as W,d as X,c as Z}from"./separator-DPXjbqTJ.js";import{T as D,a as ee,b as U,c as x,d as ae,e as g}from"./table-Ck1yGR3o.js";import{u as G,b as J}from"./useCustomQuery-xlRvHaFh.js";import{g as se}from"./services-KQnp_8oA.js";import{P as re}from"./index-BY4kVjxJ.js";import{D as te,S as ce,q as ne}from"./switch-DxPsTAC3.js";import{S as de}from"./Spinner-HHJhJ0D0.js";import{u as le,o as ie,F as oe,R as pe,B as ue,c as he,a as V}from"./switch-BeBAVJ8b.js";import{R as xe}from"./RHFTextField-_t24UekY.js";import"./select-CSRCaCCS.js";import{a as ge}from"./useMasters-B-IIfRz7.js";import{L as je}from"./loader-circle-OMwT9Fky.js";const fe=he().shape({caseSubType:V().required("Case Sub Type is required"),caseTypeId:V().required("Case  Type Id is required")});function ye({open:$,setOpen:p,title:F,id:u,edit:i,setEdit:j,refetch:I}){var y,S;const f=ge(),h=G({}),{data:c,isFetching:_}=J({api:`${N.getCaseSubTypeById}/${u}`,key:"getCaseSubTypeById",options:{enabled:i}}),n=le({defaultValues:{caseSubType:"",caseTypeId:""},resolver:ie(fe)}),v=async s=>{var o,w,m,b,C,T;try{if(i&&s){const t=await h.mutateAsync({api:`${N.updateCaseSubType}`,data:{id:u,...s}});(o=t.data)!=null&&o.success?l.success((w=t==null?void 0:t.data)==null?void 0:w.message):l.error(((m=t.data)==null?void 0:m.message)||"Case Sub Type not updated successfully")}else{const t=await h.mutateAsync({api:N.createCaseSubType,data:s});(b=t.data)!=null&&b.success?l.success((C=t==null?void 0:t.data)==null?void 0:C.message):l.error(((T=t.data)==null?void 0:T.message)||"Case Sub Type not created successfully"),n.reset({caseSubType:"",caseTypeId:""})}p(!1),j(!1),I()}catch(t){console.log(t)}};return d.useEffect(()=>{var s,o;i&&c?n.reset({caseSubType:((s=c==null?void 0:c.data)==null?void 0:s.case_sub_type)||"",caseTypeId:String((o=c==null?void 0:c.data)==null?void 0:o.case_type_id)||""}):n.reset({caseSubType:"",caseTypeId:""})},[i,c]),e.jsx(te,{open:$,setOpen:p,title:F,setEdit:j,edit:i,isLoading:_,children:e.jsx(oe,{methods:n,onSubmit:n.handleSubmit(v),children:e.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[e.jsx("div",{children:e.jsx(pe,{name:"caseTypeId",data:((S=(y=f==null?void 0:f.data)==null?void 0:y.data)==null?void 0:S.map(s=>({label:String(s.case_type),value:String(s.id)})))||[]})}),e.jsx("div",{children:e.jsx(xe,{name:"caseSubType",placeholder:"Enter your case Sub type",inputValidation:["removeSpecialCharacterExceptSpace"]})}),e.jsx(z,{}),e.jsx("div",{children:e.jsx(ue,{isLoading:n.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function Se(){var m,b,C,T,t,A;const $=G({}),[p,F]=d.useState(1),[u,i]=d.useState(10),[j,I]=d.useState(""),[f,h]=d.useState(!1),[c,_]=d.useState(""),[n,v]=d.useState(!1),[y,S]=d.useState(null),s=J({api:`${N.getAllCaseSubType}?page=${p}&limit=${u}&q=${j}`,key:"getAllCaseSubType",value:[p,u],options:{enabled:!0}}),o=a=>{v(!0),h(!0),_(a)},w=async a=>{var P,E,B,k,q,M,H,R,Y;S(a);try{const r=await $.mutateAsync({api:`${(P=N)==null?void 0:P.updateCaseSubTypeStatus}`,data:{id:a}});(E=r==null?void 0:r.data)!=null&&E.success?(s.refetch(),((k=(B=r==null?void 0:r.data)==null?void 0:B.data)==null?void 0:k.status)==1&&l.success((q=r==null?void 0:r.data)==null?void 0:q.message),((H=(M=r==null?void 0:r.data)==null?void 0:M.data)==null?void 0:H.status)==0&&l.error((R=r==null?void 0:r.data)==null?void 0:R.message)):l.error((Y=r.data)==null?void 0:Y.message)}catch(r){l.error(se(r))}finally{S(null)}};return e.jsxs("main",{className:"grid items-start",children:[e.jsx(ye,{open:f,setOpen:h,title:n?"Edit Case Sub Type":"Add Case Sub Type",id:c,edit:n,setEdit:v,refetch:s.refetch}),e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsxs("div",{className:"flex w-full justify-between gap-2",children:[e.jsx("div",{children:e.jsx(ce,{search:j,setSearch:I,refetch:s.refetch,isFetching:s==null?void 0:s.isLoading})}),e.jsx("div",{children:e.jsx(L,{className:"flex items-center gap-2",onClick:()=>h(!0),children:"Add New"})})]}),e.jsxs(Q,{children:[e.jsx(W,{className:"px-7",children:e.jsxs(X,{children:["Case Sub Type List (",(b=(m=s==null?void 0:s.data)==null?void 0:m.pagination)==null?void 0:b.total,")"]})}),e.jsx(Z,{children:s.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(de,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(D,{children:[e.jsx(ee,{children:e.jsxs(U,{children:[e.jsx(x,{className:"",children:"#"}),e.jsx(x,{className:"",children:"Case type "}),e.jsx(x,{className:"",children:"Case sub type name"}),e.jsx(x,{className:"",children:"Created at"}),e.jsx(x,{className:"",children:"Status"}),e.jsx(x,{children:"Action"})]})}),e.jsx(ae,{children:(T=(C=s==null?void 0:s.data)==null?void 0:C.data)==null?void 0:T.map((a,P)=>e.jsxs(U,{children:[e.jsx(g,{children:P+1}),e.jsx(g,{children:a==null?void 0:a.case_type}),e.jsx(g,{children:a==null?void 0:a.case_sub_type}),e.jsx(g,{children:O(a==null?void 0:a.created_at).format("DD-MM-YYYY")}),e.jsx(g,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(ne,{checked:(a==null?void 0:a.status)==1,onChange:()=>w(String(a==null?void 0:a.id)),disabled:y===String(a==null?void 0:a.id),className:`${a!=null&&a.status?"bg-primary":"bg-gray-200"} relative inline-flex h-6 w-11 items-center rounded-full disabled:opacity-50`,children:[e.jsx("span",{className:"sr-only",children:"Enable notifications"}),e.jsx("span",{className:`${a!=null&&a.status?"translate-x-6":"translate-x-1"} inline-block h-4 w-4 transform rounded-full bg-white`})]}),y===String(a==null?void 0:a.id)&&e.jsx(je,{className:"h-4 w-4 animate-spin text-primary"})]})}),e.jsx(g,{children:e.jsx(L,{className:"bg-primary",onClick:()=>o(String(a==null?void 0:a.id)),children:"Edit"})})]},a==null?void 0:a.id))})]}),e.jsx(z,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(re,{page:p,limit:u,totalPages:(A=(t=s==null?void 0:s.data)==null?void 0:t.pagination)==null?void 0:A.totalPages,setPage:F,setLimit:i})})]})})]})]})]})}function ke(){return e.jsx(K,{title:"Case Sub Type List",subTitle:"Manage all the case Sub types here",children:e.jsx("div",{className:"py-12",children:e.jsx(Se,{})})})}export{ke as default};
