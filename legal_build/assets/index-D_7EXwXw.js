import{u as ye,r as x,e as Ce,l as T,j as e,B as u,C as W,h as De,i as Pe,_ as X}from"./index-BrFK6v_x.js";import{a as we}from"./index-Woh3rRl7.js";import{h as f}from"./moment-C5S46NFB.js";import{C as G,a as K,d as Z,c as ee,S as be}from"./separator-DPXjbqTJ.js";import{T as Se,a as Te,b as _,c as o,d as _e,e as l}from"./table-Ck1yGR3o.js";import{I as A,S as ae,a as se,b as te,c as re,d as N}from"./select-CSRCaCCS.js";import{D as Ae,L as g}from"./label-Bm8DE9co.js";import{u as Ye,b as le}from"./useCustomQuery-xlRvHaFh.js";import{P as ke}from"./index-BY4kVjxJ.js";import{S as Me}from"./Spinner-HHJhJ0D0.js";import{F as Ee,X as h,u as Y,w as Fe}from"./xlsx-qX-sHUue.js";import{B as d}from"./badge-ZtyU-N2O.js";import{e as k}from"./crypto-l-Zxl0ID.js";import{L as Ie}from"./loader-circle-OMwT9Fky.js";import{C as $e}from"./chevron-down-DabVK4N-.js";import{R as Re}from"./refresh-cw-Bx2cchEb.js";import{C as ne}from"./calendar-TJe5RBv7.js";import{E as Ue}from"./eye-BtsOOtSC.js";import{S as Oe}from"./square-pen-BMiTYaP3.js";import{S as Be}from"./scale-QvSpQdkc.js";function He({viewUrl:Le}){var $,R,U,O,B,H,L,q,V,z;const ce=Ye({}),{user:n}=ye(),[v,C]=x.useState(1),[y,oe]=x.useState(10),[p,M]=x.useState(""),[D,E]=x.useState(!1);x.useState(null);const[P,F]=x.useState(!0),[s,I]=x.useState({processType:"",fromDate:"",toDate:"",caseNatureParam:"",caseNoParam:""}),w=Ce(),ie=()=>{const a=new URLSearchParams;return a.append("page",v.toString()),a.append("limit",y.toString()),p.trim()&&a.append("q",p.trim()),s.processType&&a.append("processType",s.processType),s.fromDate&&a.append("fromDate",s.fromDate),s.toDate&&a.append("toDate",s.toDate),s.caseNatureParam.trim()&&a.append("caseNatureParam",s.caseNatureParam.trim()),s.caseNoParam.trim()&&a.append("caseNoParam",s.caseNoParam.trim()),a.toString()},t=le({api:`${T.getAllCase}?${ie()}`,key:"getAllCase",value:[v,y,p,s],options:{enabled:!0}}),b=le({api:`${T.getAllCaseNature}`,key:"getAllCaseNature",value:[],options:{enabled:!0}}),de=a=>({1:"Pending",2:"Disposed",3:"Dismissed",4:"Close"})[a]||"Unknown",pe=a=>a==1?"Judge":a==2?"Advocate":a==0?"Case Operator":"Unknown",me=a=>{const r={1:{label:"Pending",variant:"secondary"},2:{label:"Closed",variant:"destructive"}}[a]||{label:"Unknown",variant:"secondary"};return e.jsx(d,{variant:r.variant,children:r.label})};function xe(a){return a==1?e.jsx("h1",{className:"font-bold text-blue-600",children:"Judge"}):a==2?e.jsx("h1",{className:"font-bold text-green-600",children:"Advocate"}):a==0?e.jsx("h1",{className:"font-bold text-red-600",children:"Case Operator"}):e.jsx(d,{variant:"secondary",children:e.jsx(Be,{className:"mr-1 h-3 w-3"})})}const i=(a,m)=>{I(r=>({...r,[a]:m})),C(1)},he=()=>{t.refetch()},ue=()=>{I({processType:"",fromDate:"",toDate:"",caseNatureParam:"",caseNoParam:""}),M(""),C(1),setTimeout(()=>{t.refetch()},100)},j=()=>{let a=0;return p.trim()&&a++,s.processType&&a++,s.fromDate&&a++,s.toDate&&a++,s.caseNatureParam.trim()&&a++,s.caseNoParam.trim()&&a++,a},je=async()=>{var a,m;E(!0);try{const r=new URLSearchParams;r.append("page","1"),r.append("limit","1000"),p.trim()&&r.append("q",p.trim()),s.processType&&r.append("processType",s.processType),s.fromDate&&r.append("fromDate",s.fromDate),s.toDate&&r.append("toDate",s.toDate),s.caseNatureParam.trim()&&r.append("caseNatureParam",s.caseNatureParam.trim()),s.caseNoParam.trim()&&r.append("caseNoParam",s.caseNoParam.trim());const S=await ce.mutateAsync({api:`${T.getAllCase}?${r.toString()}`,data:{}}),fe=(((a=S==null?void 0:S.data)==null?void 0:a.data)||((m=t==null?void 0:t.data)==null?void 0:m.data)||[]).map((c,ve)=>({"S.No":ve+1,"Case No":c.case_no||"","Filed On":f(c.filed_on).format("DD MMM YYYY"),Petitioner:c.petitioner_name||"",Respondent:c.respondent||"-","Process Type":c.process_type?c.process_type.charAt(0).toUpperCase()+c.process_type.slice(1):"-","Case Nature":c.case_nature||"-",Court:c.court_location||"","Current Level":pe(c.application_status),"Current Status":de(c.case_status),Status:c.status===1?"Active":"Inactive"})),J=Y.book_new(),Q=Y.json_to_sheet(fe),Ne=[{wch:6},{wch:15},{wch:12},{wch:20},{wch:20},{wch:15},{wch:20},{wch:20},{wch:15},{wch:15},{wch:10}];Q["!cols"]=Ne,Y.book_append_sheet(J,Q,"Cases Data");const ge=`cases_export_${f().format("YYYY-MM-DD_HH-mm-ss")}.xlsx`;Fe(J,ge),X.success("Data exported successfully!")}catch(r){console.error("Export error:",r),X.error("Failed to export data. Please try again.")}finally{E(!1)}};return e.jsx("main",{className:"grid items-start pb-8",children:e.jsxs("div",{className:"grid auto-rows-max gap-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(u,{onClick:je,disabled:D||t.isLoading,className:"flex items-center gap-2",variant:"outline",children:[D?e.jsx(Ie,{className:"h-4 w-4 animate-spin"}):e.jsx(Ae,{className:"h-4 w-4"}),D?"Exporting...":"Export to Excel"]}),e.jsx(W,{open:P,onOpenChange:F,children:e.jsx(De,{asChild:!0,children:e.jsxs(u,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"h-4 w-4"}),"Filters",j()>0&&e.jsx(d,{variant:"secondary",className:"ml-1 h-5 w-5 rounded-full p-0 text-xs",children:j()}),e.jsx($e,{className:`h-4 w-4 transition-transform ${P?"rotate-180":""}`})]})})})]})}),e.jsx(W,{open:P,onOpenChange:F,children:e.jsx(Pe,{children:e.jsxs(G,{className:"border-dashed shadow-sm",children:[e.jsx(K,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Z,{children:"Filter cases by various criteria"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(u,{onClick:he,size:"sm",className:"flex items-center gap-1",children:[e.jsx(Re,{className:"h-3 w-3"}),"Apply Filters"]}),e.jsxs(u,{onClick:ue,variant:"outline",size:"sm",className:"flex items-center gap-1",children:[e.jsx(h,{className:"h-3 w-3"}),"Clear All"]})]})]})}),e.jsxs(ee,{children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"caseNoParam",children:"Case No"}),e.jsx(A,{id:"caseNoParam",type:"text",placeholder:"Enter case number",value:s.caseNoParam,onChange:a=>i("caseNoParam",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"processType",children:"Process Type"}),e.jsxs(ae,{value:s.processType||"all",onValueChange:a=>i("processType",a==="all"?"":a),children:[e.jsx(se,{children:e.jsx(te,{placeholder:"Select process type"})}),e.jsxs(re,{children:[e.jsx(N,{value:"all",children:"All Process Types"}),e.jsx(N,{value:"Internal",children:"Internal"}),e.jsx(N,{value:"External",children:"External"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"caseNatureParam",children:"Case Nature"}),e.jsxs(ae,{value:s.caseNatureParam||"all",onValueChange:a=>i("caseNatureParam",a==="all"?"":a),children:[e.jsx(se,{children:e.jsx(te,{placeholder:"Select Nature of Case"})}),e.jsxs(re,{children:[e.jsx(N,{value:"all",children:"All Natures"}),(R=($=b==null?void 0:b.data)==null?void 0:$.data)==null?void 0:R.map(a=>e.jsx(N,{value:a.id.toString(),children:a.case_nature},a.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"fromDate",children:"From Date"}),e.jsxs("div",{className:"relative",children:[e.jsx(A,{id:"fromDate",type:"date",value:s.fromDate,onChange:a=>i("fromDate",a.target.value),max:s.toDate||void 0}),e.jsx(ne,{className:"pointer-events-none absolute right-3 top-1/2 h-4 w-4 -translate-y-1/2 transform text-gray-400"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"toDate",children:"To Date"}),e.jsxs("div",{className:"relative",children:[e.jsx(A,{id:"toDate",type:"date",value:s.toDate,onChange:a=>i("toDate",a.target.value),min:s.fromDate||void 0}),e.jsx(ne,{className:"pointer-events-none absolute right-3 top-1/2 h-4 w-4 -translate-y-1/2 transform text-gray-400"})]})]})]}),j()>0&&e.jsx("div",{className:"mt-4 border-t pt-4",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Active filters:"}),p.trim()&&e.jsxs(d,{variant:"outline",className:"flex items-center gap-1",children:["Search: ",p,e.jsx(h,{className:"h-3 w-3 cursor-pointer",onClick:()=>M("")})]}),s.caseNoParam.trim()&&e.jsxs(d,{variant:"outline",className:"flex items-center gap-1",children:["Case No: ",s.caseNoParam,e.jsx(h,{className:"h-3 w-3 cursor-pointer",onClick:()=>i("caseNoParam","")})]}),s.processType&&e.jsxs(d,{variant:"outline",className:"flex items-center gap-1",children:["Process: ",s.processType,e.jsx(h,{className:"h-3 w-3 cursor-pointer",onClick:()=>i("processType","")})]}),s.caseNatureParam&&e.jsxs(d,{variant:"outline",className:"flex items-center gap-1",children:["Nature: ",s.caseNatureParam,e.jsx(h,{className:"h-3 w-3 cursor-pointer",onClick:()=>i("caseNatureParam","")})]}),s.fromDate&&e.jsxs(d,{variant:"outline",className:"flex items-center gap-1",children:["From: ",f(s.fromDate).format("DD/MM/YYYY"),e.jsx(h,{className:"h-3 w-3 cursor-pointer",onClick:()=>i("fromDate","")})]}),s.toDate&&e.jsxs(d,{variant:"outline",className:"flex items-center gap-1",children:["To: ",f(s.toDate).format("DD/MM/YYYY"),e.jsx(h,{className:"h-3 w-3 cursor-pointer",onClick:()=>i("toDate","")})]})]})})]})]})})}),e.jsxs(G,{className:"shadow-md",children:[e.jsx(K,{className:"px-6 pb-2 pt-6",children:e.jsxs(Z,{children:["Total ",((O=(U=t==null?void 0:t.data)==null?void 0:U.pagination)==null?void 0:O.total)||0," Cases",j()>0&&e.jsx("span",{className:"text-blue-600",children:" (filtered)"})]})}),e.jsx(ee,{className:"overflow-x-auto px-6",children:t.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(Me,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(Se,{children:[e.jsx(Te,{children:e.jsxs(_,{children:[e.jsx(o,{children:"#"}),e.jsx(o,{children:"Case No"}),e.jsx(o,{children:"Filed On"}),e.jsx(o,{children:"Petitioner"}),e.jsx(o,{children:"Respondent"}),e.jsx(o,{children:"Process Type"}),e.jsx(o,{children:"Hearing Scheduled"}),e.jsx(o,{children:"Case Nature"}),e.jsx(o,{children:"Court"}),e.jsx(o,{children:"Current Level"}),e.jsx(o,{children:"Current Status"}),e.jsx(o,{children:"Action"})]})}),e.jsx(_e,{children:((H=(B=t==null?void 0:t.data)==null?void 0:B.data)==null?void 0:H.length)===0?e.jsx(_,{children:e.jsx(l,{colSpan:11,className:"h-32 text-center text-gray-500",children:j()>0?"No cases found matching the selected filters.":"No cases found."})}):(q=(L=t==null?void 0:t.data)==null?void 0:L.data)==null?void 0:q.map((a,m)=>e.jsxs(_,{children:[e.jsx(l,{children:(v-1)*y+m+1}),e.jsx(l,{className:"font-medium",children:a.case_no}),e.jsx(l,{children:f(a.filed_on).format("DD MMM YYYY")}),e.jsx(l,{children:a.petitioner_name}),e.jsx(l,{children:a.respondent||"-"}),e.jsx(l,{children:a.process_type?e.jsx("span",{className:`rounded-full px-3 py-1 text-xs font-bold 
          ${a.process_type.toLowerCase()==="internal"?" text-blue-700":" text-green-600"}`,children:a.process_type.charAt(0).toUpperCase()+a.process_type.slice(1)}):"-"}),e.jsx(l,{children:a.next_hearing_date||"-"}),e.jsx(l,{children:a.case_nature||"-"}),e.jsx(l,{children:a.court_location}),e.jsx(l,{children:xe(a.application_status)}),e.jsx(l,{children:me(a.case_status)}),e.jsx(l,{children:e.jsxs("div",{className:"flex items-center gap-2 ",children:[e.jsx(u,{className:"p-2.5 text-blue-600",variant:"outline",onClick:()=>{(n==null?void 0:n.roleId)==75||(n==null?void 0:n.roleId)==76?w(`/legal/dashboard/case-view-details-all/${k(String(a.id))}`):w(`/legal/dashboard/case-view-details/${k(String(a.id))}`)},children:e.jsx(Ue,{})}),(n==null?void 0:n.roleId)!==75&&(n==null?void 0:n.roleId)!==76&&a.case_status!=="2"&&e.jsx(u,{className:"p-2.5 text-green-600",variant:"outline",onClick:()=>w(`/legal/dashboard/edit-case-details/${k(String(a.id))}`),children:e.jsx(Oe,{})})]})})]},a.id))})]}),e.jsx(be,{className:"my-4"}),e.jsx("div",{className:"flex justify-end",children:e.jsx(ke,{page:v,limit:y,totalPages:(z=(V=t==null?void 0:t.data)==null?void 0:V.pagination)==null?void 0:z.totalPages,setPage:C,setLimit:oe})})]})})]})]})})}function pa(){return e.jsx(we,{title:"All Cases",subTitle:"Manage all the Case here",children:e.jsx("div",{children:e.jsx(He,{viewUrl:"/case-view-details"})})})}export{pa as default};
