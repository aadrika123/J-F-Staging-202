import{u as p,j as s,a as y,_ as d}from"./index-BrFK6v_x.js";import{a as b}from"./index-Woh3rRl7.js";import{u as f,o as P,F as j,B as N,c as v,a as l,g as w}from"./switch-BeBAVJ8b.js";import"./select-CSRCaCCS.js";import{g as k}from"./services-KQnp_8oA.js";import{R as n,e as x}from"./useCrypto-qfoEhL8b.js";import{u as C}from"./useCustomQuery-xlRvHaFh.js";const A=v({oldPassword:l().min(8,"Password must be at least 8 characters").required("Old password is required"),newPassword:l().min(8,"Password must be at least 8 characters").required("New password is required").matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]/,"Password must contain at least one uppercase letter, one lowercase letter, one number and one special character").notOneOf([w("oldPassword")],"New password must be different from old password"),confirmPassword:l().required("Confirm password is required").oneOf([w("newPassword")],"Passwords must match")});function $(){const{logout:h}=p(),u=C({}),e=f({defaultValues:{oldPassword:"",newPassword:"",confirmPassword:""},resolver:P(A)}),t=r=>(r.preventDefault(),!1),o=r=>{(r.ctrlKey||r.metaKey)&&["c","v","x"].includes(r.key.toLowerCase())&&r.preventDefault()},g=async r=>{var c,m,i;console.log("data",r);try{const a=await u.mutateAsync({api:y.changePassword,data:{password:x(r.oldPassword),newPassword:x(r.newPassword)}});console.log("response",a),(c=a==null?void 0:a.data)!=null&&c.status?(d.success((m=a==null?void 0:a.data)==null?void 0:m.message),h(),e.reset()):d.error(((i=a==null?void 0:a.data)==null?void 0:i.message)||"Failed to change password")}catch(a){d.error(k(a.message))}finally{e.reset({oldPassword:"",newPassword:"",confirmPassword:""})}};return s.jsx("main",{className:"flex min-h-screen items-center justify-center bg-gray-100 px-4  sm:px-6 lg:px-8",children:s.jsx("div",{className:"w-full max-w-md",children:s.jsxs("div",{className:"dark:bg-gray-800 rounded-lg bg-white p-6 shadow-xl sm:p-8 md:p-10",children:[s.jsxs("div",{className:"mb-6 space-y-3 text-center sm:mb-8",children:[s.jsx("h1",{className:"dark:text-gray-300 text-2xl font-bold leading-tight text-gray-800 sm:text-3xl",children:"Change Your Password"}),s.jsx("div",{className:"flex items-center justify-center",children:s.jsx("div",{className:"w-16 border-b-2 border-gray-800 dark:border-gray-300"})})]}),s.jsxs("div",{className:"mb-6 rounded-lg border border-blue-200 bg-blue-50 p-3 dark:border-blue-800 dark:bg-blue-900/20 sm:p-4",children:[s.jsx("p",{className:"mb-2 text-sm font-semibold text-blue-800 dark:text-blue-300",children:"Password Requirements:"}),s.jsxs("ul",{className:"list-inside list-disc space-y-1 text-xs text-blue-700 dark:text-blue-400 sm:text-sm",children:[s.jsx("li",{children:"Minimum 8 characters"}),s.jsx("li",{children:"At least one uppercase letter"}),s.jsx("li",{children:"At least one lowercase letter"}),s.jsx("li",{children:"At least one number"}),s.jsx("li",{children:"At least one special character (@$!%*?&)"})]})]}),s.jsx(j,{methods:e,onSubmit:e.handleSubmit(g),children:s.jsxs("div",{className:"space-y-4 sm:space-y-5",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Old Password"}),s.jsx(n,{className:"w-full bg-gray-50 px-4 py-3 text-sm dark:bg-gray-700 sm:px-5 sm:py-4 sm:text-base",name:"oldPassword",placeholder:"Enter your current password",autoComplete:"off",onPaste:t,onCopy:t,onCut:t,onKeyDown:o})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"New Password"}),s.jsx(n,{className:"w-full bg-gray-50 px-4 py-3 text-sm dark:bg-gray-700 sm:px-5 sm:py-4 sm:text-base",name:"newPassword",placeholder:"Enter your new password",autoComplete:"off",onPaste:t,onCopy:t,onCut:t,onKeyDown:o})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Confirm New Password"}),s.jsx(n,{className:"w-full bg-gray-50 px-4 py-3 text-sm dark:bg-gray-700 sm:px-5 sm:py-4 sm:text-base",name:"confirmPassword",placeholder:"Re-enter your new password",autoComplete:"off",onPaste:t,onCopy:t,onCut:t,onKeyDown:o})]}),e.watch("newPassword")&&s.jsxs("div",{className:"space-y-2",children:[s.jsx("p",{className:"text-xs font-medium text-gray-700 dark:text-gray-300 sm:text-sm",children:"Password Strength:"}),s.jsxs("div",{className:"flex gap-1.5 sm:gap-2",children:[s.jsx("div",{className:`h-1.5 flex-1 rounded-full transition-colors duration-300 sm:h-2 ${e.watch("newPassword").length>=8?"bg-yellow-500":"bg-gray-200 dark:bg-gray-600"}`}),s.jsx("div",{className:`h-1.5 flex-1 rounded-full transition-colors duration-300 sm:h-2 ${e.watch("newPassword").length>=8&&/[A-Z]/.test(e.watch("newPassword"))?"bg-orange-500":"bg-gray-200 dark:bg-gray-600"}`}),s.jsx("div",{className:`h-1.5 flex-1 rounded-full transition-colors duration-300 sm:h-2 ${e.watch("newPassword").length>=10&&/[A-Z]/.test(e.watch("newPassword"))&&/[0-9]/.test(e.watch("newPassword"))&&/[@$!%*?&]/.test(e.watch("newPassword"))?"bg-green-500":"bg-gray-200 dark:bg-gray-600"}`})]}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:e.watch("newPassword").length>=10&&/[A-Z]/.test(e.watch("newPassword"))&&/[0-9]/.test(e.watch("newPassword"))&&/[@$!%*?&]/.test(e.watch("newPassword"))?"Strong password":e.watch("newPassword").length>=8&&/[A-Z]/.test(e.watch("newPassword"))?"Medium strength":"Weak password"})]}),s.jsx("div",{className:"pt-2",children:s.jsxs(N,{type:"submit",isLoading:e.formState.isSubmitting,className:"w-full px-4 py-3 text-sm shadow-lg transition-all hover:shadow-xl sm:py-4 sm:text-base",children:[s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",className:"mr-2 inline-block h-4 w-4 sm:h-5 sm:w-5",viewBox:"0 0 16 16",children:[s.jsx("path",{d:"M5.338 1.59a61.44 61.44 0 0 0-2.837.856.481.481 0 0 0-.328.39c-.554 4.157.726 7.19 2.253 9.188a10.725 10.725 0 0 0 2.287 2.233c.346.244.652.42.893.533.12.057.218.095.293.118a.55.55 0 0 0 .101.025.615.615 0 0 0 .1-.025c.076-.023.174-.061.294-.118.24-.113.547-.29.893-.533a10.726 10.726 0 0 0 2.287-2.233c1.527-1.997 2.807-5.031 2.253-9.188a.48.48 0 0 0-.328-.39c-.651-.213-1.75-.56-2.837-.855C9.552 1.29 8.531 1.067 8 1.067c-.53 0-1.552.223-2.662.524zM5.072.56C6.157.265 7.31 0 8 0s1.843.265 2.928.56c1.11.3 2.229.655 2.887.87a1.54 1.54 0 0 1 1.044 1.262c.596 4.477-.787 7.795-2.465 9.99a11.775 11.775 0 0 1-2.517 2.453 7.159 7.159 0 0 1-1.048.625c-.28.132-.581.24-.829.24s-.548-.108-.829-.24a7.158 7.158 0 0 1-1.048-.625 11.777 11.777 0 0 1-2.517-2.453C1.928 10.487.545 7.169 1.141 2.692A1.54 1.54 0 0 1 2.185 1.43 62.456 62.456 0 0 1 5.072.56z"}),s.jsx("path",{d:"M9.5 6.5a1.5 1.5 0 0 1-1 1.415l.385 1.99a.5.5 0 0 1-.491.595h-.788a.5.5 0 0 1-.49-.595l.384-1.99a1.5 1.5 0 1 1 2-1.415z"})]}),"Change Password"]})})]})})]})})})}function D(){return s.jsx(b,{children:s.jsx("div",{children:s.jsx($,{})})})}export{D as default};
