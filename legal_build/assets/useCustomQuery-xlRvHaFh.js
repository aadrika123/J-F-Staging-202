var pt=i=>{throw TypeError(i)};var Z=(i,t,e)=>t.has(i)||pt("Cannot "+e);var s=(i,t,e)=>(Z(i,t,"read from private field"),e?e.call(i):t.get(i)),p=(i,t,e)=>t.has(i)?pt("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(i):t.set(i,e),l=(i,t,e,r)=>(Z(i,t,"write to private field"),r?r.call(i,e):t.set(i,e),e),d=(i,t,e)=>(Z(i,t,"access private method"),e);import{aw as St,ax as w,ay as q,az as H,aA as Ut,aB as bt,aC as yt,aD as Dt,aE as Pt,aF as Tt,aG as vt,aH as G,aI as mt,aJ as Lt,r as R,aK as Et,aL as N}from"./index-BrFK6v_x.js";var v,n,W,y,D,L,E,j,A,K,P,T,x,B,u,k,tt,et,st,it,rt,nt,at,wt,Ot,At=(Ot=class extends St{constructor(t,e){super();p(this,u);p(this,v);p(this,n);p(this,W);p(this,y);p(this,D);p(this,L);p(this,E);p(this,j);p(this,A);p(this,K);p(this,P);p(this,T);p(this,x);p(this,B,new Set);this.options=e,l(this,v,t),l(this,E,null),this.bindMethods(),this.setOptions(e)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(s(this,n).addObserver(this),Rt(s(this,n),this.options)?d(this,u,k).call(this):this.updateResult(),d(this,u,it).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return ot(s(this,n),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return ot(s(this,n),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,d(this,u,rt).call(this),d(this,u,nt).call(this),s(this,n).removeObserver(this)}setOptions(t,e){const r=this.options,o=s(this,n);if(this.options=s(this,v).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof w(this.options.enabled,s(this,n))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");d(this,u,at).call(this),s(this,n).setOptions(this.options),r._defaulted&&!q(this.options,r)&&s(this,v).getQueryCache().notify({type:"observerOptionsUpdated",query:s(this,n),observer:this});const c=this.hasListeners();c&&gt(s(this,n),o,this.options,r)&&d(this,u,k).call(this),this.updateResult(e),c&&(s(this,n)!==o||w(this.options.enabled,s(this,n))!==w(r.enabled,s(this,n))||H(this.options.staleTime,s(this,n))!==H(r.staleTime,s(this,n)))&&d(this,u,tt).call(this);const a=d(this,u,et).call(this);c&&(s(this,n)!==o||w(this.options.enabled,s(this,n))!==w(r.enabled,s(this,n))||a!==s(this,x))&&d(this,u,st).call(this,a)}getOptimisticResult(t){const e=s(this,v).getQueryCache().build(s(this,v),t),r=this.createResult(e,t);return Bt(this,r)&&(l(this,y,r),l(this,L,this.options),l(this,D,s(this,n).state)),r}getCurrentResult(){return s(this,y)}trackResult(t,e){const r={};return Object.keys(t).forEach(o=>{Object.defineProperty(r,o,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(o),e==null||e(o),t[o])})}),r}trackProp(t){s(this,B).add(t)}getCurrentQuery(){return s(this,n)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=s(this,v).defaultQueryOptions(t),r=s(this,v).getQueryCache().build(s(this,v),e);return r.isFetchingOptimistic=!0,r.fetch().then(()=>this.createResult(r,e))}fetch(t){return d(this,u,k).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),s(this,y)))}createResult(t,e){var ft;const r=s(this,n),o=this.options,c=s(this,y),a=s(this,D),f=s(this,L),C=t!==r?t.state:s(this,W),{state:b}=t;let h={...b},_=!1,O;if(e._optimisticResults){const S=this.hasListeners(),Y=!S&&Rt(t,e),Mt=S&&gt(t,r,e,o);(Y||Mt)&&(h={...h,...Tt(b.data,t.options)}),e._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:z,errorUpdatedAt:ct,status:U}=h;if(e.select&&h.data!==void 0)if(c&&h.data===(a==null?void 0:a.data)&&e.select===s(this,j))O=s(this,A);else try{l(this,j,e.select),O=e.select(h.data),O=vt(c==null?void 0:c.data,O,e),l(this,A,O),l(this,E,null)}catch(S){l(this,E,S)}else O=h.data;if(e.placeholderData!==void 0&&O===void 0&&U==="pending"){let S;if(c!=null&&c.isPlaceholderData&&e.placeholderData===(f==null?void 0:f.placeholderData))S=c.data;else if(S=typeof e.placeholderData=="function"?e.placeholderData((ft=s(this,K))==null?void 0:ft.state.data,s(this,K)):e.placeholderData,e.select&&S!==void 0)try{S=e.select(S),l(this,E,null)}catch(Y){l(this,E,Y)}S!==void 0&&(U="success",O=vt(c==null?void 0:c.data,S,e),_=!0)}s(this,E)&&(z=s(this,E),O=s(this,A),ct=Date.now(),U="error");const J=h.fetchStatus==="fetching",$=U==="pending",X=U==="error",lt=$&&J,dt=O!==void 0;return{status:U,fetchStatus:h.fetchStatus,isPending:$,isSuccess:U==="success",isError:X,isInitialLoading:lt,isLoading:lt,data:O,dataUpdatedAt:h.dataUpdatedAt,error:z,errorUpdatedAt:ct,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>C.dataUpdateCount||h.errorUpdateCount>C.errorUpdateCount,isFetching:J,isRefetching:J&&!$,isLoadingError:X&&!dt,isPaused:h.fetchStatus==="paused",isPlaceholderData:_,isRefetchError:X&&dt,isStale:ut(t,e),refetch:this.refetch}}updateResult(t){const e=s(this,y),r=this.createResult(s(this,n),this.options);if(l(this,D,s(this,n).state),l(this,L,this.options),s(this,D).data!==void 0&&l(this,K,s(this,n)),q(r,e))return;l(this,y,r);const o={},c=()=>{if(!e)return!0;const{notifyOnChangeProps:a}=this.options,f=typeof a=="function"?a():a;if(f==="all"||!f&&!s(this,B).size)return!0;const g=new Set(f??s(this,B));return this.options.throwOnError&&g.add("error"),Object.keys(s(this,y)).some(C=>{const b=C;return s(this,y)[b]!==e[b]&&g.has(b)})};(t==null?void 0:t.listeners)!==!1&&c()&&(o.listeners=!0),d(this,u,wt).call(this,{...o,...t})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&d(this,u,it).call(this)}},v=new WeakMap,n=new WeakMap,W=new WeakMap,y=new WeakMap,D=new WeakMap,L=new WeakMap,E=new WeakMap,j=new WeakMap,A=new WeakMap,K=new WeakMap,P=new WeakMap,T=new WeakMap,x=new WeakMap,B=new WeakMap,u=new WeakSet,k=function(t){d(this,u,at).call(this);let e=s(this,n).fetch(this.options,t);return t!=null&&t.throwOnError||(e=e.catch(Ut)),e},tt=function(){d(this,u,rt).call(this);const t=H(this.options.staleTime,s(this,n));if(bt||s(this,y).isStale||!yt(t))return;const r=Dt(s(this,y).dataUpdatedAt,t)+1;l(this,P,setTimeout(()=>{s(this,y).isStale||this.updateResult()},r))},et=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(s(this,n)):this.options.refetchInterval)??!1},st=function(t){d(this,u,nt).call(this),l(this,x,t),!(bt||w(this.options.enabled,s(this,n))===!1||!yt(s(this,x))||s(this,x)===0)&&l(this,T,setInterval(()=>{(this.options.refetchIntervalInBackground||Pt.isFocused())&&d(this,u,k).call(this)},s(this,x)))},it=function(){d(this,u,tt).call(this),d(this,u,st).call(this,d(this,u,et).call(this))},rt=function(){s(this,P)&&(clearTimeout(s(this,P)),l(this,P,void 0))},nt=function(){s(this,T)&&(clearInterval(s(this,T)),l(this,T,void 0))},at=function(){const t=s(this,v).getQueryCache().build(s(this,v),this.options);if(t===s(this,n))return;const e=s(this,n);l(this,n,t),l(this,W,t.state),this.hasListeners()&&(e==null||e.removeObserver(this),t.addObserver(this))},wt=function(t){G.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(s(this,y))}),s(this,v).getQueryCache().notify({query:s(this,n),type:"observerResultsUpdated"})})},Ot);function Kt(i,t){return w(t.enabled,i)!==!1&&i.state.data===void 0&&!(i.state.status==="error"&&t.retryOnMount===!1)}function Rt(i,t){return Kt(i,t)||i.state.data!==void 0&&ot(i,t,t.refetchOnMount)}function ot(i,t,e){if(w(t.enabled,i)!==!1){const r=typeof e=="function"?e(i):e;return r==="always"||r!==!1&&ut(i,t)}return!1}function gt(i,t,e,r){return(i!==t||w(r.enabled,i)===!1)&&(!e.suspense||i.state.status!=="error")&&ut(i,e)}function ut(i,t){return w(t.enabled,i)!==!1&&i.isStaleByTime(H(t.staleTime,i))}function Bt(i,t){return!q(i.getCurrentResult(),t)}var I,M,m,F,Q,V,ht,Ct,_t=(Ct=class extends St{constructor(t,e){super();p(this,Q);p(this,I);p(this,M);p(this,m);p(this,F);l(this,I,t),this.setOptions(e),this.bindMethods(),d(this,Q,V).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var r;const e=this.options;this.options=s(this,I).defaultMutationOptions(t),q(this.options,e)||s(this,I).getMutationCache().notify({type:"observerOptionsUpdated",mutation:s(this,m),observer:this}),e!=null&&e.mutationKey&&this.options.mutationKey&&mt(e.mutationKey)!==mt(this.options.mutationKey)?this.reset():((r=s(this,m))==null?void 0:r.state.status)==="pending"&&s(this,m).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=s(this,m))==null||t.removeObserver(this)}onMutationUpdate(t){d(this,Q,V).call(this),d(this,Q,ht).call(this,t)}getCurrentResult(){return s(this,M)}reset(){var t;(t=s(this,m))==null||t.removeObserver(this),l(this,m,void 0),d(this,Q,V).call(this),d(this,Q,ht).call(this)}mutate(t,e){var r;return l(this,F,e),(r=s(this,m))==null||r.removeObserver(this),l(this,m,s(this,I).getMutationCache().build(s(this,I),this.options)),s(this,m).addObserver(this),s(this,m).execute(t)}},I=new WeakMap,M=new WeakMap,m=new WeakMap,F=new WeakMap,Q=new WeakSet,V=function(){var e;const t=((e=s(this,m))==null?void 0:e.state)??Lt();l(this,M,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},ht=function(t){G.batch(()=>{var e,r,o,c,a,f,g,C;if(s(this,F)&&this.hasListeners()){const b=s(this,M).variables,h=s(this,M).context;(t==null?void 0:t.type)==="success"?((r=(e=s(this,F)).onSuccess)==null||r.call(e,t.data,b,h),(c=(o=s(this,F)).onSettled)==null||c.call(o,t.data,null,b,h)):(t==null?void 0:t.type)==="error"&&((f=(a=s(this,F)).onError)==null||f.call(a,t.error,b,h),(C=(g=s(this,F)).onSettled)==null||C.call(g,void 0,t.error,b,h))}this.listeners.forEach(b=>{b(s(this,M))})})},Ct),Ft=R.createContext(!1),kt=()=>R.useContext(Ft);Ft.Provider;function Wt(){let i=!1;return{clearReset:()=>{i=!1},reset:()=>{i=!0},isReset:()=>i}}var jt=R.createContext(Wt()),zt=()=>R.useContext(jt);function Qt(i,t){return typeof i=="function"?i(...t):!!i}function Ht(){}var Vt=(i,t)=>{(i.suspense||i.throwOnError)&&(t.isReset()||(i.retryOnMount=!1))},qt=i=>{R.useEffect(()=>{i.clearReset()},[i])},Gt=({result:i,errorResetBoundary:t,throwOnError:e,query:r})=>i.isError&&!t.isReset()&&!i.isFetching&&r&&Qt(e,[i.error,r]),Nt=i=>{i.suspense&&typeof i.staleTime!="number"&&(i.staleTime=1e3)},Jt=(i,t)=>(i==null?void 0:i.suspense)&&t.isPending,$t=(i,t,e)=>t.fetchOptimistic(i).catch(()=>{e.clearReset()});function Xt(i,t,e){var C,b,h,_;const r=Et(),o=kt(),c=zt(),a=r.defaultQueryOptions(i);(b=(C=r.getDefaultOptions().queries)==null?void 0:C._experimental_beforeQuery)==null||b.call(C,a),a._optimisticResults=o?"isRestoring":"optimistic",Nt(a),Vt(a,c),qt(c);const[f]=R.useState(()=>new t(r,a)),g=f.getOptimisticResult(a);if(R.useSyncExternalStore(R.useCallback(O=>{const z=o?()=>{}:f.subscribe(G.batchCalls(O));return f.updateResult(),z},[f,o]),()=>f.getCurrentResult(),()=>f.getCurrentResult()),R.useEffect(()=>{f.setOptions(a,{listeners:!1})},[a,f]),Jt(a,g))throw $t(a,f,c);if(Gt({result:g,errorResetBoundary:c,throwOnError:a.throwOnError,query:r.getQueryCache().get(a.queryHash)}))throw g.error;return(_=(h=r.getDefaultOptions().queries)==null?void 0:h._experimental_afterQuery)==null||_.call(h,a,g),a.notifyOnChangeProps?g:f.trackResult(g)}function xt(i,t){return Xt(i,At)}function It(i,t){const e=Et(),[r]=R.useState(()=>new _t(e,i));R.useEffect(()=>{r.setOptions(i)},[r,i]);const o=R.useSyncExternalStore(R.useCallback(a=>r.subscribe(G.batchCalls(a)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),c=R.useCallback((a,f)=>{r.mutate(a,f).catch(Ht)},[r]);if(o.error&&Qt(r.options.throwOnError,[o.error]))throw o.error;return{...o,mutate:c,mutateAsync:o.mutate}}const Yt=async(i,t)=>(await N.get(i,{...t})).data;function ie({key:i,api:t,options:e,value:r,config:o}){return xt({queryKey:[i??t,...r??[]],queryFn:async()=>Yt(t,o),refetchOnReconnect:"always",refetchOnWindowFocus:!1,...e})}function re({key:i,api:t,options:e,value:r,config:o}){return xt({queryKey:[i??t,...r??[]],queryFn:async()=>(await N.post(t,{...o})).data,refetchOnReconnect:"always",refetchOnWindowFocus:!1,...e})}const Zt=(i,t)=>N.post(i,t),ne=({options:i})=>It({mutationFn:({api:t,data:e})=>Zt(t,e),...i}),ae=({options:i})=>It({mutationFn:({api:t,data:e})=>N.post(t,e,{headers:{"Content-Type":"multipart/form-data"}}),...i});export{re as a,ie as b,ae as c,ne as u};
