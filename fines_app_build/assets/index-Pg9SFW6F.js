import{j as e,_ as c,c as g,b as N,P as f}from"./index-IsWPsZnr.js";import{h as v,e as C}from"./router-FGqGJA6w.js";import{S as P,a as _,u as S,F as k}from"./TextArea-zT3GImMl.js";import{c as A,a as p}from"./index.esm-EAT-qbPU.js";import{u as M,b as w}from"./useCustomQuery-D8BRNTo5.js";import{r as l}from"./tailwind-tCHD1pCF.js";import{C as F,O as I}from"./CreateConfirmation-BJ1YX2Ko.js";import"./reactQuery-FJqsWYpp.js";import"./reactQueryDevtools-6dm9iask.js";import"./axios-HRLWQzqE.js";import"./reactIcons-e-z9r7Pm.js";import"./reactLazyLoadImageComponent-iRaVQCNa.js";import"./headlessui-KSSrLZ1r.js";function R({challanDetail:s,formik:d}){var a,t,m,x,n,i;return e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"",children:e.jsx("h1",{className:"text-base font-semibold text-blue-gray-500",children:"Payment Challan"})}),e.jsx(l.Card,{className:"mt-2",children:e.jsx(l.CardBody,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-sm font-semibold text-blue-gray-500 mt-2",children:"Challan No"}),e.jsx("h1",{className:"text-sm font-semibold text-blue-gray-500 mt-2",children:"Name"}),e.jsx("h1",{className:"text-sm font-semibold text-blue-gray-500 mt-2",children:"Date:"}),e.jsx("h1",{className:"text-sm font-semibold text-blue-gray-500 mt-2",children:"Amount:"}),e.jsx("h1",{className:"text-sm font-semibold text-blue-gray-500 mt-2",children:"Type:"}),e.jsx("h1",{className:"text-sm font-semibold text-blue-gray-500 mt-2",children:"Status:"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm  text-blue-gray-500 mt-2",children:(a=s==null?void 0:s.data)==null?void 0:a.challan_no}),e.jsx("p",{className:"text-sm  text-blue-gray-500 mt-2",children:(t=s==null?void 0:s.data)==null?void 0:t.full_name}),e.jsx("p",{className:"text-sm  text-blue-gray-500 mt-2",children:(m=s==null?void 0:s.data)==null?void 0:m.challan_date}),e.jsx("p",{className:"text-sm  text-blue-gray-500 mt-2",children:(x=s==null?void 0:s.data)==null?void 0:x.amount}),e.jsx("p",{className:"text-sm  text-blue-gray-500 mt-2",children:(n=s==null?void 0:s.data)==null?void 0:n.challan_type}),e.jsx("p",{className:"text-sm  text-blue-gray-500 mt-2",children:(i=s==null?void 0:s.data)!=null&&i.payment_status?e.jsx("span",{className:"text-sm font-bold bg-green-100 text-green-500 rounded-lg px-2 py-1",children:"Paid"}):e.jsx("span",{className:"text-xs bg-red-100 text-red-500 rounded-lg px-2 py-1",children:"Unpaid"})})]})]})})}),e.jsx("div",{className:"border-t border-gray-200 my-4"}),e.jsxs("div",{className:"py-2",children:[e.jsx("h1",{className:"text-base font-semibold text-blue-gray-500",children:"Payment Now"}),e.jsx(l.Card,{className:"mt-2",children:e.jsx(l.CardBody,{children:e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx("div",{children:e.jsxs(P,{label:"Payment Method",name:"paymentMode",formik:d,children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"CASH",children:"Cash"}),e.jsx("option",{value:"ONLINE",children:"Online"})]})}),e.jsx("div",{children:e.jsx(_,{label:"Remark",name:"remark",formik:d,placeholder:"Enter Remark"})}),e.jsx("div",{children:e.jsx("button",{type:"submit",className:"bg-blue-500 text-white px-4 py-2 rounded-lg text-xs",children:"Pay Now"})})]})})})]})]})}function K(){var n,i;const s=v(),d=M({}),{id:a}=C(),t=w({api:g.api_get_challan_by_id,config:{challanId:a},options:{enabled:!!a}}),m=S({enableReinitialize:!0,initialValues:{applicationId:(i=(n=t==null?void 0:t.data)==null?void 0:n.data)==null?void 0:i.application_id,challanId:a,paymentMode:"",remark:""},validationSchema:A().shape({challanId:p().required("Challan Id is required"),paymentMode:p().required("Payment Mode is required"),remark:p().required("Remark is required").min(3).max(100).label("Remark")}),onSubmit:async o=>{await F("Are you sure you want to pay challan ".concat(o.challanId,"?"))?o.paymentMode==="CASH"&&await x(o):c.error("Payment Cancelled")}}),x=async o=>{var u,y,j,h,b;try{const r=await d.mutateAsync({api:g.api_postCashPayment,data:o});(u=r.data)!=null&&u.status?(c.success((y=r.data)==null?void 0:y.message),s("/fines-app/payment-receipt/".concat((h=(j=r.data)==null?void 0:j.data)==null?void 0:h.tran_no),{replace:!0})):c.error((b=r.data)==null?void 0:b.message)}catch(r){c.error(r.message)}};return t.isLoading?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx(N,{})}):e.jsx(e.Fragment,{children:e.jsxs(f,{title:"Payment Challan",meta:e.jsx(e.Fragment,{children:e.jsx("meta",{name:"description",content:"Generate Challan"})}),children:[d.isLoading&&e.jsx(I,{}),t.isSuccess&&e.jsx(k,{formik:m,children:e.jsx(R,{challanDetail:t.data,formik:m})})]})})}export{K as default};
