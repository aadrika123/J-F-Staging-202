import{j as e}from"./mui-d8134288.js";import{b as l,u as a,r as t,f as o}from"./router-a70afc62.js";import{M as d,a1 as n,U as s,z as i,W as r,A as c,c as m,d as u,u as p,f as x,aM as h,h as b}from"./index-1c8a2e08.js";import{h as v}from"./moment-494dae31.js";import{i as g}from"./success-39308b33.js";import"./axios-0f103e9d.js";import"./reactIcons-65f093d4.js";import"./materialTailwind-01b55b4e.js";/* empty css                */import"./redux-c3344370.js";import"./i18next-524eea2d.js";const f={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",background:"transparent",border:"none"}};function y(o){const[s,i]=l.useState(!1),r=null==o?void 0:o.transData,c=a();function m(){i(!1),c("/water-dashboard")}return t.useEffect(()=>{i(!0)},[]),e.jsx("div",{className:"",children:e.jsx(d,{isOpen:s,onAfterOpen:function(){},onRequestClose:m,style:f,contentLabel:"Example Modal",children:e.jsx("div",{children:e.jsxs("div",{className:"bg-green-200 shadow-2xl border border-sky-200 p-5 m-5 rounded-md",children:[e.jsxs("div",{onClick:m,className:"absolute cursor-pointer bg-green-100 hover:bg-gray-300 p-1 rounded-md",children:[e.jsx(n,{})," "]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:g,className:"h-20",alt:"",srcset:""})}),e.jsx("div",{className:"py-1 pl-3 font-semibold text-center text-2xl text-gray-800",children:" Payment Completed Successfully "}),e.jsxs("p",{className:"text-center",children:[e.jsx("span",{className:"text-base",children:" Payment Transaction No"})," ",e.jsx("span",{className:"font-bold text-blue-700 text-xl",children:null==r?void 0:r.transectionNo})]}),e.jsx("p",{className:"border-b border-gray-300 mx-10 py-1"}),e.jsxs("div",{className:"grid grid-cols-12 px-8 py-3 leading-8 space-x-8 text-sm",children:[e.jsx("div",{className:"md:col-span-6 col-span-12",children:e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsxs("div",{className:"col-span-6 font-semibold",children:[e.jsx("p",{children:"Application No"}),e.jsx("p",{children:"Transaction Type"})]}),e.jsxs("div",{className:"col-span-6 ml-3",children:[e.jsx("p",{children:(null==r?void 0:r.applicationNo)||"NA"}),e.jsx("p",{children:(null==r?void 0:r.tranType)||"NA"})]})]})}),e.jsx("div",{className:"md:col-span-6 col-span-12",children:e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsxs("div",{className:"col-span-6 font-semibold",children:[e.jsx("p",{children:"Amount"}),e.jsx("p",{children:"Payment Date"})]}),e.jsxs("div",{className:"col-span-6",children:[e.jsx("p",{children:null==r?void 0:r.amount}),e.jsx("p",{children:null==r?void 0:r.transectionDate})]})]})}),e.jsx("div",{className:"col-span-12 md:mt-4 mt-10",children:e.jsxs("div",{className:"flex justify-center",children:[e.jsx("button",{onClick:m,className:"mx-2 bg-sky-600 hover:bg-sky-700 transition duration-200 hover:scale-105 font-normal text-white px-6 py-1 text-sm rounded-sm shadow-xl",children:"Close"}),r&&e.jsx("button",{onClick:()=>c(`/waterUserReceipt/${null==r?void 0:r.transectionNo}`),className:"mx-2 bg-indigo-600 hover:bg-indigo-700 transition duration-200 hover:scale-105 font-normal text-white px-4 py-2 text-sm  rounded-sm shadow-xl",children:"View Receipt"})]})})]})]})})})})}const N=l=>{var d,n,g;const[f,N]=t.useState(),[w,M]=t.useState(!1),[D,k]=t.useState(),{handlePayment:A}=s(),[Y,_]=t.useState(),[j,U]=t.useState(),[C,F]=t.useState(),[S,R]=t.useState(!1),[I,P]=t.useState(),[T,z]=t.useState(!1),{id:O}=o(),q=a(),{notify:B}=t.useContext(i),{api_generatedreceipt:L,api_waterApprovedApplicationDetails:V,api_waterListDemand:W,api_waterDemandCalculation:$,api_waterDemandPayment:E,header:H}=r();t.useEffect(()=>{J(),K()},[O]),t.useEffect(()=>{G()},[C,j]);const G=()=>""==C||""==j?_():(M(!0),void c.post($,{consumerId:O,demandFrom:j,demandUpto:C},H).then(function(e){_(e.data.data),M(!1)}).catch(function(e){M(!1)})),J=()=>{M(!0),c.post(V,{id:O},H).then(function(e){N(e.data.data),M(!1)}).catch(function(e){M(!1)})},K=()=>{c.post(W,{ConsumerId:O},H).then(e=>{k(e.data.data)}).catch(e=>{})},Q=async e=>{let l={applicationId:null==e?void 0:e.applicationId,departmentId:null==e?void 0:e.departmentId,status:"",captured:"1",card_id:"",amount:null==e?void 0:e.amount,payment_method:"upi/netbanking",workflow_id:null==e?void 0:e.workflowId,user_id:null==e?void 0:e.userId,ulb_id:null==e?void 0:e.ulbId,user_id:localStorage.getItem("citizenId"),payment_order_id:null==e?void 0:e.razorpay_order_id,payment_id:null==e?void 0:e.razorpay_payment_id,created_at:""};c.post(L,l,H).then(e=>{var l;1==e.data.status?q(`/waterUserReceipt/${null==(l=null==e?void 0:e.data)?void 0:l.data}`):toast.error(e.data.message,"error")}).catch(e=>{toast.error(e.message,"error")})},X=m({monthFrom:u().required("Require Field"),monthUpto:u().required("Require Field")}),Z=p({enableReinitialize:!0,initialValues:{monthFrom:"",monthUpto:"",penalty:"",rebate:"",advanced:""},onSubmit:(e,l)=>{M(!0),c.post(E,{consumerId:O,demandFrom:j,demandUpto:C,amount:null==Y?void 0:Y.totalPayAmount,paymentMode:"online",remarks:"citizen payment"},H).then(e=>{var l,a,t,o,d,n,s,i,r,c,m,u,p,x;z(!1),1==e.data.status?(window.ReactNativeWebView?b({generatedOrder:null==(l=null==e?void 0:e.data)?void 0:l.data,payload:{applicationId:null==(t=null==(a=null==e?void 0:e.data)?void 0:a.data)?void 0:t.applicationId,departmentId:null==(d=null==(o=null==e?void 0:e.data)?void 0:o.data)?void 0:d.departmentId,status:"",captured:"1",card_id:"",amount:null==(s=null==(n=null==e?void 0:e.data)?void 0:n.data)?void 0:s.amount,payment_method:"upi/netbanking",workflow_id:null==(r=null==(i=null==e?void 0:e.data)?void 0:i.data)?void 0:r.workflowId,user_id:null==(m=null==(c=null==e?void 0:e.data)?void 0:c.data)?void 0:m.userId,ulb_id:null==(p=null==(u=null==e?void 0:e.data)?void 0:u.data)?void 0:p.ulbId,user_id:localStorage.getItem("citizenId"),created_at:""},api:L,returnUrl:"/citizen/waterUserReceipt"}):A(null==(x=null==e?void 0:e.data)?void 0:x.data,Q),q("/water-dashboard",{replace:!0})):B(e.data.message,"error")}).catch(e=>{z(!1),B(e.message,"error")})},validationSchema:X}),ee=null==(d=null==D?void 0:D.consumerDemands)?void 0:d.filter(e=>v(e.demand_upto,"YYYY-MM-DD").format("yy-MM").toString()>=v(j,"YYYY-MM-DD").format("yy-MM"));return e.jsxs(e.Fragment,{children:[w&&e.jsx(x,{}),S&&e.jsx(y,{transData:I}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-12 lg:grid-cols-12 gap-2 container mx-auto w-full",children:e.jsxs("div",{className:"col-span-12 rounded-lg p-4 max-sm:p-0",children:[e.jsx("div",{className:"p-4 max-sm:p-2",children:e.jsxs("div",{className:"",children:[e.jsxs("h1",{className:"px-1 font-semibold font-serif  text-gray-500",children:[e.jsx(h,{className:"inline"})," Basic Details"]}),e.jsx("div",{className:"py-6 mt-2 bg-white rounded-lg shadow-xl p-4",children:e.jsxs("div",{className:"flex space-x-5 pl-4 max-sm:flex-col max-sm:space-x-0 max-sm:space-y-2 ",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-sm",children:(null==f?void 0:f.ulb_name)?null==f?void 0:f.ulb_name:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"ULB Name"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-sm",children:(null==f?void 0:f.ward_name)?null==f?void 0:f.ward_name:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Ward No."})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-sm",children:(null==f?void 0:f.consumer_no)?null==f?void 0:f.consumer_no:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Consumer No"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-sm",children:(null==f?void 0:f.connection_through)?null==f?void 0:f.connection_through:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Connection Through"})]}),e.jsxs("div","SAF"==(null==f?void 0:f.connection_through)?{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-md",children:(null==f?void 0:f.saf_no)?null==f?void 0:f.saf_no:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"SAF No"})]}:{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-md",children:(null==f?void 0:f.holding_no)?null==f?void 0:f.holding_no:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Holding No"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-md",children:(null==f?void 0:f.owner_char_type)?null==f?void 0:f.owner_char_type:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Ownership Type"})]})]})})]})}),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mt-5 p-4",children:[e.jsxs("h1",{className:"px-1 font-semibold font-serif text-gray-500",children:[e.jsx(h,{className:"inline"}),"Due Demand Details"]}),e.jsx("div",{className:"overflow-auto",children:e.jsxs("table",{className:"min-w-full leading-normal mt-2 bg-white rounded-lg shadow-xl p-4",children:[e.jsx("thead",{className:"font-bold text-left text-sm border text-gray-800 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"#"}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Demand From"}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Demand Upto"}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Demand Amount"}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Penalty"}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Connection Type"}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Payable Amount "})]})}),e.jsx("tbody",{className:"text-sm",children:e.jsx(e.Fragment,{children:null==(n=null==D?void 0:D.consumerDemands)?void 0:n.map((l,a)=>e.jsxs("tr",{className:"bg-white shadow-xl border-b border-gray-200",children:[e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:a+1}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:(null==l?void 0:l.demand_from)?v(null==l?void 0:l.demand_from,"YYYY-MM-DD").format("DD-MMM-yy"):"N/A"}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:(null==l?void 0:l.demand_upto)?v(null==l?void 0:l.demand_upto,"YYYY-MM-DD").format("DD-MMM-yy"):"N/A"}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:(null==l?void 0:l.balance_amount)?null==l?void 0:l.balance_amount:"N/A"}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:(null==l?void 0:l.penalty)?null==l?void 0:l.penalty:"N/A"}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:(null==l?void 0:l.connection_type)?null==l?void 0:l.connection_type:"N/A"}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:(null==l?void 0:l.amount)?"₹ "+(null==l?void 0:l.amount):"N/A"})]}))})})]})})]})}),e.jsx("div",{className:"col-span-12 rounded-lg p-4",children:e.jsx("div",{className:"py-6 mt-2 bg-white rounded-lg shadow-xl border border-y-gray-200 p-4",children:e.jsx("form",{onSubmit:Z.handleSubmit,onChange:e=>{let l=e.target.name,a=e.target.value;"monthFrom"==l&&U(a),"monthUpto"==l&&F(a)},className:"p-4 relative",children:e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Select Month From"]}),e.jsxs("select",{...Z.getFieldProps("monthFrom"),type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md",children:[e.jsx("option",{value:"",children:"Select"}),null==(g=null==D?void 0:D.consumerDemands)?void 0:g.map((l,a)=>e.jsx("option",{value:l.demand_from,children:v(l.demand_from,"YYYY-MM-DD").format("MMM-yy")},a))]}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:Z.touched.monthFrom&&Z.errors.monthFrom?Z.errors.monthFrom:null})]}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Select Month Upto"]}),e.jsxs("select",{...Z.getFieldProps("monthUpto"),type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md",children:[e.jsx("option",{value:"",children:"Select"}),null==ee?void 0:ee.map((l,a)=>e.jsx("option",{value:l.demand_upto,children:v(l.demand_upto,"YYYY-MM-DD").format("MMM-yy")},a))]}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:Z.touched.monthUpto&&Z.errors.monthUpto?Z.errors.monthUpto:null})]}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsx("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:"Total Demand"}),e.jsx("input",{...Z.getFieldProps("amount"),value:(null==Y?void 0:Y.totalDemand)||0,disabled:!0,type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md bg-slate-200"}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:Z.touched.amount&&Z.errors.amount?Z.errors.amount:null})]}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsx("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:"Penalty"}),e.jsx("input",{...Z.getFieldProps("penalty"),value:(null==Y?void 0:Y.totalPenalty)||0,disabled:!0,type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md bg-slate-200"}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:Z.touched.penalty&&Z.errors.penalty?Z.errors.penalty:null})]}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsx("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:"Rebate"}),e.jsx("input",{...Z.getFieldProps("rebate"),value:(null==Y?void 0:Y.totalRebate)||0,disabled:!0,type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md bg-slate-200"}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:Z.touched.rebate&&Z.errors.rebate?Z.errors.rebate:null})]}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsx("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:"Advanced"}),e.jsx("input",{...Z.getFieldProps("advanced"),value:(null==Y?void 0:Y.totalAdvance)||0,disabled:!0,type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md bg-slate-200"}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:Z.touched.advanced&&Z.errors.advanced?Z.errors.advanced:null})]}),e.jsx("div",{className:"form-group mb-4 col-span-12 md:col-span-6 md:px-4",children:e.jsxs("p",{children:["Remain Advance : ",e.jsx("span",{className:"text-orange-700 font-semibold",children:(null==Y?void 0:Y.remaningAdvanceAmount)||0})]})}),e.jsx("div",{className:"form-group mb-4 col-span-12 md:col-span-6 md:px-4",children:e.jsxs("p",{children:[" Payable Amount : ",e.jsx("span",{className:"text-green-700 font-semibold",children:(null==Y?void 0:Y.totalPayAmount)?"₹"+(null==Y?void 0:Y.totalPayAmount):0})]})}),e.jsxs("div",{className:"col-span-12 grid grid-cols-2 mt-10",children:[e.jsx("div",{className:""}),e.jsxs("div",{className:"md:pl-10 text-right space-x-5 max-sm:space-x-0 max-sm:pl-0 max-sm:space-y-2",children:[e.jsx("button",{type:"button",onClick:()=>q(-1),className:" px-6 py-2.5 max-sm:px-8 bg-sky-600 text-white font-medium text-xs leading-tight  rounded shadow-md hover:bg-sky-700 hover:shadow-lg focus:bg-sky-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-indigo-800 active:shadow-lg transition duration-150 ease-in-out cursor-pointer",children:"Back"}),e.jsx("button",{type:"submit",className:" px-6 py-2.5 bg-indigo-600 text-white font-medium text-xs leading-tight  rounded shadow-md hover:bg-indigo-600 hover:shadow-lg focus:bg-indigo-700 focus:shadow-lg focus:outline-none focus:ring-0 active:shadow-lg transition duration-150 ease-in-out cursor-pointer",children:"Pay Now"})]})]})]})})})})]})})]})};export{N as default};
