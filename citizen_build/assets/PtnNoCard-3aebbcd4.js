import{j as e}from"./mui-d8134288.js";import{r as l,u as t}from"./router-a70afc62.js";import{M as o,z as n,c as i,d as r,u as a,D as d,L as s,A as c,n as u,b as m,k as h,E as b}from"./index-1c8a2e08.js";import{a as g}from"./axios-0f103e9d.js";import"./reactIcons-65f093d4.js";import"./materialTailwind-01b55b4e.js";import"./moment-494dae31.js";/* empty css                */import"./redux-c3344370.js";import"./i18next-524eea2d.js";function p(o){l.useState(!0);const[p,x]=l.useState(!1),[f,v]=l.useState(!1),[w,y]=l.useState(""),{api_sendMobileOtpAttachment:N,api_filterPropertyDetails:L,api_getAllUlb:j,header:B}=b(),{notify:C}=l.useContext(n);t();const[k,H]=l.useState(!1),[I,P]=l.useState(null),[U,S]=l.useState(""),[_,E]=l.useState(""),[T,A]=l.useState([]),[M,O]=l.useState(""),[D,F]=l.useState([]),[z,V]=l.useState(!1);l.useEffect(()=>{V(!0),c.get(j,{},B).then(e=>{var l,t;(null==(l=null==e?void 0:e.data)?void 0:l.status)?F((null==(t=null==e?void 0:e.data)?void 0:t.data)||[]):C("Failed to fetch ULB list","error")}).catch(e=>{C("Error occurred while fetching ULB list","error")}).finally(()=>V(!1))},[]);const W=i({ptn:r(),holdingNo:r(),ulbId:r().required("Please select ULB")}),q=a({initialValues:{ptn:"",holdingNo:"",ulbId:""},onSubmit:e=>{},validationSchema:W}),G=(e,l,t)=>""!==e&&null!=e&&(l&&l.length>=14||t&&t.length>=14),J=e=>{let l=e.target.name,t=e.target.value;if("ulbId"===l){O(t),q.setFieldValue("ulbId",t),A([]);const e=G(t,q.values.ptn,q.values.holdingNo);v(e)}if("ptn"==l){q.setFieldValue("holdingNo",""),null==o||o.setholdingNo(""),q.setFieldValue("ptn",t);const e=G(q.values.ulbId,t,"");v(e)}else if("holdingNo"==l){q.setFieldValue("ptn",""),null==o||o.setptnNo(""),q.setFieldValue("holdingNo",t);const e=G(q.values.ulbId,"",t);v(e)}w&&y("")},K=(e,l)=>{P(l),H(e)},Q=[{Header:"Ward No.",accessor:"ward_name"},{Header:"Owner's Name",accessor:"owner_name"},{Header:"PT No.",accessor:"pt_no",Cell:({cell:l})=>e.jsx("span",{children:u(l.row.original.pt_no)})},{Header:"Holding No",accessor:"new_holding_no",Cell:({cell:l})=>e.jsx("span",{children:u(l.row.original.new_holding_no)})},{Header:"Mobile No",accessor:"mobile_no",Cell:({cell:l})=>e.jsx("span",{children:u(l.row.original.mobile_no)})},{Header:"Action",accessor:"id",Cell:({cell:l})=>e.jsx("button",{onClick:()=>{var e,t,n,i;return((e,l)=>{""!=q.values.holdingNo||""!=q.values.ptn?q.values.ulbId&&""!==q.values.ulbId?(S(""),x(!0),v(!1),l?null==o||o.setholdingNo(l):null==o||o.setptnNo(e),(e=>{let l;H(!1),x(!0),v(!1),l=0==e.ptn.length?{holdingNo:e.holdingNo,ulbId:e.ulbId}:{ptNo:e.ptn,ulbId:e.ulbId},g.post(N,l,m()).then(e=>{var l,t,n,i;(null==(l=null==e?void 0:e.data)?void 0:l.status)?(null==o||o.setpropertyAttachedMobileNo(null==(n=null==(t=null==e?void 0:e.data)?void 0:t.data)?void 0:n.mobileNo),null==o||o.setptnCardStatus(!1),null==o||o.setotpCardStatus(!0)):K(!0,h(null==(i=null==e?void 0:e.data)?void 0:i.message)),x(!1)}).catch(e=>{C("Something went wrong in attachment...","error"),x(!1),K(!0,"Error occured. Please try again later."),v(!0)})})(q.values)):K(!0,"Please select ULB."):K(!0,"Enter holding or pt no.")})(null==(t=null==(e=null==l?void 0:l.row)?void 0:e.original)?void 0:t.pt_no,null==(i=null==(n=null==l?void 0:l.row)?void 0:n.original)?void 0:i.new_holding_no)},className:"bg-indigo-500 px-3 py-1 rounded-lg shadow-lg hover:shadow-xl hover:bg-indigo-700 text-white",children:"Attach"})}];return e.jsxs(e.Fragment,{children:[k&&e.jsx(d,{activateBottomErrorCard:K,errorTitle:I}),e.jsx("div",{class:"w-full sm:w-full  mx-auto",children:e.jsx("div",{class:"container mx-auto",children:e.jsxs("div",{class:"mx-auto flex flex-wrap gap-4 justify-center items-center",children:[e.jsx("div",{class:"w-max bg-white rounded text-center shadow-xl relative py-10 px-8",children:e.jsxs("div",{class:"",children:[e.jsx("button",{onClick:()=>null==o?void 0:o.closeModal(!1),type:"button",class:"absolute top-6 right-6 bg-transparent bg-gray-200 text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center shadow-sm  hover:bg-red-200 hover:border-none",children:e.jsx("svg",{class:"w-5 h-5",fill:"currentColor",children:e.jsx("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})})}),e.jsx("div",{class:"text-2xl font-bold px-10",children:"Enter Holding or PT no."}),e.jsx("div",{class:"flex flex-col mt-4 text-center",children:e.jsxs("span",{className:"text-center",children:["Select ULB and enter 14 digit PTN no, or Holding no.",e.jsx("br",{}),"to attach a property"]})}),e.jsx("div",{class:"flex flex-col mt-4 text-center",children:e.jsx("span",{className:"text-center text-red-400",children:U})}),e.jsx("div",{class:"flex flex-row justify-center text-center mt-5",children:e.jsxs("form",{onSubmit:q.handleSubmit,onChange:J,children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold w-full text-left",children:["Select ULB",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{name:"ulbId",value:q.values.ulbId,onChange:J,className:"form-control block w-full px-3 2xl:py-1.5 py-1 2xl:text-base text-sm font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md appearance-none",disabled:z,children:[e.jsx("option",{value:"",children:z?"Loading ULBs...":"Select ULB"}),!z&&D.map(l=>e.jsx("option",{value:l.id,children:l.ulb_name||l.name},l.id))]}),z&&e.jsx("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2",children:e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-indigo-600"})})]}),q.touched.ulbId&&q.errors.ulbId&&e.jsx("div",{className:"text-red-500 text-xs mt-1",children:q.errors.ulbId})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold w-full text-left",children:["PTN",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"text",...q.getFieldProps("ptn"),className:"form-control block w-full px-3 2xl:py-1.5 py-1 2xl:text-base text-sm font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md"})]}),e.jsx("div",{className:"font-semibold text-indigo-500 mt-2",children:"Or"}),e.jsxs("div",{children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold w-full text-left",children:["Holding No.",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"text",...q.getFieldProps("holdingNo"),className:"form-control block w-full px-3 2xl:py-1.5 py-1 2xl:text-base text-sm font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md"})]}),e.jsx("div",{className:"text-red-500 mt-4",children:w}),e.jsxs("div",{class:"w-full text-center mt-4",children:[f&&!z&&e.jsx("button",{type:"button",onClick:()=>{var e;if(!q.values.ulbId||""===q.values.ulbId)return void y("Please select ULB.");let l;null==(e=Object.entries(null==q?void 0:q.values))||e.map(([e,t],o)=>{""!=t&&"ulbId"!==e&&(l={filteredBy:e,parameter:t,isLegacy:!1,page:1,perPage:100,ulbId:q.values.ulbId},E(e))}),x(!0),g.post(L,l,m()).then(e=>{var l,t,o,n,i,r,a;(null==(l=null==e?void 0:e.data)?void 0:l.status)?(A(null==(o=null==(t=null==e?void 0:e.data)?void 0:t.data)?void 0:o.data),0==(null==(r=null==(i=null==(n=null==e?void 0:e.data)?void 0:n.data)?void 0:i.data)?void 0:r.length)&&K(!0,"No Data Found !!!")):K(!0,h(null==(a=null==e?void 0:e.data)?void 0:a.message))}).catch(e=>{K(!0,"Error occurred while fetching data.")}).finally(()=>x(!1))},disabled:p,className:"w-full  py-2.5 bg-indigo-600 text-white font-medium text-xs leading-tight  rounded shadow-md hover:bg-indigo-700 hover:shadow-lg focus:bg-indigo-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-indigo-800 active:shadow-lg transition duration-150 ease-in-out",children:p?"Fetching...":"Submit"}),(!f||z)&&e.jsx("button",{type:"button",className:"w-full  py-2.5 bg-gray-400 text-white font-medium text-xs leading-tight  rounded shadow-md  hover:shadow-lg  focus:shadow-lg focus:outline-none focus:ring-0  transition duration-150 ease-in-out cursor-default ",children:"Submit"})]})]})})]})}),(null==T?void 0:T.length)>0&&e.jsx("div",{class:"bg-white py-10 px-8 rounded text-center shadow-xl relative md:w-auto w-[97vw]",children:e.jsx(s,{dataList:T,columns:Q})})]})})})]})}o.setAppElement("#root");export{p as default};
