import{j as e}from"./mui-d8134288.js";import{M as l,c1 as o,c as n,d as t,u as r,b as a,A as d,Q as s,aI as i,E as c}from"./index-1c8a2e08.js";import{f as m,u,r as p}from"./router-a70afc62.js";import{a as h}from"./index.esm-ecae21af.js";import{B as b}from"./BarLoader-49bae028.js";import"./index-5ce5650c.js";import{a as g}from"./axios-0f103e9d.js";import{h as v}from"./moment-494dae31.js";const f="/assets/user-8db58450.png",y={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",backgroundColor:"transparent",border:"none"}};function x(o){return e.jsx(l,{isOpen:!0,style:y,contentLabel:"Example Modal",children:null==o?void 0:o.children})}function w(l){return e.jsx(x,{children:e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 pl-4 pr-16 py-3 rounded relative shadow-xl",role:"alert",children:[e.jsx("strong",{className:"font-bold"}),e.jsx("span",{className:"block sm:inline",children:null==l?void 0:l.errorTitle}),e.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3",children:e.jsxs("svg",{onClick:()=>null==l?void 0:l.activateBottomErrorCard(!1,null),className:"fill-current h-6 w-6 text-red-500",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:[e.jsx("title",{children:"Close"}),e.jsx("path",{d:"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"})]})})]})})}l.setAppElement("#root");const N={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",backgroundColor:"white",border:"none"}};function k(f){const{handlePayment:y}=(()=>{const[e]=o();return{handlePayment:async(l,o)=>{const n=new e({key:"rzp_test_NXHWEn0nSMDcnm",amount:`${null==l?void 0:l.amount}`,currency:"INR",name:"Acme Corp",description:"Test Transaction",image:"https://deoghar.smartulb.co.in/static/media/rmclogo.d1d9f229f3fd3b66c19c.png",order_id:null==l?void 0:l.orderId,handler:async e=>{await o({...e,...l})},prefill:{name:"Piyush Garg",email:"youremail@example.com",contact:"9999999999"},notes:{address:"Razorpay Corporate Office",departmentId:null==l?void 0:l.departmentId,userId:null==l?void 0:l.user_id,workflowId:null==l?void 0:l.workflowId,ulbId:null==l?void 0:l.ulbId,applicationId:null==l?void 0:l.applicationId},theme:{color:"#3399cc"}});n.on("payment.failed",function(e){alert(e.error.code)}),n.open()}}})(),{id:x}=m(),{api_generateOrderIdswm:k,api_sendOnlineResponseswm:C,getPaymentUpto:I,getCalculateAmount:_}=c(),M=u(),[P,j]=p.useState(!1),[Y,L]=p.useState(!1),[T,E]=p.useState(!1),[R,A]=p.useState(!1),[q,z]=p.useState(null),[O,S]=p.useState(null);p.useState(!1),p.useState();const[U,B]=p.useState(),[D,$]=p.useState(),[V,G]=p.useState("");let H=n({paymentMode:t().required("select payment mode"),remarks:t(),bankName:t(),branchName:t(),cheque_dd_no:t(),cheque_dd_date:t()});const Q=r({initialValues:{paymentUpto:"",remarks:"",bankName:"",branchName:"",cheque_dd_no:"",cheque_dd_date:"",payAdvance:"",advanceAmount:""},validationSchema:H,onSubmit:e=>{F()}}),W=(e,l)=>{S(l),E(e)},X=()=>A(!1),F=async e=>{L(!0),g.post(k,{amount:null==D?void 0:D.totaldemand,consumerId:null==f?void 0:f.consumerId,consumerType:null==f?void 0:f.consumerType},a()).then(e=>{var l,o;!0===(null==(l=null==e?void 0:e.data)?void 0:l.status)?y({order_id:null==(o=null==e?void 0:e.data)?void 0:o.data,amount:100*(null==D?void 0:D.totaldemand)},J):W(!0,"Error occured. Please try again later.")}).catch(e=>{W(!0,"Error occured. Please try again later.")}).finally(()=>{L(!1)})},J=async e=>{var l;let o={amount:(null==e?void 0:e.amount)/100,consumerId:f.consumerId,consumerType:null==f?void 0:f.consumerType,orderId:null==(l=null==e?void 0:e.order_id)?void 0:l.order_id,paymentId:null==e?void 0:e.razorpay_payment_id,payUpto:V};d.post(C,o,a()).then(e=>{var l,o;1==e.data.status?(s.success("Payment Done Successfully !!!","success"),M(`/swm-payment-receipt/${null==(o=null==(l=e.data)?void 0:l.data)?void 0:o.transactionId}`,{replace:!0})):s.error(e.data.message,"error")}).catch(e=>{s.error(e.message,"error")})};p.useEffect(()=>{g.post(I,{consumerId:x,consumerType:null==f?void 0:f.consumerType}).then(e=>{e.data.status&&B(e.data.data)}).catch(e=>{})},[]),p.useEffect(()=>{V&&g.post(_,{consumerId:x,payUpto:V,consumerType:null==f?void 0:f.consumerType}).then(e=>{e.data.status&&$(e.data.data)}).catch(e=>{})},[V]);const K=()=>{null==f||f.closeDialogTag(),A(!1),F()};return Y?e.jsx(e.Fragment,{children:e.jsx(b,{})}):1==P?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"w-full h-full bg-white sm:p-20 p-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-center font-semibold text-3xl",children:"Your payment has been successfully done !"}),e.jsxs("div",{className:"text-center mt-6",children:[e.jsx("button",{className:"mr-4 bg-indigo-500  text-white px-6 py-1 shadow-lg hover:scale-105 rounded-sm",onClick:()=>M(`/swm-payment-receipt/${x}`),children:"View Receipt"}),e.jsx("button",{className:"mr-4 bg-white border border-indigo-500 text-indigo-500 px-4 py-1 shadow-lg hover:scale-105 rounded-sm",onClick:()=>M(`/challan/${x}/direct`),children:"View Challan"})]})]}),void 0]})}):e.jsxs(e.Fragment,{children:[T&&e.jsx(w,{activateBottomErrorCard:W,errorTitle:O}),e.jsx("div",{className:" block sm:p-4 mt-4 w-full md:py-4 md:px-40 md:pb-0 md:pt-0 rounded-lg  bg-white md:w-full mx-auto  overflow-x-auto mb-20 ",children:e.jsxs("div",{className:"border rounded-md shadow-lg shadow-black flex justify-center items-center ",children:[e.jsxs("div",{className:"w-full md:w-[25%] ml-2",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:["Payment Upto",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:V,onChange:e=>{const{value:l}=e.target;G(l)},className:(Q.errors.searchBy?"text-red-400 font-semibold border border-solid border-red-400 placeholder-red-300 shadow-red-100 ":"text-gray-700 font-normal border border-solid border-gray-400 placeholder-gray-400 h-10")+" cursor-pointer w-full px-3 py-1 text-sm  bg-white bg-clip-padding rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none shadow-sm",children:[e.jsx("option",{value:"",disabled:!0,children:"--Select--"}),null==U?void 0:U.map(l=>e.jsx("option",{value:l.payment_to,children:v(l.payment_to,"YYYY-MM-DD").format("MMM-YYYY")}))]})]}),e.jsxs("div",{className:"p-4 w-full md:py-6 rounded-lg bg-white mx-auto flex mt-3",children:[e.jsxs("div",{className:"md:px-4  flex justify-center items-center mt-4",children:[e.jsx("span",{children:"Total Payable Amount :"})," ",e.jsx("span",{className:"font-mono font-bold text-xl",children:i(null==D?void 0:D.totaldemand)})]}),e.jsx("div",{className:"mt-4 ",children:e.jsxs("button",{onClick:K,type:"button",className:"sm:ml-4 font-bold px-6 py-3 md:py-2 bg-indigo-500 text-white text-xs sm:text-sm leading-tight uppercase rounded  hover:bg-indigo-700 hover:shadow-lg focus:shadow-lg focus:outline-none focus:ring-0 active:bg-indigo-800 active:shadow-lg transition duration-150 ease-in-out shadow-xl border border-white",children:[e.jsx("span",{className:"sm:mr-2 mr-1",children:"Pay "}),i(null==D?void 0:D.totaldemand)]})})]})]})}),e.jsx(l,{isOpen:R,onRequestClose:X,style:N,contentLabel:"Example Modal",children:e.jsxs("div",{class:"relative bg-white rounded-lg shadow-xl border-2 border-gray-50",children:[e.jsx("button",{onClick:X,type:"button",class:"absolute top-3 right-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center dark:hover:bg-gray-800 dark:hover:text-white",children:e.jsx("svg",{class:"w-5 h-5",fill:"currentColor",children:e.jsx("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})})}),e.jsxs("div",{class:"p-6 text-center",children:[e.jsxs("div",{className:"w-full flex h-10",children:[" ",e.jsx("span",{className:"mx-auto",children:e.jsx(h,{size:30})})]}),e.jsx("h3",{class:"mb-5 text-lg font-normal text-gray-500 dark:text-gray-400",children:"Confirm Payment"}),e.jsx("button",{type:"button",class:"text-white bg-green-600 hover:bg-green-800 focus:ring-4 focus:outline-none focus:ring-red-300 dark:focus:ring-red-800 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center mr-2",onClick:K,children:"Yes, I'm sure"})]})]})})]})}export{k as P,f as p};
