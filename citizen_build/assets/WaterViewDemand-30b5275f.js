import{j as e}from"./mui-d8134288.js";import{r as l,f as a,u as t}from"./router-a70afc62.js";import{W as s,A as d,c as i,u as r,f as n,aM as o,Q as c}from"./index-1c8a2e08.js";import{h as m}from"./moment-494dae31.js";import{W as x}from"./WaterTopButtons-2cc67c8c.js";import{a as h}from"./axios-0f103e9d.js";import"./reactIcons-65f093d4.js";import"./materialTailwind-01b55b4e.js";/* empty css                */import"./redux-c3344370.js";import"./i18next-524eea2d.js";function p(p){var u,f,N,b,g,v,y;const[w,D]=l.useState(!1),[M,A]=l.useState(),[Y,j]=l.useState(),[R,T]=l.useState(!1),[k,C]=l.useState(!1),[F,I]=l.useState(!1),[S,P]=l.useState(),[B,U]=l.useState(!1),{id:W}=a(),G=t(),{api_waterApprovedApplicationDetails:L,api_waterListDemand:_,api_waterselfDemandGenration:q,header:H}=s(),z=m(Date()).format("DD-MMM-yy");l.useEffect(()=>{d.post(_,{ConsumerId:W},H).then(e=>{e.data.status&&j(e.data.data)}).catch(e=>{})},[W]),l.useEffect(()=>{D(!0),d.post(L,{id:W},H).then(function(e){A(e.data.data),D(!1)}).catch(function(e){D(!1)})},[W]);const E=i().shape({}),O=r({enableReinitialize:!0,initialValues:{meterReading:"",meterImage:""},onSubmit:(e,{resetForm:l})=>{h.post(q,Q,H).then(e=>{e.data.status?(c.success(e.data.message),window.location.reload()):(c.error(e.data.message),T(e.data.message))}).catch(e=>{T(e.response.data)}),l()},validationSchema:E});let Q=new FormData;return Q.append("id",W),Q.append("finalReading",B),Q.append("document",S),e.jsxs(e.Fragment,{children:[w&&e.jsx(n,{}),e.jsx(x,{active:"demand",consumerNo:null==M?void 0:M.consumer_no}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-12 lg:grid-cols-12 gap-2 container mx-auto w-full max-sm:p-3",children:e.jsx("div",{className:"col-span-12 rounded-lg",children:e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"",children:[e.jsxs("h1",{className:"px-1 font-semibold font-serif  text-gray-500",children:[e.jsx(o,{className:"inline"})," Basic Details"]}),e.jsx("div",{className:"py-6 mt-2 bg-white rounded-lg shadow-xl",children:e.jsxs("div",{className:"flex flex-wrap gap-5 pl-4 max-sm:flex-col max-sm:gap-2 ",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-sm",children:(null==M?void 0:M.ulb_name)?null==M?void 0:M.ulb_name:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"ULB Name"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-sm",children:(null==M?void 0:M.ward_name)?null==M?void 0:M.ward_name:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Ward No."})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-sm",children:(null==M?void 0:M.consumer_no)?null==M?void 0:M.consumer_no:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Consumer No"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-sm",children:(null==M?void 0:M.connection_through)?null==M?void 0:M.connection_through:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Connection Through"})]}),e.jsxs("div","SAF"==(null==M?void 0:M.connection_through)?{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-md",children:(null==M?void 0:M.saf_no)?null==M?void 0:M.saf_no:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"SAF No"})]}:{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-md",children:(null==M?void 0:M.holding_no)?null==M?void 0:M.holding_no:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Holding No"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-md",children:(null==M?void 0:M.owner_char_type)?null==M?void 0:M.owner_char_type:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Ownership Type"})]})]})})]}),e.jsx("div",{children:e.jsxs("div",{className:"",children:[e.jsxs("h1",{className:"px-1 font-semibold font-serif  text-gray-500 mt-3 mr-[60%] max-sm:mr-0",children:[e.jsx(o,{className:"inline"}),"Basic details of Meter "]}),e.jsx("div",{className:"py-6 mt-2 bg-white rounded-lg shadow-xl",children:e.jsxs("div",{className:"flex flex-wrap gap-5 pl-4 max-sm:flex-col max-sm:gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-sm",children:(null==M?void 0:M.connectionName)||"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Connection Type"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-sm",children:(null==(u=null==M?void 0:M.meterDetails)?void 0:u.meter_no)||"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Meter No."})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-sm",children:(null==M?void 0:M.lastMeterReading)?null==M?void 0:M.lastMeterReading:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Last Meter Reading"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-sm",children:(null==(f=null==M?void 0:M.meterDetails)?void 0:f.connection_date)||"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Connection Date"})]})]})})]})}),(null==M?void 0:M.meterDetails)&&e.jsxs(e.Fragment,{children:[e.jsxs("h1",{className:"pt-4 font-semibold font-serif text-gray-500",children:[e.jsx(o,{className:"inline"}),"Self Demand Generated"]}),e.jsx("div",{className:"mt-6 py-6  bg-white rounded-lg shadow-xl p-3",children:e.jsxs("form",{onSubmit:O.handleSubmit,onChange:e=>{let l=e.target.name,a=e.target.value;T(!1),C(""),"meterReading"===l&&(U(a),O.setFieldValue("meterReading",a)),"meterImage"===l&&P(e.target.files[0])},className:"p-4 relative",children:[e.jsxs("div",{className:"flex space-x-5 pl-4 max-sm:flex-col max-sm:space-x-0",children:["Meter"==(null==M?void 0:M.connectionName)&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:["Upload Meter Image ",e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]}),e.jsx("input",{type:"file",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md cursor-pointer",...O.getFieldProps("meterImage"),required:!0}),O.errors.meterImage&&O.touched.meterImage&&e.jsx(e.Fragment,{children:e.jsx("p",{className:"text-[red]",children:O.errors.meterImage})})]})}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4 max-sm:col-span-0 ",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:["Final Meter Reading ",e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]}),e.jsx("input",{type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 disabled:bg-gray-100 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md cursor-auto",placeholder:"Enter Meter Reading",required:!0,...O.getFieldProps("meterReading")}),O.errors.meterReading&&O.touched.meterReading&&e.jsx(e.Fragment,{children:e.jsx("p",{className:"text-[red]",children:O.errors.meterReading})})]})})]}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsx("label",{className:"form-label inline-block mb-1 text-gray-900 text-sm font-semibold",children:" Date"}),e.jsx("p",{className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 disabled:bg-gray-100 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md  text-center cursor-default",children:z})]})})]}),e.jsx("p",{className:"text-red-500 text-center font-semibold  ",children:R&&R}),e.jsxs("p",{className:"text-red-500 text-center font-semibold  ",children:[k&&k,F&&F]}),e.jsx("div",{className:"flex justify-end mr-5 max-sm:mr-0 max-sm:justify-center",children:e.jsx("button",{type:"submit",className:"bg-indigo-700 px-3 py-2 text-white rounded",children:"Generate Demand"})})]})})]}),Y?e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap w-full space-x-0 my-5 max-sm:flex-col max-sm:pl-3",children:[e.jsxs("div",{className:"grow",children:[e.jsx("span",{className:"text-sm",children:"Total Dues :"})," ",e.jsxs("span",{className:"font-semibold text-gray-700 text-lg",children:["₹ ",null==Y?void 0:Y.totalSumDemand]})]}),e.jsxs("div",{className:"grow",children:[e.jsx("span",{className:"text-sm",children:"Due From :"})," ",e.jsxs("span",{className:"font-semibold text-gray-700 text-lg",children:[m(null==(N=null==Y?void 0:Y.consumerDemands[0])?void 0:N.demand_from,"YYYY-MM-DD").format("DD-MMM-yy")," "]})]}),e.jsxs("div",{className:"grow",children:[e.jsx("span",{className:"text-sm",children:"Due Upto :"})," ",e.jsxs("span",{className:"font-semibold text-gray-700 text-lg",children:[m(null==(b=null==Y?void 0:Y.consumerDemands.at(-1))?void 0:b.demand_upto,"YYYY-MM-DD").format("DD-MMM-yy")," "]})]}),e.jsxs("div",{className:"grow",children:[e.jsx("span",{className:"text-sm",children:"Total Due Months :"})," ",e.jsx("span",{className:"font-semibold text-gray-700 text-lg",children:null==(g=null==Y?void 0:Y.consumerDemands)?void 0:g.length})]})]}),0!=(null==(v=null==Y?void 0:Y.consumerDemands)?void 0:v.length)&&e.jsxs("div",{className:"mt-6 mx-3 flex max-sm:flex-col space-x-8 max-sm:space-x-0",children:[e.jsxs("div",{className:"float-left flex max-sm:flex-col space-x-8 max-sm:space-x-0",children:[e.jsx("p",{className:"text-gray-600 text-xl font-semibold",children:"Total Payable Amount"}),e.jsxs("p",{className:"text-black text-2xl font-semibold",children:["₹ ",null==Y?void 0:Y.totalSumDemand]})]}),e.jsx("div",{className:"float-right",children:e.jsx("button",{onClick:()=>G(`/waterDemandPayment/${W}`),className:"bg-indigo-700 hover:bg-indigo-600 px-4 py-2 rounded shadow-2xl text-white text-sm max-sm:mt-3",children:"Pay Demand"})})]}),e.jsxs("div",{className:"mt-5",style:{maxHeight:"300px"},children:[e.jsxs("h1",{className:"px-1 font-semibold font-serif text-gray-500",children:[e.jsx(o,{className:"inline"})," Demand Details"]}),e.jsx("div",{className:"overflow-auto",children:e.jsxs("table",{className:"min-w-full leading-normal mt-2 bg-white rounded-lg shadow-xl p-4",children:[e.jsx("thead",{className:"font-bold text-left text-sm border text-gray-800 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"#"}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Demand From"}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Demand Upto"}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Demand Amount"}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Penalty"}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Connection Type"}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Payable Amount "})]})}),e.jsx("tbody",{className:"text-sm",children:e.jsx(e.Fragment,{children:null==(y=null==Y?void 0:Y.consumerDemands)?void 0:y.map((l,a)=>e.jsxs("tr",{className:"bg-white shadow-xl border-b border-gray-200",children:[e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:a+1}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:(null==l?void 0:l.demand_from)?m(null==l?void 0:l.demand_from,"YYYY-MM-DD").format("DD-MMM-yy"):"N/A"}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:(null==l?void 0:l.demand_upto)?m(null==l?void 0:l.demand_upto,"YYYY-MM-DD").format("DD-MMM-yy"):"N/A"}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:(null==l?void 0:l.balance_amount)?null==l?void 0:l.balance_amount:"N/A"}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:(null==l?void 0:l.penalty)?null==l?void 0:l.penalty:"N/A"}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:(null==l?void 0:l.connection_type)?null==l?void 0:l.connection_type:"N/A"}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:(null==l?void 0:l.amount)?"₹ "+(null==l?void 0:l.amount):"N/A"})]}))})})]})})]})]}):e.jsx("div",{className:"text-center mt-5 border border-indigo-300 shadow-md rounded py-2 font-semibold text-red-600",children:"Demand Not Found !"})]})})}),e.jsx("div",{className:"w-full h-60"})]})}export{p as default};
