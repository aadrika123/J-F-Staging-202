import{j as e}from"./mui-d8134288.js";import{r as a,u as l}from"./router-a70afc62.js";import{V as i}from"./index.esm-6fe1e240.js";import{z as r,c as t,d as s,u as n,A as d,a3 as c}from"./index-1c8a2e08.js";import{G as m}from"./GrievanceApiList-4e83b4c5.js";import"./reactIcons-65f093d4.js";import"./axios-0f103e9d.js";import"./materialTailwind-01b55b4e.js";import"./moment-494dae31.js";/* empty css                */import"./redux-c3344370.js";import"./i18next-524eea2d.js";function o(o){var p;const[h,u]=a.useState(null),[N,v]=a.useState(),[x,b]=a.useState(),[g,f]=a.useState(),[y,w]=a.useState(),[S,j]=a.useState(!1),[R,I]=a.useState(!1),[G,F]=a.useState(),{api_distList:q,api_getAllUlbList:D,api_wardListByUlb:H,api_grievanceApplyForm:U}=m(),{notify:A}=a.useContext(r);l();const C=t({applicantName:s().required("Require"),email:s().email("Invalid email address").required("Require"),gender:s().required("Require"),disability:s().required("Require"),grievanceHead:s().required("Require"),description:s().required("Require"),department:s().required("Require"),district:s().required("Require"),ulb:s().required("Require"),ward:s().required("Require"),fileUpload:s().required("Require")}),E=n({initialValues:{mobileNo:null==o?void 0:o.mobileNo,applicantName:"",email:"",aadhar:"",gender:"",disability:"",department:"",grievanceHead:"",description:"",district:"",ulb:"",ward:"",address:"",otherInfo:"",fileUpload:""},enableReinitialize:!0,onSubmit:(e,a)=>{V(e)},validationSchema:C}),$=a.useRef(null),_=a.useRef(null),L=a.useRef(null),O=a.useRef(null);a.useEffect(()=>{d.post(q,{}).then(e=>{e.data.status&&b(e.data.data)}).catch(e=>{})},[]),a.useEffect(()=>{d.get(D).then(e=>{e.data.status&&f(e.data.data)}).catch(e=>{})},[]),a.useEffect(()=>{d.post(H,{ulbId:2}).then(e=>{e.data.status&&w(e.data.data)}).catch(e=>{})},[E.values.ulb]);const V=e=>{var a;j();let l=new FormData;l.append("mobileNo",e.mobileNo),l.append("applicantName",e.applicantName),l.append("email",e.email),l.append("aadhar",e.aadhar),l.append("gender",e.gender),l.append("disability",e.disability),l.append("department",e.department),l.append("grievanceHead",e.grievanceHead),l.append("description",e.description),l.append("districtId",Number(e.district)),l.append("ulbId",e.ulb),l.append("wardId",e.ward),l.append("address",e.address),l.append("otherInfo",e.otherInfo),l.append("document",N||""),l.append("docCode","GRIEVANCE_DOC"),l.append("docCategory","GRIEVANCE_DOC"),I(!0),null==(a=d)||a.post(U,l).then(e=>{var a,l,i;I(!1),e.data.status?(A("Grievance Submitted Successfully","success"),o.grievanceApplicationNo(null==(l=null==(a=null==e?void 0:e.data)?void 0:a.data)?void 0:l.applicationNo),F(null==(i=null==e?void 0:e.data)?void 0:i.applicationNo),o.screen()):(A("Grievance not submitted","error"),j(e.data.message||"Failed to apply grievance"))}).catch(e=>{I(!1),A("Error while Grievance submitting","error"),j("Error While applying grievance")})},W="flex-1 w-full px-4 py-2 text-base text-gray-800 placeholder-gray-400 bg-white border border-gray-300 focus:outline-none focus:ring-1 focus:ring-indigo-800 focus:border-transparent",z="text-red-700 font-semibold";return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"p-5 py-6 rounded-lg border border-indigo-300 bg-white",children:[e.jsxs("p",{className:"absolute right-8 top-8 cursor-pointer bg-gray-100 hover:bg-gray-300",children:[" ",e.jsx(i,{size:30})," "]}),e.jsx("div",{className:"text-center text-lg",children:" Submit Your Grievance "}),e.jsx("div",{children:e.jsxs("form",{onSubmit:E.handleSubmit,onChange:e=>{if("fileUpload"===e.target.name){const a=e.target.files[0],l=new FileReader;l.onload=()=>{u(l.result)},l.readAsDataURL(a),v(a)}},onSubmitCapture:()=>E.errors.applicantName?$.current.focus():E.errors.email?_.current.focus():E.errors.gender?L.current.focus():E.errors.department?O.current.focus():void 0,children:[e.jsxs("div",{className:"m-3",children:[e.jsxs("label",{children:["Mobile No",e.jsx("span",{className:z,children:"*"})]}),e.jsx("input",{type:"text",disabled:!0,...E.getFieldProps("mobileNo"),name:"mobileNo",className:`${W} disabled:bg-gray-200`})]}),e.jsxs("div",{className:"m-3",children:[e.jsxs("label",{children:["Applicant Name",e.jsx("span",{className:z,children:"*"})]}),e.jsx("input",{type:"text",...E.getFieldProps("applicantName"),name:"applicantName",ref:$,className:`${E.errors.applicantName&&"border-red-600"} ${W}`}),e.jsx("p",{className:"text-red-500 text-xs",children:E.touched.applicantName&&E.errors.applicantName?E.errors.applicantName:null})]}),e.jsxs("div",{className:"m-3",children:[e.jsxs("label",{children:["Email",e.jsx("span",{className:z,children:"*"})]}),e.jsx("input",{type:"text",...E.getFieldProps("email"),name:"email",ref:_,className:` ${E.errors.email&&"border-red-600"} ${W}`}),e.jsx("p",{className:"text-red-500 text-xs",children:E.touched.email&&E.errors.email?E.errors.email:null})]}),e.jsxs("div",{className:"m-3",children:[e.jsx("label",{children:"Aadhar"}),e.jsx("input",{type:"text",...E.getFieldProps("aadhar"),name:"aadhar",className:`${W}`}),e.jsx("p",{className:"text-red-500 text-xs",children:E.touched.aadhar&&E.errors.aadhar?E.errors.aadhar:null})]}),e.jsxs("div",{className:"m-3",children:[e.jsxs("div",{className:"flex justify-start",children:[e.jsxs("label",{children:["Gender",e.jsx("span",{className:z,children:"*"})]}),e.jsx("input",{type:"radio",...E.getFieldProps("gender"),name:"gender",ref:L,value:"male",className:"mx-2"}),"Male",e.jsx("input",{type:"radio",...E.getFieldProps("gender"),name:"gender",ref:L,value:"female",className:"mx-2"}),"Female"]}),e.jsx("p",{className:"text-red-500 text-xs",children:E.touched.gender&&E.errors.gender?E.errors.gender:null})]}),e.jsxs("div",{className:"m-3",children:[e.jsxs("div",{className:"flex justify-start",children:[e.jsxs("label",{children:["Specially abled ?",e.jsx("span",{className:z,children:"*"})]}),e.jsx("input",{type:"radio",...E.getFieldProps("disability"),name:"disability",value:"true",className:"mx-2"}),"Yes",e.jsx("input",{type:"radio",...E.getFieldProps("disability"),name:"disability",value:"false",className:"mx-2"}),"No"]}),e.jsx("p",{className:"text-red-500 text-xs",children:E.touched.disability&&E.errors.disability?E.errors.disability:null})]}),e.jsxs("div",{className:"m-3",children:[e.jsxs("label",{children:["Select Department ",e.jsx("span",{className:z,children:"*"})]}),e.jsxs("select",{...E.getFieldProps("department"),name:"department",ref:O,className:` ${E.errors.department&&"border-red-600"} ${W}`,children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"1",children:"Department 1"}),e.jsx("option",{value:"2",children:"Department 2"}),e.jsx("option",{value:"3",children:"Department 3"})]}),e.jsx("p",{className:"text-red-500 text-xs",children:E.touched.department&&E.errors.department?E.errors.department:null})]}),e.jsxs("div",{className:"m-3",children:[e.jsxs("label",{htmlFor:"grievanceHead",children:["Select Grievance Head ",e.jsx("span",{className:z,children:"*"})]}),e.jsxs("select",{...E.getFieldProps("grievanceHead"),name:"grievanceHead",className:W,children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"1",children:"Grievance Head 1"}),e.jsx("option",{value:"2",children:"Grievance Head 2"}),e.jsx("option",{value:"3",children:"Grievance Head 3"})]}),e.jsx("p",{className:"text-red-500 text-xs",children:E.touched.grievanceHead&&E.errors.grievanceHead?E.errors.grievanceHead:null})]}),e.jsxs("div",{className:"m-3",children:[e.jsxs("label",{htmlFor:"description",children:["Write Description ",e.jsx("span",{className:z,children:"*"})]}),e.jsx("textarea",{...E.getFieldProps("description"),name:"description",className:W,placeholder:"Enter your grievance",rows:"5",cols:"40"}),e.jsx("p",{className:"text-red-500 text-xs",children:E.touched.description&&E.errors.description?E.errors.description:null})]}),e.jsxs("div",{className:"md:grid md:grid-flow-col justify-stretch",children:[e.jsxs("div",{className:"m-3",children:[e.jsxs("label",{children:["Select District ",e.jsx("span",{className:z,children:"*"})]}),e.jsxs("select",{...E.getFieldProps("district"),name:"district",className:W,children:[e.jsx("option",{children:"Select"}),null==x?void 0:x.map(a=>e.jsx("option",{value:a.district_code,children:a.district_name}))]}),e.jsx("p",{className:"text-red-500 text-xs",children:E.touched.district&&E.errors.district?E.errors.district:null})]}),e.jsxs("div",{className:"m-3",children:[e.jsxs("label",{htmlFor:"ulb",children:["Select ULB ",e.jsx("span",{className:z,children:"*"})]}),e.jsxs("select",{...E.getFieldProps("ulb"),name:"ulb",className:W,children:[e.jsx("option",{value:"",children:"Select"}),null==(p=null==g?void 0:g.filter(e=>e.district_id==E.values.district))?void 0:p.map(a=>e.jsx("option",{value:a.id,children:a.ulb_name}))]}),e.jsx("p",{className:"text-red-500 text-xs",children:E.touched.ulb&&E.errors.ulb?E.errors.ulb:null})]}),e.jsxs("div",{className:"m-3",children:[e.jsxs("label",{htmlFor:"ward",children:["Select Ward ",e.jsx("span",{className:z,children:"*"})]}),e.jsxs("select",{...E.getFieldProps("ward"),name:"ward",className:W,children:[e.jsx("option",{children:"Select"}),null==y?void 0:y.map(a=>e.jsx("option",{value:a.id,children:a.ward_name}))]}),e.jsx("p",{className:"text-red-500 text-xs",children:E.touched.ward&&E.errors.ward?E.errors.ward:null})]})]}),e.jsxs("div",{className:"m-3",children:[e.jsxs("label",{htmlFor:"address",children:["Your Address ",e.jsx("span",{className:z,children:"*"})]}),e.jsx("textarea",{...E.getFieldProps("address"),name:"address",className:W,placeholder:"Enter your address",rows:"2"}),e.jsx("p",{className:"text-red-500 text-xs",children:E.touched.address&&E.errors.address?E.errors.address:null})]}),e.jsxs("div",{className:"m-3",children:[e.jsxs("label",{htmlFor:"otherInfo",children:["Other Information ",e.jsx("span",{className:"text-xs italic",children:"(optional)"})," ",e.jsx("span",{className:z,children:"*"})]}),e.jsx("textarea",{...E.getFieldProps("otherInfo"),name:"otherInfo",className:W,placeholder:"Other Information",rows:"2"}),e.jsx("p",{className:"text-red-500 text-xs",children:E.touched.otherInfo&&E.errors.otherInfo?E.errors.otherInfo:null})]}),e.jsxs("div",{className:"m-3",children:[e.jsxs("label",{htmlFor:"fileUpload",children:["Upload File ",e.jsx("span",{className:"text-xs italic",children:"(optional)"})," ",e.jsx("span",{className:z,children:"*"})]}),e.jsx("input",{...E.getFieldProps("fileUpload"),type:"file",accept:"image/*",name:"fileUpload",className:W}),e.jsx("p",{className:"text-red-500 text-xs",children:E.touched.fileUpload&&E.errors.fileUpload?E.errors.fileUpload:null})]}),e.jsx("div",{className:"flex justify-center",children:h&&e.jsx("img",{src:h,alt:"Preview",className:"border border-gray-300 px-4 py-2 rounded-lg mt-4 h-32"})}),e.jsx("p",{className:"text-center text-red-500 font-semibold",children:S&&S}),e.jsx("div",{className:"m-3 flex justify-center",children:e.jsx("button",{disabled:R,type:"submit",className:"px-4 py-2 mt-5 bg-indigo-600 hover:bg-indigo-700 text-gray-50 text-base shadow-md rounded-md",children:R?e.jsx("div",{children:e.jsx(c,{strokeColor:"white",strokeWidth:"5",animationDuration:"0.75",width:"20",visible:!0})}):"Submit Grievances"})})]})})]})})}export{o as default};
