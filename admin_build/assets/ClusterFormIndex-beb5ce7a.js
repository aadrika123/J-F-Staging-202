import{u as p,r as o,a as N,m as g,Q as h,d as le,e as S,Y as re,f as ne,j as e,l as oe,t as ee,a6 as de,P as ie,b as ce,B as ue,L as me,n as C,ae as xe}from"./index-28e798bd.js";import{P as be}from"./reactjs-popup.esm-c73af7eb.js";import{C as te,a as he}from"./ClusterView-8c6293d1.js";import{b as ae,d as ge}from"./index.esm-868d8c90.js";import{B as se}from"./BottomErrorCard-357ff292.js";import{d as fe}from"./index.esm-68e42516.js";import"./index.esm-5a993d46.js";import"./PowerupFunctions-7310c5f4.js";const we=t=>{var T,B,H,q,J,z,U,O,_;p();const{addCluster:V,updateCluster:y}=te(),{api_wardByUlb:P,api_newWardByOldWard:k}=de(),{ulbList:W}=ie(),[$,I]=o.useState(!1),[A,G]=o.useState(),[b,Y]=o.useState(),[f,E]=o.useState(),[F,u]=o.useState(!1),[Q,L]=o.useState(null);o.useEffect(()=>{t!=null&&t.editState&&(m(),M()),u(!1),N.get(W,g()).then(r=>{var n,d;(n=r==null?void 0:r.data)!=null&&n.status?(console.log("ulb list => ",r),G((d=r==null?void 0:r.data)==null?void 0:d.data)):(h.error("Something went wrong !!!"),t==null||t.backFun())}).catch(r=>{h.error("Something went wrong !!!"),t==null||t.backFun()}).finally(()=>u(!1))},[]);const m=r=>{var d;u(!0);let n;t!=null&&t.editState?n={ulbId:(d=t==null?void 0:t.userData)==null?void 0:d.ulb_id}:n={ulbId:r.target.value},N.post(P,n,g()).then(i=>{var c,w;(c=i==null?void 0:i.data)!=null&&c.status?(console.log("ward by ulb list => ",i),Y((w=i==null?void 0:i.data)==null?void 0:w.data)):(h.error("Something went wrong !!!"),console.log("false getting ward",i),t==null||t.backFun())}).catch(i=>{h.error("Something went wrong !!!"),console.log("error getting ward",i),t==null||t.backFun()}).finally(()=>u(!1))},M=r=>{var d,i;let n;t!=null&&t.editState?n={oldWardMstrId:(d=t==null?void 0:t.userData)==null?void 0:d.ward_mstr_id,ulbId:(i=t==null?void 0:t.userData)==null?void 0:i.ulb_id}:n={oldWardMstrId:r.target.value,ulbId:s.values.ulbId},console.log("before fetch wardby old ward...",n),N.post(k,n,g()).then(function(c){var w,R,v;(w=c==null?void 0:c.data)!=null&&w.status?(console.log("wardlist by oldward list ....",(R=c==null?void 0:c.data)==null?void 0:R.data),E((v=c==null?void 0:c.data)==null?void 0:v.data)):(h.error("Something went wrong !!!"),t==null||t.backFun())}).catch(c=>{h.error("Something went wrong !!!"),t==null||t.backFun()}).finally(()=>u(!1))},K=le({ulbId:S().required("Select ulb id"),wardNo:S().required("Select ward"),newWardNo:S().required("Select new ward"),clusterName:S().required("Enter name"),clusterType:S().required("Select type"),clusterAddress:S().required("Enter address"),clusterMobileNo:re().typeError("must be number").min(1e9,"not valid").max(9999999999,"not valid").required("Enter mobile no."),clusterAuthPersonName:S().required("Select authorized person name")});o.useEffect(()=>{console.log("user Data => ",t==null?void 0:t.userData,`
 and edit state => `,t==null?void 0:t.editState,`
 and index is => `,t==null?void 0:t.userId)});const s=ne({initialValues:{id:(T=t==null?void 0:t.userData)==null?void 0:T.id,ulbId:(B=t==null?void 0:t.userData)==null?void 0:B.ulb_id,wardNo:(H=t==null?void 0:t.userData)==null?void 0:H.ward_mstr_id,newWardNo:(q=t==null?void 0:t.userData)==null?void 0:q.new_ward_mstr_id,clusterName:(J=t==null?void 0:t.userData)==null?void 0:J.cluster_name,clusterType:(z=t==null?void 0:t.userData)==null?void 0:z.cluster_type,clusterAddress:(U=t==null?void 0:t.userData)==null?void 0:U.address,clusterMobileNo:(O=t==null?void 0:t.userData)==null?void 0:O.mobile_no,clusterAuthPersonName:(_=t==null?void 0:t.userData)==null?void 0:_.authorized_person_name},onSubmit:r=>{console.log("--1-- concession form data => ",r),X(r)},validationSchema:K}),X=r=>{console.log("--2-- before fetch data => ",r),u(!0),t!=null&&t.editState?N.post(y,r,g()).then(n=>{var d;console.log(`--3-- form updated successfully 
 data => `,n),(d=n==null?void 0:n.data)!=null&&d.status?(h.success("Updated Successfully"),t.backFun(),t.refresh()):j(!0,"Error occured while updating cluster. Please try again later."),u(!1)}).catch(n=>{console.log("--3-- form updation error => ",n),u(!1),j(!0,"Error occured while updating cluster. Please try again later.")}):N.post(V,r,g()).then(n=>{var d;console.log(`--3-- form added successfully 
 data => `,n),(d=n==null?void 0:n.data)!=null&&d.status?(t.backFun(),h.success("Added Successfully"),t.refresh()):j(!0,"Error occured while adding cluster. Please try again later."),u(!1)}).catch(n=>{console.log("--3-- form addition error => ",n),u(!1),j(!0,"Error occured while adding cluster. Please try again later.")})},j=(r,n)=>{L(n),I(r)};return e.jsxs(e.Fragment,{children:[F&&e.jsx(oe,{}),$&&e.jsx(se,{activateBottomErrorCard:j,errorTitle:Q}),e.jsx(ee,{position:"top-right",autoClose:2e3}),e.jsxs("h1",{className:"mt-6 mb-2 sm:-mb-16 mx-6 font-serif font-semibold relative text-gray-600",children:[e.jsx(ae,{className:"inline mr-2"}),"Cluster Form"]}),e.jsx("div",{className:" block sm:mt-[4rem] md:mt-[5rem] p-4 w-full md:py-6 md:px-14 shadow-lg bg-white mx-auto border border-gray-200",children:e.jsx("form",{onSubmit:s.handleSubmit,onChange:s.handleChange,className:"text-xs",children:e.jsxs("div",{className:"grid grid-cols-12 md:gap-x-8 gap-y-6",children:[e.jsxs("div",{className:"md:col-span-4 col-span-12",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 font-semibold",children:[e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"ULB"]}),e.jsxs("select",{value:s.values.ulbId,onChange:m,name:"ulbId",className:"form-control block w-[80%] px-3 py-1.5 text-sm font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none shadow-md",children:[e.jsx("option",{value:"",children:"Select"}),A==null?void 0:A.map(r=>e.jsx("option",{value:r.id,children:r.ulb_name}))]}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:s.touched.ulbId&&s.errors.ulbId?s.errors.ulbId:null})]}),e.jsxs("div",{className:"md:col-span-4 col-span-12",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 font-semibold",children:[e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Ward No."]}),e.jsxs("select",{value:s.values.wardNo,onChange:M,name:"wardNo",className:"form-control block w-[80%] px-3 py-1.5 text-sm font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none shadow-md",children:[e.jsx("option",{value:"",children:"Select"}),b==null?void 0:b.map(r=>e.jsx("option",{value:r.id,children:r.ward_name}))]}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:s.touched.wardNo&&s.errors.wardNo?s.errors.wardNo:null})]}),e.jsxs("div",{className:"md:col-span-4 col-span-12",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 font-semibold",children:[e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"New Ward No."]}),e.jsxs("select",{value:s.values.newWardNo,name:"newWardNo",className:"form-control block w-[80%] px-3 py-1.5 text-sm font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none shadow-md",children:[e.jsx("option",{value:"",children:"Select"}),f==null?void 0:f.map(r=>e.jsx("option",{value:r.id,children:r.ward_name}))]}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:s.touched.newWardNo&&s.errors.newWardNo?s.errors.newWardNo:null})]}),e.jsxs("div",{className:"md:col-span-4 col-span-12",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 font-semibold",children:[e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Name"]}),e.jsx("input",{type:"text",value:s.values.clusterName,onChange:s.handleChange,name:"clusterName",className:"form-control block w-[80%] px-3 py-1.5 text-sm font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none shadow-md",placeholder:"Enter your name.."}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:s.touched.clusterName&&s.errors.clusterName?s.errors.clusterName:null})]}),e.jsxs("div",{className:"md:col-span-4 col-span-12",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 font-semibold",children:[e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Type"]}),e.jsxs("select",{value:s.values.clusterType,onChange:s.handleChange,name:"clusterType",className:"form-control block w-[80%] px-3 py-1.5 text-sm font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none shadow-md",children:[e.jsx("option",{value:"",disabled:!0,selected:!0,children:"--Select Type--"}),e.jsx("option",{value:"c-saf",children:"C-SAF"}),e.jsx("option",{value:"gb-saf",children:"GB-SAF"})]}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:s.touched.clusterType&&s.errors.clusterType?s.errors.clusterType:null})]}),e.jsxs("div",{className:"md:col-span-4 col-span-12",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 font-semibold",children:[e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Address"]}),e.jsx("input",{value:s.values.clusterAddress,onChange:s.handleChange,type:"text",name:"clusterAddress",className:"form-control block w-[80%] px-3 py-1.5 text-sm font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none shadow-md",placeholder:"Enter your address.."}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:s.touched.clusterAddress&&s.errors.clusterAddress?s.errors.clusterAddress:null})]}),e.jsxs("div",{className:"md:col-span-4 col-span-12",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 font-semibold",children:[e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Mobile No."]}),e.jsx("input",{value:s.values.clusterMobileNo,onChange:s.handleChange,type:"text",maxLength:10,name:"clusterMobileNo",className:"form-control block w-[80%] px-3 py-1.5 text-sm font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none shadow-md",placeholder:"Enter your mobile no..."}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:s.touched.clusterMobileNo&&s.errors.clusterMobileNo?s.errors.clusterMobileNo:null})]}),e.jsxs("div",{className:"md:col-span-4 col-span-12",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 font-semibold",children:[e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Authorized Person Name"]}),e.jsx("input",{value:s.values.clusterAuthPersonName,onChange:s.handleChange,type:"text",name:"clusterAuthPersonName",className:"form-control block w-[80%] px-3 py-1.5 text-sm font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none shadow-md",placeholder:"Enter authorized person name.."}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:s.touched.clusterAuthPersonName&&s.errors.clusterAuthPersonName?s.errors.clusterAuthPersonName:null})]}),e.jsxs("div",{className:"col-span-12 flex justify-between",children:[e.jsx("button",{onClick:t.backFun,type:"button",className:"md:mt-1.5 px-6 py-2.5 bg-blue-600 text-white font-medium text-xs leading-tight  rounded shadow-md hover:bg-blue-700 hover:shadow-lg focus:bg-blue-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-blue-800 active:shadow-lg transition duration-150 ease-in-out",children:"Back"}),e.jsx("button",{type:"submit",className:"md:mt-2 px-6 py-2.5 bg-green-600 text-white font-medium text-xs leading-tight  rounded shadow-md hover:bg-green-700 hover:shadow-lg focus:bg-green-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-green-800 active:shadow-lg transition duration-150 ease-in-out",children:t!=null&&t.editState?e.jsx(e.Fragment,{children:"Update"}):e.jsx(e.Fragment,{children:"Add"})})]})]})})})]})},Ne=t=>{const[V,y]=o.useState(!1),[P,k]=o.useState(!1),[W,$]=o.useState(),[I,A]=o.useState(),[G,b]=o.useState(!1),[Y,f]=o.useState(!1);o.useState(!1);const[E,F]=o.useState(0),[u,Q]=o.useState(),[L,m]=o.useState(!1),[M,K]=o.useState(),[s,X]=o.useState();o.useState();const[j,T]=o.useState(0),[B,H]=o.useState(!1),[q,J]=o.useState(!1),[z,U]=o.useState(null);ce("Cluster Workflow");const{getCluster:O,viewCluster:_,deleteCluster:r}=te(),n=p();o.useEffect(()=>{m(!0),N.get(O,g()).then(l=>{var a;console.log("cluster list response => ",l),Q((a=l==null?void 0:l.data)==null?void 0:a.data),y(!0),b(!1),k(!1),f(!1),m(!1)}).catch(l=>{v(!0,"Error in fetching cluster list. Please try again later."),m(!1)})},[E]);const d=l=>{m(!0),console.log("Api header => ",g(),`
 and id is `,l),N.post(r,{id:l},g()).then(a=>{h.success("Deleted Successfully !!"),F(E+1),m(!1),y(!0),b(!1),k(!1),f(!1)}).catch(a=>{v(!0,"Error in deleting cluster. Please try again later."),console.log("err => ",a),m(!1)})},i=()=>{y(!1),f(!0),b(!1)};o.useEffect(()=>{F(E+1)},[]);const c=l=>{m(!0),console.log("entering edit function with id => ",l,` 
 and api is => `,_),N.post(_,{clusterId:l},g()).then(a=>{var x,D,Z;console.log("--4-- getting user data => ",(x=a==null?void 0:a.data)==null?void 0:x.data),A((Z=(D=a==null?void 0:a.data)==null?void 0:D.data)==null?void 0:Z.Cluster),y(!1),k(!0),b(!1),$(l),m(!1)}).catch(a=>{console.log("--4-- getting user data error => ",a),v(!0,"Error in cluster data update. Please try again later."),m(!1)})},w=()=>{b(!1),y(!0),k(!1),f(!1),A("")},R=[{Header:"S.No.",Cell:({row:l})=>e.jsx("div",{children:(l==null?void 0:l.index)+1})},{Header:"Old Ward No.",Cell:({cell:l})=>{var a;return C((a=l.row.original)==null?void 0:a.oldWard)}},{Header:"New Ward No.",Cell:({cell:l})=>{var a;return C((a=l.row.original)==null?void 0:a.newWard)}},{Header:"Name",Cell:({cell:l})=>{var a;return C((a=l.row.original)==null?void 0:a.name)}},{Header:"Type",Cell:({cell:l})=>{var a;return C((a=l.row.original)==null?void 0:a.type)}},{Header:"Address",Cell:({cell:l})=>{var a;return C((a=l.row.original)==null?void 0:a.address)}},{Header:"Mobile No.",accessor:"mobileNo",Cell:({cell:l})=>{var a;return C((a=l.row.original)==null?void 0:a.mobileNo)}},{Header:"Authorized Person Name",accessor:"authPersonName",Cell:({cell:l})=>{var a;return C((a=l.row.original)==null?void 0:a.authPersonName)}},{Header:"Actions",accessor:"id",Cell:({cell:l})=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"space-x-2",children:[e.jsx("button",{className:"text-green-500 hover:text-green-600 rounded-md text-lg shadow-lg py-1 px-2",onClick:()=>{var a,x;return c((x=(a=l==null?void 0:l.row)==null?void 0:a.values)==null?void 0:x.id)},children:e.jsx(fe,{})}),e.jsx("button",{className:"text-amber-500 hover:text-amber-600 rounded-md text-lg shadow-lg py-1 px-2",onClick:()=>{var a,x;return n("/viewCluster/"+((x=(a=l==null?void 0:l.row)==null?void 0:a.values)==null?void 0:x.id))},children:e.jsx(xe,{})}),e.jsx(be,{trigger:e.jsx("button",{className:"text-red-500 hover:text-red-600 rounded-md text-lg shadow-lg py-1 px-2",children:e.jsx(ge,{})}),modal:!0,nested:!0,children:a=>e.jsx("div",{className:"h-screen w-screen flex-row justify-center items-center backdrop-blur-sm",children:e.jsxs("div",{className:"flex flex-col justify-center h-max w-max absolute top-[40%] right-[40%] bg-white px-4 py-2 rounde-md shadow-lg animate__animated animate__fadeInDown animate__faster",children:[e.jsx("button",{className:"close text-end ",onClick:a,children:e.jsx("span",{className:"hover:bg-red-400 hover:text-white rounded-md px-1 ",children:"Ã—"})}),e.jsx("div",{className:"text-base",children:"Are you sure want to delete ?"}),e.jsxs("div",{className:"flex justify-center items-center",children:[e.jsx("button",{className:"bg-red-200 hover:bg-red-300 shadow-md text-xs px-4 py-1 m-4 rounded-md",onClick:()=>{var x,D;a(),d((D=(x=l==null?void 0:l.row)==null?void 0:x.values)==null?void 0:D.id)},children:"Yes"}),e.jsx("button",{className:"bg-green-200 hover:bg-green-300 px-4 shadow-md text-xs py-1 m-4 rounded-md",onClick:a,children:"No"})]})]})})})]})})}],v=(l,a)=>{U(a),H(l)};return L?e.jsx(e.Fragment,{children:e.jsx(ue,{})}):q?e.jsx(CommonModal,{children:e.jsx(ServerErrorCard,{title:"Server is busy",desc:"Server is too busy to respond. Please try again later.",buttonText:"View Dashboard",buttonUrl:"/propertyDashboard"})}):e.jsxs(e.Fragment,{children:[e.jsx(ee,{position:"top-right",autoClose:2e3}),B&&e.jsx(se,{activateBottomErrorCard:v,errorTitle:z}),e.jsx("div",{className:"px-2 sm:px-0",children:!L&&V&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h1",{className:"mt-6 mb-2 font-serif font-semibold  text-gray-600",children:[e.jsx(ae,{className:"inline mr-2"}),"Cluster List"]}),e.jsx("button",{className:"bg-sky-400 px-3 pr-3 shadow-lg rounded py-1 text-white hover:shadow-2xl hover:bg-green-600 text-center relative",onClick:()=>i(),children:"Add"})]}),e.jsx(me,{columns:R,dataList:u}),e.jsx("div",{className:"h-[20vh]"})]})}),(P||Y)&&e.jsx(e.Fragment,{children:e.jsx(we,{backFun:w,editState:P,userId:W,userData:I,refresh:()=>F(E+1)})}),G&&e.jsx(he,{backFun:w,userData:I,userId:W,holdingList:M,safList:s,refresh:()=>T(j+1)})]})},Fe=()=>e.jsxs("div",{className:"poppins",children:[e.jsx("div",{className:"uppercase font-semibold text-gray-700 text-lg sm:text-2xl py-2 text-center tracking-wide sm:tracking-[0.7rem]",children:"Cluster Workflow"}),e.jsx("div",{className:"w-full h-[0.15rem] bg-gray-400 mb-6"}),e.jsx(Ne,{})]});export{Fe as default};
