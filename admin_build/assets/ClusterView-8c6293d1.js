import{w as je,r as n,b as be,u as Ne,af as we,a as _,m as k,j as l,B as ye,C as Se,S as Ce,l as W,L,M as Ae,Q as w}from"./index-28e798bd.js";import{e as M}from"./index.esm-68e42516.js";import{b as He,f as Fe}from"./index.esm-868d8c90.js";import{a as _e}from"./index.esm-5a993d46.js";import{b as x}from"./PowerupFunctions-7310c5f4.js";import{B as ke}from"./BottomErrorCard-357ff292.js";const Le=()=>{const c=je;return{getCluster:`${c}/api/property/cluster/get-all-clusters`,addCluster:`${c}/api/property/cluster/save-cluster-details`,viewCluster:`${c}/api/property/cluster/get-cluster-by-id`,updateCluster:`${c}/api/property/cluster/edit-cluster-details`,deleteCluster:`${c}/api/property/cluster/delete-cluster-data`,viewHolding:`${c}/api/property/cluster/holding-by-cluster`,searchHolding:`${c}/api/property/cluster/details-by-holding`,searchSaf:`${c}/api/property/cluster/get-saf-by-safno`,mapHoldingApi:`${c}/api/property/cluster/save-holding-in-cluster`,mapSafApi:`${c}/api/property/cluster/save-saf-in-cluster`}};const Me=c=>{const[$,P]=n.useState(!1),[d,K]=n.useState(""),[o,T]=n.useState("SAF"),[j,q]=n.useState(""),[y,$e]=n.useState(!1),[m,G]=n.useState(),[f,Q]=n.useState([]),[u,B]=n.useState([]),[h,b]=n.useState([]),[a,Y]=n.useState(),[E,J]=n.useState(0),[X,S]=n.useState(!1),[Z,v]=n.useState(!1),[p,ee]=n.useState(!1),[le,C]=n.useState(!1),[te,ae]=n.useState(null);be("Cluster Details View");const A=Ne(),O=e=>{P(!0),K(e),b([]),B([])},H=()=>P(!1),ie=()=>{},{id:g}=we(),z="bg-indigo-500  text-white border border-indigo-500 px-4 py-1 shadow-lg hover:scale-105 rounded-sm transition-all duration-100 ease-in-out cursor-pointer text-sm",F="text-indigo-500 bg-white border border-indigo-500 px-4 py-1 shadow-lg hover:scale-105 rounded-sm transition-all duration-100 ease-in-out cursor-pointer text-sm",{mapHoldingApi:ne,mapSafApi:se,searchHolding:de,searchSaf:ce,viewCluster:re}=Le();n.useEffect(()=>{ue()},[E]);const ue=()=>{C(!1),S(!0),_.post(re,{clusterId:g},k()).then(e=>{var i,t,s,r,V,R,U,D;console.log("--4-- getting user data => ",(i=e==null?void 0:e.data)==null?void 0:i.data),(t=e==null?void 0:e.data)!=null&&t.status?(Y((r=(s=e==null?void 0:e.data)==null?void 0:s.data)==null?void 0:r.Cluster),Q((R=(V=e==null?void 0:e.data)==null?void 0:V.data)==null?void 0:R.Property),G((D=(U=e==null?void 0:e.data)==null?void 0:U.data)==null?void 0:D.Saf)):C(!0),S(!1)}).catch(e=>{console.log("--4-- getting user data error => ",e),C(!0),S(!1)})},oe=()=>{j.length>4&&v(!0);let e=d=="Holding"?de:ce,i=d=="Holding"?{holdingNo:j}:{safNo:j};console.log("search key before search => ",j),j.length>4?_.post(e,i,k()).then(t=>{var s;console.log("search result => ",t),B((s=t==null?void 0:t.data)==null?void 0:s.data),v(!1)}).catch(t=>{console.log("search error -> ",t),N(!0,"Error occured while searching. Please try again later"),v(!1)}):w.error("You have not entered 5 digits !!!")},xe=[{Header:"S.No.",Cell:({row:e})=>l.jsx("div",{children:(e==null?void 0:e.index)+1})},{Header:"Ward No.",accessor:"wardId",Cell:e=>{if((e==null?void 0:e.value)==null||(e==null?void 0:e.value)==""||(e==null?void 0:e.value)==null)return l.jsx("div",{className:"w-full flex flex-row items-center",children:l.jsx("i",{className:"font-semibold ",children:"N/A"})});if((e==null?void 0:e.value)!=null)return e==null?void 0:e.value}},{Header:`${d} No.`,accessor:d=="Holding"?"holding_no":"saf_no",Cell:e=>{if((e==null?void 0:e.value)==null||(e==null?void 0:e.value)==""||(e==null?void 0:e.value)==null)return l.jsx("div",{className:"w-full flex flex-row justify-center items-center",children:l.jsx("i",{className:"font-semibold ",children:"N/A"})});if((e==null?void 0:e.value)!=null)return e==null?void 0:e.value}},{Header:"Name",accessor:"ownerName",Cell:e=>{if((e==null?void 0:e.value)==null||(e==null?void 0:e.value)==""||(e==null?void 0:e.value)==null)return l.jsx("div",{className:"w-full flex flex-row justify-center items-center",children:l.jsx("i",{className:"font-semibold ",children:"N/A"})});if((e==null?void 0:e.value)!=null)return e==null?void 0:e.value}},{Header:"Mobile No.",accessor:"mobileNo",Cell:e=>{if((e==null?void 0:e.value)==null||(e==null?void 0:e.value)==""||(e==null?void 0:e.value)==null)return l.jsx("div",{className:"w-full flex flex-row justify-center items-center",children:l.jsx("i",{className:"font-semibold ",children:"N/A"})});if((e==null?void 0:e.value)!=null)return e==null?void 0:e.value}},{Header:"Address",accessor:"address",Cell:e=>{if((e==null?void 0:e.value)==null||(e==null?void 0:e.value)==""||(e==null?void 0:e.value)==null)return l.jsx("div",{className:"w-full flex flex-row justify-center items-center",children:l.jsx("i",{className:"font-semibold ",children:"N/A"})});if((e==null?void 0:e.value)!=null)return e==null?void 0:e.value}},{Header:"Property Type",accessor:"propertyType",Cell:e=>{if((e==null?void 0:e.value)==null||(e==null?void 0:e.value)==""||(e==null?void 0:e.value)==null)return l.jsx("div",{className:"w-full flex flex-row justify-center items-center",children:l.jsx("i",{className:"font-semibold ",children:"N/A"})});if((e==null?void 0:e.value)!=null)return e==null?void 0:e.value}},{Header:"Action",Cell:({row:e})=>l.jsx(l.Fragment,{children:l.jsx("div",{className:"space-x-2",children:l.jsx("button",{className:"bg-indigo-500 hover:bg-indigo-600 text-white rounded-md text-xs font-semibold py-1 px-2",onClick:()=>me(e==null?void 0:e.index),children:"Select"})})})}],I=[{Header:"S.No.",Cell:({row:e})=>l.jsx("div",{children:(e==null?void 0:e.index)+1})},{Header:`${o} No.`,accessor:o=="Holding"?"holdingNo":"saf_no",Cell:e=>{if((e==null?void 0:e.value)==null||(e==null?void 0:e.value)==""||(e==null?void 0:e.value)==null)return l.jsx("div",{className:"w-full flex flex-row justify-center items-center",children:l.jsx("i",{className:"font-semibold ",children:"N/A"})});if((e==null?void 0:e.value)!=null)return e==null?void 0:e.value}},{Header:"Name",accessor:"ownername",Cell:e=>{if((e==null?void 0:e.value)==null||(e==null?void 0:e.value)==""||(e==null?void 0:e.value)==null)return l.jsx("div",{className:"w-full flex flex-row justify-center items-center",children:l.jsx("i",{className:"font-semibold ",children:"N/A"})});if((e==null?void 0:e.value)!=null)return e==null?void 0:e.value}},{Header:"Mobile No.",accessor:"mobileno",Cell:e=>{if((e==null?void 0:e.value)==null||(e==null?void 0:e.value)==""||(e==null?void 0:e.value)==null)return l.jsx("div",{className:"w-full flex flex-row justify-center items-center",children:l.jsx("i",{className:"font-semibold ",children:"N/A"})});if((e==null?void 0:e.value)!=null)return e==null?void 0:e.value}},{Header:"Property Type",accessor:"propertyType",Cell:e=>{if((e==null?void 0:e.value)==null||(e==null?void 0:e.value)==""||(e==null?void 0:e.value)==null)return l.jsx("div",{className:"w-full flex flex-row justify-center items-center",children:l.jsx("i",{className:"font-semibold ",children:"N/A"})});if((e==null?void 0:e.value)!=null)return e==null?void 0:e.value}},{Header:"Address",accessor:"address",Cell:e=>{if((e==null?void 0:e.value)==null||(e==null?void 0:e.value)==""||(e==null?void 0:e.value)==null)return l.jsx("div",{className:"w-full flex flex-row justify-center items-center",children:l.jsx("i",{className:"font-semibold ",children:"N/A"})});if((e==null?void 0:e.value)!=null)return e==null?void 0:e.value}}],me=e=>{d=="Holding"?fe(e):he(e)},fe=e=>{var i,t;h.includes((i=u[e])==null?void 0:i.holding_no)==!1&&b(s=>{var r;return[...s,(r=u[e])==null?void 0:r.holding_no]}),h.includes((t=u[e])==null?void 0:t.holding_no)&&w.error("Duplicate not allowed !!!")},he=e=>{var i,t;h.includes((i=u[e])==null?void 0:i.saf_no)==!1&&b(s=>{var r;return[...s,(r=u[e])==null?void 0:r.saf_no]}),h.includes((t=u[e])==null?void 0:t.saf_no)&&w.error("Duplicate not allowed !!!")},ve=e=>{b(i=>i.filter((t,s)=>s!==e))},ge=()=>{v(!0);let e=d=="Holding"?ne:se,i=d=="Holding"?{clusterId:g,holdingNo:[...new Set(h)]}:{clusterId:g,safNo:[...new Set(h)]};console.log("before mapping data  => ",i),_.post(e,i,k()).then(t=>{var s,r;((s=t==null?void 0:t.data)==null?void 0:s.status)==!0&&(console.log("mapping success => ",t),w.success("Mapping successfull !!!"),H(),J(E+1)),((r=t==null?void 0:t.data)==null?void 0:r.status)==!1&&(console.log("mapping error => ",t),N(!0,`Check out some ${d} no. already mapped or selected !!!`)),v(!1)}).catch(t=>{console.log("mapping error => ",t),v(!1),N(!0,"Error occured while mapping. Please try again later")})},N=(e,i)=>{ae(i),ee(e)};return X?l.jsx(l.Fragment,{children:l.jsx(ye,{})}):le?l.jsx(Se,{children:l.jsx(Ce,{title:"Server is busy",desc:"Server is too busy to respond. Please try again later.",buttonText:"View Dashboard",buttonUrl:"/propertyDashboard"})}):l.jsxs(l.Fragment,{children:[Z&&l.jsx(W,{}),p&&l.jsx(ke,{activateBottomErrorCard:N,errorTitle:te}),l.jsxs("div",{className:"flex  flex-col w-full text-zinc-800 h-[100vh] overflow-y-auto",children:[l.jsxs("div",{children:[l.jsx("div",{className:"flex flex-wrap justify-between",children:l.jsxs("div",{className:"flex items-center space-x-2 ",children:[l.jsx("span",{className:"font-extrabold",children:l.jsx(M,{})}),l.jsx("span",{className:"font-bold",children:"Basic Details"})]})}),l.jsxs("div",{className:"bg-white rounded-md shadow-lg w-full px-4 py-2.5 pb-4 mt-4 flex flex-wrap flex-row space-y-4",children:[l.jsxs("div",{className:"flex flex-col-reverse poppins space-y-1 w-[15rem]",children:[l.jsx("div",{className:"text-xs",children:"Old Ward No."}),l.jsx("div",{className:"text-sm font-semibold",children:x(a==null?void 0:a.ward_no)})]}),l.jsxs("div",{className:"flex flex-col-reverse poppins space-y-1 w-[15rem]",children:[l.jsx("div",{className:"text-xs",children:"New Ward No."}),l.jsx("div",{className:"text-sm font-semibold",children:x(a==null?void 0:a.new_ward_no)})]}),l.jsxs("div",{className:"flex flex-col-reverse poppins space-y-1 w-[15rem]",children:[l.jsx("div",{className:"text-xs",children:"Name"}),l.jsx("div",{className:"text-sm font-semibold",children:x(a==null?void 0:a.cluster_name)})]}),l.jsxs("div",{className:"flex flex-col-reverse poppins space-y-1 w-[15rem]",children:[l.jsx("div",{className:"text-xs",children:"Type"}),l.jsx("div",{className:"text-sm font-semibold",children:x(a==null?void 0:a.cluster_type)})]}),l.jsxs("div",{className:"flex flex-col-reverse poppins space-y-1 w-[15rem]",children:[l.jsx("div",{className:"text-xs",children:"Address"}),l.jsx("div",{className:"text-sm font-semibold",children:x(a==null?void 0:a.address)})]}),l.jsxs("div",{className:"flex flex-col-reverse poppins space-y-1 w-[15rem]",children:[l.jsx("div",{className:"text-xs",children:"Mobile No."}),l.jsx("div",{className:"text-sm font-semibold",children:x(a==null?void 0:a.mobile_no)})]}),l.jsxs("div",{className:"flex flex-col-reverse poppins space-y-1 w-[15rem]",children:[l.jsx("div",{className:"text-xs",children:"Authorized Person Name"}),l.jsx("div",{className:"text-sm font-semibold",children:x(a==null?void 0:a.authorized_person_name)})]}),l.jsxs("div",{className:"flex flex-col-reverse poppins space-y-1 w-[15rem]",children:[l.jsx("div",{className:"text-xs",children:"Created At"}),l.jsx("div",{className:"text-sm font-semibold",children:x(new Date(a==null?void 0:a.created_at).toLocaleDateString("en-GB"))})]})]})]}),l.jsxs("div",{className:"relative bg-white p-4 mt-8",children:[l.jsxs("div",{className:"flex flex-row flex-wrap justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-2 sm:mb-0",children:[l.jsxs("div",{className:(o=="SAF"?"border-2 border-indigo-600 shadow-indigo-400":"border-none")+" shadow-md rounded-md flex items-center space-x-2 px-4 py-2 cursor-pointer text-sm",onClick:()=>T("SAF"),children:[l.jsx("span",{className:"font-extrabold",children:l.jsx(M,{})}),l.jsx("span",{className:"font-semibold",children:"Mapped SAF List"})]}),l.jsxs("div",{className:(o=="Holding"?"border-2 border-indigo-600 shadow-indigo-400":"border-none")+" shadow-md rounded-md flex items-center space-x-2 px-4 py-2 cursor-pointer text-sm",onClick:()=>T("Holding"),children:[l.jsx("span",{className:"font-extrabold",children:l.jsx(M,{})}),l.jsx("span",{className:"font-semibold",children:"Mapped Holding List"})]})]}),o=="SAF"&&l.jsxs("div",{className:"flex items-center space-x-2 ",children:[l.jsx("div",{className:z,onClick:()=>O("SAF"),children:"Add SAF"}),(m==null?void 0:m.length)>0&&l.jsx("div",{onClick:()=>A(`/viewDemandCluster/${g}`),className:F,children:"View SAF Demand"})]}),o=="Holding"&&l.jsxs("div",{className:"flex items-center space-x-2 ",children:[l.jsx("div",{className:z,onClick:()=>O("Holding"),children:"Add Holding"}),(f==null?void 0:f.length)>0&&l.jsxs(l.Fragment,{children:[l.jsx("div",{onClick:()=>A(`/cluster-holding-transactions/${g}`),className:F,children:"View Payment History"}),l.jsx("div",{onClick:()=>A(`/viewDemandHoldingPropertyCluster/${g}`),className:F,children:"View Property Demand"})]})]})]}),l.jsx("div",{className:"mt-4",children:!y&&l.jsxs(l.Fragment,{children:[o=="Holding"&&l.jsx(l.Fragment,{children:(f==null?void 0:f.length)>0?l.jsx(L,{columns:I,dataList:f}):l.jsx("div",{className:"text-red-500 poppins font-semibold text-lg w-full text-center py-4",children:"No mapped holding available"})}),o=="SAF"&&l.jsx(l.Fragment,{children:(m==null?void 0:m.length)>0?l.jsx(L,{columns:I,dataList:m}):l.jsx("div",{className:"text-red-500 poppins font-semibold text-lg w-full text-center py-4",children:"No mapped SAF available"})})]})})]})]}),l.jsx(Ae,{isOpen:$,onAfterOpen:ie,onRequestClose:H,className:"z-20 h-screen w-screen backdrop-blur-sm flex flex-row justify-center items-center overflow-auto",contentLabel:"Example Modal",children:l.jsxs("div",{class:" rounded-lg shadow-lg shadow-indigo-300 md:w-[73%] h-[80vh] w-full relative bg-gray-50 px-6 py-4  border-t-2 border-l-2 overflow-auto",children:[y&&l.jsx(W,{}),l.jsx("div",{className:"absolute top-2 z-10 bg-red-200 hover:bg-red-300 right-2 rounded-full p-2 cursor-pointer",onClick:H,children:l.jsx(_e,{fontSize:10})}),l.jsxs("h1",{className:"mb-2 mx-6 font-serif font-semibold  text-gray-600 text-lg",children:[l.jsx(He,{className:"inline mr-2"}),"Add ",d]}),l.jsxs("div",{className:"bg-white w-full px-4 py-6 rounded-md shadow-md mt-4 flex flex-row flex-wrap gap-y-2 justify-start gap-x-6 items-center",children:[l.jsxs("label",{htmlFor:"search",className:"poppins 2xl:text-md text-sm",children:["Enter atleast last 5 digits of ",d," number : "]}),l.jsx("input",{type:"text",name:"search",id:"search",className:"px-3 py-1.5 text-sm font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none shadow-md",onChange:e=>q(e.target.value)}),l.jsx("button",{className:"md:mt-1.5 px-6 py-1.5 cursor-pointer w-max bg-green-500 text-white font-medium text-xs leading-tight  rounded shadow-md hover:bg-green-700 hover:shadow-lg focus:bg-green-060 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-green-800 active:shadow-lg transition duration-150 ease-in-out tracking-wide",onClick:()=>oe(),children:"Search"})]}),l.jsx("div",{className:"bg-white w-[100%] p-4 rounded-md shadow-md mt-4 flex flex-row flex-wrap gap-y-2 justify-start gap-x-6 items-center poppins",children:(u==null?void 0:u.length)==0?l.jsxs("div",{className:"text-red-500 font-semibold text-md 2xl:text-lg w-full text-center py-4 poppins",children:["No any ",d," found !!!"]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:" w-full flex flex-col md:flex-row md:items-center gap-2 border-b-2 border-gray-500 pb-2 mb-2",children:[l.jsxs("div",{className:"full text-sm md:w-[20%] w-full",children:["Selected ",d,"   :     "]}),l.jsxs("div",{className:"w-full md:w-[80%]",children:[l.jsx("div",{className:"flex flex-row flex-wrap gap-x-2 gap-y-1  px-3 py-1.5 text-sm font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none cursor-pointer shadow-md",children:[...new Set(h)].map((e,i)=>l.jsx("div",{className:"w-max",children:l.jsxs("span",{className:"bg-indigo-100 text-gray-800 flex flex-row items-cente poppins text-xs px-2 py-1.5 rounded-md font-semibold",children:[e," ",l.jsx(Fe,{className:"inline text-red-600 font-semibold text-sm cursor-pointer hover:text-red-700",onClick:()=>ve(i)})]})}))}),!y&&l.jsxs("button",{className:"md:mt-1.5 px-6 py-1.5 cursor-pointer w-max bg-green-500 text-white font-medium text-xs leading-tight  rounded shadow-md hover:bg-green-700 hover:shadow-lg focus:bg-green-060 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-green-800 active:shadow-lg transition duration-150 ease-in-out",onClick:()=>ge(),children:["Map ",d]})]})]}),l.jsx("div",{className:"w-full",children:l.jsx(L,{columns:xe,dataList:u})})]})})]})}),l.jsx("div",{className:"h-[20vh]"})]})},Ie=Object.freeze(Object.defineProperty({__proto__:null,default:Me},Symbol.toStringTag,{value:"Module"}));export{Le as C,Me as a,Ie as b};
