import{R as B,u as W,c as G,Q as m,b as t,F as Q,j as e}from"./index-ace27d6f.js";import{u as H}from"./formik.esm-70d5e597.js";import{c as J,a as o,b as K}from"./index.esm-70f5a44d.js";import{F as X,a as Y,T as u}from"./LoadingButton-c50b942f.js";import{u as Z}from"./useCustomGeoLocation-295d1e12.js";import{r as k}from"./resizeImage-f1558408.js";import{w as I}from"./waterAndSepticTanker-049fa680.js";import{b as D,a as ee}from"./useCustomQuery-48e25bd8.js";import{O as ae}from"./OverLayLoader-67ca2fbe.js";import"./Hourglass-eaf35b74.js";import{C as te}from"./CreateConfirmation-ee58d71e.js";import"./ThemeStyle-994f51bc.js";import"./index.esm-2d99ca62.js";import"./ApiHeader2-b363f7b8.js";function fe(){var h,g,f,v,N,y,w,b,F,C,V,L,R,S,T,q,A,_,j,z;const[x,U]=B.useState(null),$=W(),p=D({}),{coords:i}=Z(),{id:n}=G(),a=ee({api:I.bookingDetails,config:{applicationId:n},options:{enabled:!!n}}),l=H({enableReinitialize:!0,initialValues:{applicationId:n,status:1,comments:"",latitude:"",longitude:"",document:null},validationSchema:J({comments:o().required("Required").min(10,"Minimum 10 characters").max(100,"Maximum 100 characters"),latitude:o().required("Required"),longitude:o().required("Required"),document:K().required("Required").test("fileSize","File Size is too large",d=>d&&d.size<=2e6)}),onSubmit:async(d,{resetForm:c})=>{await te(l.values.status===1?"Are you sure you want to cancel trip?":"Are you sure you want to successful trip?")&&await M(d,c)}}),M=async(d,c)=>{var r,E,P;try{const s=await p.mutateAsync({api:I.submitDriverAction,data:d});(r=s==null?void 0:s.data)!=null&&r.status?(m.success((E=s==null?void 0:s.data)==null?void 0:E.message),$("/dashboard",{replace:!0}),c()):m.error((P=s==null?void 0:s.data)==null?void 0:P.message)}catch{m.error("Something went wrong")}},O=async d=>{let c=d.target.files[0];const r=await k(c);r?(U(URL.createObjectURL(r)),l.setFieldValue("document",r),l.setFieldValue("latitude",i==null?void 0:i.latitude),l.setFieldValue("longitude",i==null?void 0:i.longitude)):(l.setFieldValue("document",null),l.setFieldValue("latitude",""),l.setFieldValue("longitude",""))};return t(Q,{children:[p.isLoading&&e(ae,{}),t("div",{className:"p-4",children:[t("div",{className:" bg-white w-full relative rounded-lg pb-2 mb-4 cursor-pointer shadow-lg",children:[e("div",{className:"font-semibold bg-[#838FCE] px-4 py-2 text-white rounded-t-lg text-sm",children:"Water Tanker Details"}),e("div",{className:"w-full rounded-lg p-4 space-b-2",children:t("div",{className:"flex flex-row flex-wrap gap-x-4 gap-y-2 w-full",children:[t("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Booking No."}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:(g=(h=a==null?void 0:a.data)==null?void 0:h.data)==null?void 0:g.booking_no})]}),t("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Applicant Name"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:(v=(f=a==null?void 0:a.data)==null?void 0:f.data)==null?void 0:v.applicant_name})]}),t("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Delivery Address"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:(y=(N=a==null?void 0:a.data)==null?void 0:N.data)==null?void 0:y.address})]}),t("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Contact Number"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:(b=(w=a==null?void 0:a.data)==null?void 0:w.data)==null?void 0:b.mobile})]}),t("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600 no-underline",children:"Water Tanker Capacity"}),t("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:[(C=(F=a==null?void 0:a.data)==null?void 0:F.data)==null?void 0:C.capacity," Ltr"]})]}),t("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Booking Date"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:(L=(V=a==null?void 0:a.data)==null?void 0:V.data)==null?void 0:L.booking_date})]}),e("hr",{className:"w-full border-b-1 border-gray-200"}),t("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6  text-xs text-gray-600",children:"Assigned Date"}),e("div",{className:"col-span-6 font-semibold  text-gray-700 2xl:text-base text-xs",children:(S=(R=a==null?void 0:a.data)==null?void 0:R.data)==null?void 0:S.assign_date})]}),t("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6  text-xs text-gray-600",children:"Vehicle No."}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:(q=(T=a==null?void 0:a.data)==null?void 0:T.data)==null?void 0:q.vehicle_no})]}),t("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6  text-xs text-gray-600",children:"Delivery Date"}),t("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:[(_=(A=a==null?void 0:a.data)==null?void 0:A.data)==null?void 0:_.delivery_date," ",(z=(j=a==null?void 0:a.data)==null?void 0:j.data)==null?void 0:z.delivery_time]})]})]})})]}),e("p",{className:"border-b"}),e("div",{className:"bg-white py-8  rounded-lg shadow-xl p-4 mt-3",children:e(X,{formik:l,children:t("div",{className:"space-y-5 ",children:[e("div",{className:"flex-1",children:e(Y,{label:"comments",name:"comments",placeholder:"Enter comments",formik:l})}),t("div",{className:"flex w-full gap-4",children:[e(u,{disabled:!0,label:"Latitude",name:"latitude",placeholder:"Enter Latitude",formik:l}),e(u,{disabled:!0,label:"Longitude",name:"longitude",placeholder:"Enter Longitude",formik:l})]}),e("div",{className:"flex-1"}),t("div",{className:"flex-1",children:[e(u,{label:"Upload document",name:"document",onChange:O,type:"file",placeholder:"Upload document"}),e("span",{className:"text-red-600 absolute text-xs",children:l.touched.document&&l.errors.document?l.errors.document:null})]}),x&&e("div",{className:"flex justify-center",children:e("img",{src:x,alt:"image",className:""})}),t("div",{className:"flex py-2 justify-between mt-8",children:[e("button",{type:"button",onClick:()=>{l.setFieldValue("status",1),l.handleSubmit()},className:"bg-red-500 text-white rounded-lg px-4 py-1.5 text-sm",children:"Cancel Trip"}),e("button",{type:"button",onClick:()=>{l.setFieldValue("status",2),l.handleSubmit()},className:"bg-[#838FCE] text-white rounded-lg px-4 py-1.5 text-sm",children:"Successful Trip"})]})]})})})]})]})}export{fe as default};
