import{r as i,c as M,b as r,F as D,j as e,a as f}from"./index-0e94f450.js";import{C as F}from"./ConsumerButtons-843a123c.js";import{h as _}from"./moment-db06c914.js";import{W as U}from"./WaterApiList-dfcbb003.js";import{u as I}from"./formik.esm-3041fe88.js";import{c as k,e as C,a as E}from"./index.esm-53d0ef34.js";import{F as j}from"./LoadingButton-41bf7b10.js";import"./ThemeStyle-994f51bc.js";import"./index.esm-7ab12b54.js";const V=()=>{var d,m,c,p,x,g,u;const[t,h]=i.useState();i.useState();const{id:o}=M(),{api_waterListDemand:N,api_waterGenerateDemand:y,header:n}=U(),v=()=>{f.post(N,{ConsumerId:o},n).then(s=>{h(s.data.data)}).catch(s=>{})};i.useEffect(()=>{v()},[o]);const w=s=>{const l=new FormData;l.append("consumerId",o),l.append("demandUpto",s.demandUpto),l.append("finalRading",s.meterReading),l.append("document",s.meterImage),f.post(y,l,n).then(b=>{b.data.status&&setRefetchData(R=>R+1)}).catch(b=>{})};k({meterReading:C().required("Enter Meter Reading").min(((d=t==null?void 0:t.meterDetails)==null?void 0:d.final_meter_reading)+1,`Reading must be greater previous ${(m=t==null?void 0:t.meterDetails)==null?void 0:m.final_meter_reading}`),demandUpto:E().required("Select Upto Data")});const a=I({enableReinitialize:!0,initialValues:{demandUpto:"",meterReading:"",meterImage:null},onSubmit:async(s,{resetForm:l})=>{await w(s)}});return r(D,{children:[e(F,{active:"meter"}),r("h1",{className:"px-1 mt-3 text-center font-semibold text-gray-700",children:[" ","Meter/Fixed Connection Details"]}),e("p",{className:"border-b border-gray-700 mx-5"}),r("div",{className:"py-6 mt-2 m-2 bg-white rounded-lg shadow-xl p-4 space-y-5",children:[r("div",{className:"flex space-x-5 pl-4 ",children:[r("div",{className:"flex-1",children:[e("div",{className:"font-semibold text-sm",children:(c=t==null?void 0:t.meterDetails)==null?void 0:c.connectionName}),e("div",{className:"text-gray-500 text-xs",children:"Connection Type"})]}),r("div",{className:"flex-1",children:[e("div",{className:"font-bold text-sm",children:(p=t==null?void 0:t.meterDetails)==null?void 0:p.meter_no}),e("div",{className:"text-gray-500 text-xs",children:"Meter No."})]})]}),r("div",{className:"flex space-x-5 pl-4 ",children:[r("div",{className:"flex-1",children:[e("div",{className:"font-bold text-sm",children:(x=t==null?void 0:t.meterDetails)!=null&&x.final_meter_reading?(g=t==null?void 0:t.meterDetails)==null?void 0:g.final_meter_reading:"N/A"}),e("div",{className:"text-gray-500 text-xs",children:"Last Meter Reading"})]}),r("div",{className:"flex-1",children:[r("div",{className:"font-semibold text-md",children:[_((u=t==null?void 0:t.meterDetails)==null?void 0:u.connection_date,"YYYY-MM-DD").format("DD-MMM-yy")," "]}),e("div",{className:"text-gray-500 text-xs",children:"Meter Connection Date"})]})]})]}),e("p",{className:"border-b"}),e("div",{className:"py-2 bg-white rounded-lg shadow-xl p-4",children:r(j,{formik:a,children:[r("div",{className:"space-y-5 ",children:[e("div",{className:"flex-1",children:r("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[r("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:["Upload Meter Image"," ",e("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]}),e("input",{onChange:s=>a.setFieldValue("meterImage",s.target.files[0]),name:"meterImage",type:"file",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md cursor-pointer",placeholder:"Enter Meter Reading"}),e("span",{className:"text-red-600 absolute text-xs",children:a.touched.meterImage&&a.errors.meterImage?a.errors.meterImage:null})]})}),e("div",{className:"flex-1",children:r("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[r("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:["Final Meter Reading"," ",e("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]}),e("input",{...a.getFieldProps("meterReading"),type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md cursor-pointer",placeholder:"Enter Meter Reading"}),e("span",{className:"text-red-600 absolute text-xs",children:a.touched.meterReading&&a.errors.meterReading?a.errors.meterReading:null})]})}),e("div",{className:"flex-1",children:r("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[r("label",{className:"form-label inline-block mb-1 text-gray-900 text-sm font-semibold",children:["Demand Upto Date"," ",e("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]}),e("input",{...a.getFieldProps("demandUpto"),type:"date",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md cursor-pointer"}),e("span",{className:"text-red-600 absolute text-xs",children:a.touched.demandUpto&&a.errors.demandUpto?a.errors.demandUpto:null})]})})]}),e("div",{className:"flex justify-center",children:e("button",{type:"submit",className:"bg-indigo-700 px-6 py-2 text-sm text-white rounded",children:"Generate Demand"})})]})})]})};export{V as default};
