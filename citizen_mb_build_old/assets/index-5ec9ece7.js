import{R as U,u as $,c as M,Q as o,b as l,F as O,j as e}from"./index-0e94f450.js";import{u as B}from"./formik.esm-3041fe88.js";import{c as G,a as m,b as Q}from"./index.esm-53d0ef34.js";import{F as W,a as H,T as u}from"./LoadingButton-41bf7b10.js";import{u as J}from"./useCustomGeoLocation-12657b0e.js";import{r as K}from"./resizeImage-f1558408.js";import{s as _}from"./waterAndSepticTanker-049fa680.js";import{b as X,a as Y}from"./useCustomQuery-b7ab1a67.js";import{O as Z}from"./OverLayLoader-ee91cbb3.js";import"./Hourglass-60182635.js";import{C as k}from"./CreateConfirmation-8845d417.js";import"./ThemeStyle-994f51bc.js";import"./index.esm-7ab12b54.js";import"./ApiHeader2-b363f7b8.js";function xe(){var g,h,f,N,v,b,w,y,F,C,V,L,R,S,T,q;const[x,z]=U.useState(null),E=$(),p=X({}),{coords:i}=J(),{id:n}=M(),a=Y({api:_.bookingDetails,config:{applicationId:n},options:{enabled:!!n}}),t=B({enableReinitialize:!0,initialValues:{applicationId:n,status:1,comments:"",latitude:"",longitude:"",document:null},validationSchema:G({comments:m().required("Required").min(10,"Minimum 10 characters").max(100,"Maximum 100 characters"),latitude:m().required("Required"),longitude:m().required("Required"),document:Q().required("Required").test("fileSize","File Size is too large",d=>d&&d.size<=2e6)}),onSubmit:async(d,{resetForm:c})=>{await k(t.values.status===1?"Are you sure you want to cancel trip?":"Are you sure you want to successful trip?")&&await P(d,c)}}),P=async(d,c)=>{var r,A,j;try{const s=await p.mutateAsync({api:_.submitDriverAction,data:d});(r=s==null?void 0:s.data)!=null&&r.status?(o.success((A=s==null?void 0:s.data)==null?void 0:A.message),E("/dashboard",{replace:!0}),c()):o.error((j=s==null?void 0:s.data)==null?void 0:j.message)}catch{o.error("Something went wrong")}},I=async d=>{let c=d.target.files[0];const r=await K(c);r?(z(URL.createObjectURL(r)),t.setFieldValue("document",r),t.setFieldValue("latitude",i==null?void 0:i.latitude),t.setFieldValue("longitude",i==null?void 0:i.longitude)):(t.setFieldValue("document",null),t.setFieldValue("latitude",""),t.setFieldValue("longitude",""))};return l(O,{children:[p.isLoading&&e(Z,{}),l("div",{className:"p-4",children:[l("div",{className:" bg-white w-full relative rounded-lg pb-2 mb-4 cursor-pointer shadow-lg",children:[e("div",{className:"font-semibold bg-[#838FCE] px-4 py-2 text-white rounded-t-lg text-sm",children:"Cancel Trip For Water Tanker"}),e("div",{className:"w-full rounded-lg p-4 space-b-2",children:l("div",{className:"flex flex-row flex-wrap gap-x-4 gap-y-2 w-full",children:[l("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Booking No."}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:(h=(g=a==null?void 0:a.data)==null?void 0:g.data)==null?void 0:h.booking_no})]}),l("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Applicant Name"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:(N=(f=a==null?void 0:a.data)==null?void 0:f.data)==null?void 0:N.applicant_name})]}),l("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Address"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:(b=(v=a==null?void 0:a.data)==null?void 0:v.data)==null?void 0:b.address})]}),l("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Contact Number"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:(y=(w=a==null?void 0:a.data)==null?void 0:w.data)==null?void 0:y.mobile})]}),l("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Booking Date"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:(C=(F=a==null?void 0:a.data)==null?void 0:F.data)==null?void 0:C.booking_date})]}),e("hr",{className:"w-full border-b-1 border-gray-200"}),l("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6  text-xs text-gray-600",children:"Assigned Date"}),e("div",{className:"col-span-6 font-semibold  text-gray-700 2xl:text-base text-xs",children:(L=(V=a==null?void 0:a.data)==null?void 0:V.data)==null?void 0:L.assign_date})]}),l("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6  text-xs text-gray-600",children:"Vehicle No."}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:(S=(R=a==null?void 0:a.data)==null?void 0:R.data)==null?void 0:S.vehicle_no})]}),l("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6  text-xs text-gray-600",children:"Cleaning Date"}),l("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:[(q=(T=a==null?void 0:a.data)==null?void 0:T.data)==null?void 0:q.cleaning_date," "]})]})]})})]}),e("p",{className:"border-b"}),e("div",{className:"bg-white py-8  rounded-lg shadow-xl p-4 mt-3",children:e(W,{formik:t,children:l("div",{className:"space-y-5 ",children:[e("div",{className:"flex-1",children:e(H,{label:"comments",name:"comments",placeholder:"Enter comments",formik:t})}),l("div",{className:"flex w-full gap-4",children:[e(u,{disabled:!0,label:"Latitude",name:"latitude",placeholder:"Enter Latitude",formik:t}),e(u,{disabled:!0,label:"Longitude",name:"longitude",placeholder:"Enter Longitude",formik:t})]}),e("div",{className:"flex-1"}),l("div",{className:"flex-1",children:[e(u,{label:"Upload document",name:"document",onChange:I,type:"file",placeholder:"Upload document"}),e("span",{className:"text-red-600 absolute text-xs",children:t.touched.document&&t.errors.document?t.errors.document:null})]}),x&&e("div",{className:"flex justify-center",children:e("img",{src:x,alt:"image",className:""})}),l("div",{className:"flex py-2 justify-between mt-8",children:[e("button",{type:"button",onClick:()=>{t.setFieldValue("status",1),t.handleSubmit()},className:"bg-red-500 text-white rounded-lg px-4 py-1.5 text-sm",children:"Cancel Trip"}),e("button",{type:"button",onClick:()=>{t.setFieldValue("status",2),t.handleSubmit()},className:"bg-[#838FCE] text-white rounded-lg px-4 py-1.5 text-sm",children:"Successful Trip"})]})]})})})]})]})}export{xe as default};
