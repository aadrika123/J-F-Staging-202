import{e as O,r as f,u as F,j as e,b as t,M as W,c as X,d as Z,A as D,F as J,Q as N}from"./index-0e94f450.js";import{T as K}from"./ThemeStyle-994f51bc.js";import{u as L}from"./formik.esm-3041fe88.js";import{c as ee,a as _}from"./index.esm-53d0ef34.js";import{n as y}from"./PowerupFunctions-a7eaa30f.js";import{R as ae}from"./RentalApiList-8b960fdc.js";import{B as te}from"./index.esm-6292bc0f.js";import{u as se,a as re}from"./useCustomQuery-b7ab1a67.js";import{C as ne}from"./CreateConfirmation-8845d417.js";import{O as oe}from"./OverLayLoader-ee91cbb3.js";import{R as de}from"./RotatingLoader-1527129a.js";import"./ApiHeader2-b363f7b8.js";import"./Hourglass-60182635.js";var $={},ce=O&&O.__awaiter||function(r,c,m,i){function x(s){return s instanceof m?s:new m(function(u){u(s)})}return new(m||(m=Promise))(function(s,u){function v(l){try{h(i.next(l))}catch(a){u(a)}}function b(l){try{h(i.throw(l))}catch(a){u(a)}}function h(l){l.done?s(l.value):x(l.value).then(v,b)}h((i=i.apply(r,c||[])).next())})};Object.defineProperty($,"__esModule",{value:!0});const w=f;class ie{constructor(c){this.options=c,typeof window<"u"&&(this.rzrpayInstannce=new window.Razorpay(this.options))}on(c,m){this.rzrpayInstannce.on(c,m)}open(){this.rzrpayInstannce.open()}}const le=()=>{const r="https://checkout.razorpay.com/v1/checkout.js",c=(0,w.useMemo)(()=>typeof window<"u",[]),[m,i]=(0,w.useState)(!1),x=(0,w.useCallback)(()=>!(!c||!("Razorpay"in window)),[]),s=(0,w.useCallback)(u=>{if(c)return new Promise((v,b)=>{const h=document.createElement("script");h.src=u,h.onload=l=>{i(!0),v(l)},h.onerror=l=>b(l),document.body.appendChild(h)})},[]);return(0,w.useEffect)(()=>{x()||ce(void 0,void 0,void 0,function*(){try{yield s(r)}catch(u){throw new Error(u)}})},[]),[ie,m]};var pe=$.default=le;function me(){const[r]=pe();return{handleRzpPayment:f.useCallback(async m=>{const i={key:"rzp_test_NXHWEn0nSMDcnm",amount:"2000",currency:"INR",name:"Acme Corp",order_id:"order_DaaS6LOUAASb7Y",description:"Test Transaction",image:"https://example.com/your_logo",handler:function(s){alert(s.razorpay_payment_id)},prefill:{name:"Piyush Garg",email:"youremail@example.com",contact:"9999999999"},notes:{address:"Razorpay Corporate Office"},theme:{color:"#3399cc"}},x=new r(i);return x.open(),x},[r])}}function ue({tollPaymentListData:r}){var m,i,x;const c=F();return r!=null&&r.isLoading?e("div",{className:"w-full h-32    flex justify-center items-center ",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})}):r!=null&&r.error?e("div",{className:"w-full h-32    flex justify-center items-center ",children:t("div",{className:"text-red-500",children:["Error: ",(m=r==null?void 0:r.error)==null?void 0:m.message]})}):e("div",{className:"p-5",children:(x=(i=r==null?void 0:r.data)==null?void 0:i.data)==null?void 0:x.map((s,u)=>t("div",{className:"w-full relative rounded-lg pb-2 mb-4 cursor-pointer shadow-lg ",children:[e("div",{className:"font-semibold bg-[#838FCE] px-4 py-2 text-white rounded-t-lg text-sm",children:"Toll Payment Details"}),e("div",{className:"w-full rounded-lg p-4 space-b-2",children:t("div",{className:"flex flex-row flex-wrap gap-x-4 gap-y-2 w-full",children:[t("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Vendor Name."}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:s==null?void 0:s.vendor_name})]}),t("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Amount"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:s==null?void 0:s.amount})]}),t("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Payment Mode"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:s==null?void 0:s.pmt_mode})]}),t("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"From Date"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:s==null?void 0:s.from_date})]}),t("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"To Date"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:s==null?void 0:s.to_date})]})]})}),t("div",{onClick:()=>c(`/toll-payment-receipt/${s==null?void 0:s.id}`),className:"mb-2 mx-4 relative text-white px-2 2xl:px-4 py-[0.3rem] text-xs 2xl:text-sm md:absolute md:bottom-3 2xl:bottom-2 md:right-2 rounded-md bg-indigo-500 border-indigo-400 hover:border-indigo-600 hover:bg-indigo-600 hover:text-white shadow-sm  cursor-pointer poppins md:mt-0 w-max",children:["View Receipt",e(te,{className:"inline font-semibold text-xl"})]})]},u))})}W.setAppElement("#root");function ke(){var R,S,M;const r=F(),c=se({}),{handleRzpPayment:m}=me(),{id:i}=X(),{api_tollDetailsById:x,api_tollTcPayment:s,api_list_shop_demand:u}=ae(),{titleColor:v}=K(),b=(n,p)=>{N.dismiss(),p=="success"&&N.success(n),p=="error"&&N.error(n)},[h,l]=f.useState(!1),[a,q]=f.useState();f.useState("");const[xe,U]=f.useState(""),[B,V]=f.useState(""),[z,H]=f.useState("");f.useState(!1);const G=re({api:u,config:{tollId:i},options:{enabled:!!i}}),C=()=>{const n=new Date(B);return`${new Date(z).getDate()-n.getDate()+1}`},o=L({initialValues:{amount:"",fromDate:"",uptoDate:"",paymentMode:""},validationSchema:ee({fromDate:_().required("Required"),uptoDate:_().required("Required"),paymentMode:_().required("Required")}),onSubmit:async(n,{resetForm:p})=>{await ne("Are you sure you want to make payment?")&&await Y(n,p)}}),P=n=>{let p=n.target.name,g=n.target.value;p=="ddmmyy"&&U(g),p=="fromDate"&&V(g),p=="uptoDate"&&H(g)},Y=async(n,p)=>{var A,k,I,T,E,j;let g;if(g={tollId:i,dateFrom:n==null?void 0:n.fromDate,dateUpto:n==null?void 0:n.uptoDate,paymentMode:n==null?void 0:n.paymentMode},((A=o.values)==null?void 0:A.paymentMode)=="ONLINE"){alert("Under Development");const d={amount:`${a==null?void 0:a.rate}`*C(),order_id:"order_Ef",handler:fe=>{}};await m(d)}else{const d=await c.mutateAsync({api:s,data:g});(k=d==null?void 0:d.data)!=null&&k.status?(b(d==null?void 0:d.message,"success"),r(`/payment-response?response=${(T=(I=d==null?void 0:d.data)==null?void 0:I.data)==null?void 0:T.tollId}&module=toll&id=${(j=(E=d==null?void 0:d.data)==null?void 0:E.data)==null?void 0:j.tollId}`,{replace:!0}),p()):b(d==null?void 0:d.message,"error")}};f.useEffect(()=>{Q()},[]);const Q=()=>{l(!0);const n={tollId:i};Z.post(x,n,D()).then(p=>{p.data.status&&q(p.data.data),l(!1)}).catch(p=>{l(!1)})};return h?e(de,{}):t(J,{children:[(c==null?void 0:c.isLoading)&&e(oe,{}),t("div",{className:"bg-[#eff2f0]",children:[t("div",{className:"col-span-12",children:[" ",e("h1",{className:`font-semibold  ${v} text-xl px-4 py-2 text-gray-600`,children:"Toll Details"})]}),e("div",{className:" flex justify-center items-center  overflow-hidden p-4 ",children:t("div",{class:"  w-full md:w-1/3 rounded-lg bg-[#fdfdfd] shadow-indigo-50 shadow-md",children:[t("div",{className:"bg-[#6c68f0] rounded-lg p-4 text-white",children:[t("p",{class:"text-sm text-center font-semibold ",children:["Toll No. : ",e("span",{children:y(a==null?void 0:a.toll_no)})]}),e("p",{class:"text-center py-1",children:t("span",{class:"text-sm justify-center text-gray-50 flex",children:[e("span",{className:"",children:"Payable Amount : "}),z?t("p",{children:["Rs. ",`${a==null?void 0:a.rate}`*C()]}):t("h1",{children:["Rs. ",a==null?void 0:a.rate]})]})}),t("form",{onSubmit:o.handleSubmit,onChange:P,children:[t("div",{className:"space-x-2 py-1",children:[t("select",{name:"paymentMode",className:"p-1 text-gray-800 border border-gray-300 rounded-sm w-full",onChange:o.handleChange,value:o.values.paymentMode,children:[e("option",{value:"",children:"Select Payment Mode"}),e("option",{value:"CASH",children:"Cash"}),e("option",{value:"ONLINE",children:"Online"})]}),e("span",{className:"text-red-400 text-sm",children:o.touched.paymentMode&&o.errors.paymentMode})]}),t("div",{className:"flex space-x-2 py-1  ",children:[t("div",{className:"w-full",children:[e("p",{className:"capitalize text-xs",children:"date from"}),e("input",{type:"date",name:"fromDate",className:"px-2 text-gray-800 border border-gray-300 rounded-sm w-full",onChange:o.handleChange,value:o.values.fromDate,min:(M=(S=(R=a==null?void 0:a.payment_upto)==null?void 0:R.split("-"))==null?void 0:S.reverse())==null?void 0:M.join("-"),max:o.values.uptoDate}),e("span",{className:"text-red-400 text-sm",children:o.touched.fromDate&&o.errors.fromDate})]}),t("div",{className:"w-full",children:[e("p",{className:"capitalize text-xs",children:"date upto"}),e("input",{type:"date",disabled:!o.values.fromDate,name:"uptoDate",className:"px-2 text-gray-800 border border-gray-300 rounded-sm w-full",onChange:o.handleChange,value:o.values.uptoDate,min:o.values.fromDate}),e("span",{className:"text-red-400 text-sm",children:o.touched.uptoDate&&o.errors.uptoDate})]})]}),e("div",{className:"",children:e("button",{type:"submit",className:"bg-amber-500 mt-1 py-2 px-2 rounded-sm capitalize text-xs w-full ",children:"Pay Now"})})]})]}),e("div",{class:"bg-white shadow-lg rounded-lg  w-full mt-4",children:e("div",{children:t("ul",{children:[t("li",{className:"p-2 px-5 text-sm text-gray-600 font-semibold capitalize  border-b shadow-sm",children:["vendor Name :",e("span",{className:"px-4 text-sm text-gray-500 uppercase",children:y(a==null?void 0:a.vendor_name)})]}),t("li",{className:"p-2 px-5 text-sm text-gray-600 font-semibold capitalize border-b shadow-sm ",children:["Address :",e("span",{className:"px-4 text-sm text-gray-500 uppercase",children:y(a==null?void 0:a.address)})]}),t("li",{className:"p-2 px-5 text-sm text-gray-600 font-semibold capitalize  border-b shadow-sm",children:["Circle :",e("span",{className:"px-4 text-sm text-gray-500 uppercase",children:y(a==null?void 0:a.circle_name)})]}),t("li",{className:"p-2 px-5 text-sm text-gray-600 font-semibold capitalize border-b shadow-sm ",children:["market :",e("span",{className:"px-4 text-sm text-gray-500 uppercase",children:y(a==null?void 0:a.market_name)})]}),t("li",{className:"p-2 px-5 text-sm text-gray-600 font-semibold capitalize border-b shadow-sm ",children:["Rate :",e("span",{className:"px-4 text-sm text-gray-500 uppercase",children:y(a==null?void 0:a.rate)})]}),t("li",{className:"p-2 px-5 text-sm text-gray-600 font-semibold capitalize border-b shadow-sm ",children:["Last Payment date :",e("span",{className:"px-4 text-sm text-gray-500 uppercase",children:y(a==null?void 0:a.last_payment_date)})]}),t("li",{className:"p-2 px-5 text-sm text-gray-600 font-semibold capitalize border-b shadow-sm ",children:["Last payment amt. :",e("span",{className:"px-4 text-sm text-gray-500 uppercase",children:y(a==null?void 0:a.last_payment_amount)})]}),t("li",{className:"p-2 px-5 text-sm text-gray-600 font-semibold capitalize border-b shadow-sm ",children:["Payment Upto :",e("span",{className:"px-4 text-sm text-gray-500 uppercase",children:y(a==null?void 0:a.payment_upto)})]})]})})})]})})]}),e(ue,{tollPaymentListData:G})]})}export{ke as default};
