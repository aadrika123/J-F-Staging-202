import{r as k}from"./index-ace27d6f.js";var v={};Object.defineProperty(v,"__esModule",{value:!0});var S=v.useGeolocated=void 0;const e=k;function D(l={}){const{positionOptions:i={enableHighAccuracy:!0,maximumAge:0,timeout:1/0},isOptimisticGeolocationEnabled:d=!0,userDecisionTimeout:n=void 0,suppressLocationOnMount:f=!1,watchPosition:s=!1,geolocationProvider:t=typeof navigator<"u"?navigator.geolocation:void 0,watchLocationPermissionChange:y=!1,onError:a,onSuccess:c}=l,m=(0,e.useRef)(0),h=(0,e.useRef)(!0),g=(0,e.useRef)(0),[C,P]=(0,e.useState)(d),[T,E]=(0,e.useState)(),[A,I]=(0,e.useState)(),[x,b]=(0,e.useState)(),[M,O]=(0,e.useState)(),r=(0,e.useCallback)(()=>{m.current&&window.clearTimeout(m.current)},[]),u=(0,e.useCallback)(o=>{r(),h.current&&(E(()=>{}),P(!1),b(o)),a==null||a(o)},[a,r]),p=(0,e.useCallback)(o=>{r(),h.current&&(E(o.coords),I(o.timestamp),P(!0),b(()=>{})),c==null||c(o)},[c,r]),w=(0,e.useCallback)(()=>{if(!t||!t.getCurrentPosition||!t.watchPosition)throw new Error("The provided geolocation provider is invalid");n&&(m.current=window.setTimeout(()=>{u()},n)),s?g.current=t.watchPosition(p,u,i):t.getCurrentPosition(p,u,i)},[t,s,n,u,p,i]);return(0,e.useEffect)(()=>{let o;return y&&t&&"permissions"in navigator&&navigator.permissions.query({name:"geolocation"}).then(G=>{o=G,o.onchange=()=>{O(o.state)}}).catch(G=>{}),()=>{o&&(o.onchange=null)}},[]),(0,e.useEffect)(()=>(f||w(),()=>{r(),s&&g.current&&(t==null||t.clearWatch(g.current))}),[M]),{getPosition:w,coords:T,timestamp:A,isGeolocationEnabled:C,isGeolocationAvailable:!!t,positionError:x}}S=v.useGeolocated=D;function L(){const{isGeolocationAvailable:l,isGeolocationEnabled:i,getPosition:d,coords:n,positionError:f,timestamp:s}=S({positionOptions:{enableHighAccuracy:!0,timeout:1/0,maximumAge:localStorage.getItem("geoMaxAge")||1/0},watchPosition:!0,userDecisionTimeout:5e3});return{isGeolocationAvailable:l,isGeolocationEnabled:i,coords:n,positionError:f,timestamp:s,getPosition:d}}export{L as u};
