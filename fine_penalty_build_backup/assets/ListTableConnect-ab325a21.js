import{j as t,r as n,a4 as I,a5 as G,a6 as W,a7 as X,a8 as Y,S as Z,q as _,k as V}from"./index-787afc35.js";import{c as z}from"./index.esm-d4dbf1fb.js";function p({filter:e,setFilter:g}){return t.jsxs(t.Fragment,{children:["Search : "," ",t.jsx("input",{className:"border-2 border-gray-600 px-2 bg-gray-200",type:"text",value:e||"",onChange:s=>g(s.target.value)})]})}function ee(e){const[g,s]=n.useState("hidden"),P=n.useMemo(()=>e.columns,[]),u=n.useMemo(()=>e.dataList,[e.dataList,e==null?void 0:e.totalCount]),[r,B]=n.useState(10),[j,w]=n.useState(0);n.useEffect(()=>{w(0)},[e==null?void 0:e.totalCount]),n.useEffect(()=>{let l=(e==null?void 0:e.totalCount)/(e==null?void 0:e.perPage);(e==null?void 0:e.totalCount)%(e==null?void 0:e.perPage)!=0?F(parseInt(l)+1):F(parseInt(l))},[e==null?void 0:e.totalCount,r]);const{getTableBodyProps:h,headerGroups:o,prepareRow:C,setPageSize:F,state:O,rows:S,setGlobalFilter:T}=I.useTable({columns:P,data:u,initialState:{pageIndex:0}},I.useGlobalFilter,I.useSortBy,I.usePagination),{globalFilter:m,pageSize:v}=O,q=()=>{if(parseInt(j)>0&&parseInt(j)<=parseInt(e==null?void 0:e.lastPage))e==null||e.gotoPage(parseInt(j));else return!1},y=()=>{(e==null?void 0:e.lastPage)!=(e==null?void 0:e.currentPage)&&e.nextPage()},b=()=>{(e==null?void 0:e.currentPage)!=1&&e.prevPage()};return t.jsxs(t.Fragment,{children:[(e==null?void 0:e.search)==!1?t.jsxs("div",{className:"absolute -mt-[1vh] right-[2.3vw]",children:[t.jsx("div",{className:"flex-initial ml-2",children:t.jsxs("button",{className:"bg-sky-400 px-3 pr-3  shadow-lg rounded py-1 text-white hover:shadow-2xl hover:bg-green-600 text-center relative",onMouseEnter:()=>s(""),onMouseLeave:()=>s("hidden"),onClick:e.exportDataF,children:["Export",t.jsx("div",{className:g+" absolute h-full top-3 text-sm left-0 text-center animate-bounce",children:t.jsx(G,{})})]})}),t.jsx("div",{className:"flex-1",children:e.children})]}):t.jsxs("div",{className:"flex mb-2 pb-2",children:[t.jsx("div",{className:"flex-initial opacity-50",children:t.jsx(p,{filter:m,setFilter:T})}),t.jsx("div",{className:"flex-initial ml-2",children:t.jsxs("button",{className:"bg-sky-400 px-3 pr-3  shadow-lg rounded py-1 text-white hover:shadow-2xl hover:bg-green-600 text-center relative",onMouseEnter:()=>s(""),onMouseLeave:()=>s("hidden"),onClick:e.exportDataF,children:["Export",t.jsx("div",{className:g+" absolute h-full top-3 text-sm left-0 text-center animate-bounce",children:t.jsx(G,{})})]})}),t.jsx("div",{className:"flex-1",children:e.children})]}),t.jsx("div",{className:"flex w-full",children:t.jsxs("div",{className:"flex-1",children:[t.jsx("span",{className:"opacity-50",children:"Total Result : "}),t.jsx("span",{className:"font-semibold",children:e==null?void 0:e.totalCount})," "]})}),(e==null?void 0:e.feedback)!=null&&t.jsx("div",{children:t.jsxs("span",{className:"text-xs bg-gray-200 opacity-50 pr-2 pl-1 py-1 rounded-sm",children:[t.jsx(z,{className:"inline text-xs text-gray-400 mr-2"}),e.feedback]})}),t.jsx("div",{className:" p-2 overflow-x-auto bg-white",children:t.jsxs("div",{className:"inline-block min-w-full rounded-lg overflow-hidden bg-white",children:[t.jsxs("table",{...h,className:"min-w-full leading-normal",children:[t.jsx("thead",{className:"font-bold text-left text-sm bg-sky-50",children:o==null?void 0:o.map(l=>t.jsx("tr",{...l.getHeaderGroupProps(),children:l.headers.map(i=>t.jsxs("th",{...i.getHeaderProps(i.getSortByToggleProps()),className:(i==null?void 0:i.className)+" notranslate px-2 py-3 border-b border-gray-200 text-gray-800  text-left text-xs uppercase ",children:[i.render("Header"),t.jsx("span",{children:i.isSorted?i.isSortedDesc?"⬆️":"⬇️":""})]}))}))}),t.jsxs("tbody",{...h(),className:"text-sm",children:[S.map((l,i)=>{var k;return C(l),t.jsx("tr",{...l.getRowProps(),className:"bg-white shadow-lg border-b border-gray-200",children:(k=l==null?void 0:l.cells)==null?void 0:k.map((D,A)=>t.jsx("td",{...D.getCellProps(),className:"notranslate px-2 py-2 text-sm text-left",children:D.render("Cell")}))})}),t.jsx("tr",{children:t.jsx("td",{})})]})]}),t.jsxs("div",{className:"mt-3 grid grid-cols-12 items-center",children:[t.jsxs("div",{className:"sm:col-span-2 col-span-3 flex w-full ml-1 pr-10",children:[t.jsx("span",{children:t.jsx("input",{className:"h-10 w-[90%] placeholder:text-gray-600 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 p-1 ",type:"number",onChange:l=>{w(l.target.value)},placeholder:"Go to page..."})}),t.jsxs("abbr",{className:"cursor-pointer flex items-center w-[15%] no-underline",title:"Go",onClick:()=>q(),children:[" ",t.jsx("span",{className:"font-bold bg-green-300 text-xl px-2 pb-1 rounded-full hover:text-white hover:bg-green-500",children:"⇨"})," "]})]}),t.jsxs("div",{className:"col-span-2",children:["  ",t.jsx("select",{className:"h-10 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 ",value:r,onChange:l=>{B(Number(l.target.value)),e.perPageC(Number(l.target.value))},children:[5,10,25,50].map(l=>t.jsxs("option",{selected:l===10,value:l,children:["show ",l]},l))})]}),t.jsxs("div",{className:"col-span-3 sm:col-span-4 text-center sm:col-start-5 col-start-7",children:["   ",t.jsxs("span",{children:["page ","",t.jsxs("strong",{children:[e==null?void 0:e.currentPage," of ",e==null?void 0:e.lastPage]}),""]})]}),t.jsxs("div",{className:"col-span-3 sm:col-span-4 text-right",children:[t.jsx("abbr",{title:"First Page",children:t.jsxs("button",{className:"cursor-pointer hover:bg-sky-300 p-2 hover:text-white",onClick:()=>e==null?void 0:e.goFirst(),disabled:(e==null?void 0:e.currentPage)==1&&!0,children:[t.jsx(W,{})," "]})}),t.jsx("abbr",{title:"Previous Page",children:t.jsx("button",{className:((e==null?void 0:e.currentPage)==1?"opacity-50":"opacity-100")+" text-xl hover:bg-sky-300 hover:text-white cursor-pointer",onClick:()=>b(),disabled:(e==null?void 0:e.currentPage)==1&&!0,children:"⬅️"})}),t.jsx("abbr",{title:"Next Page",children:t.jsx("button",{className:((e==null?void 0:e.currentPage)==(e==null?void 0:e.lastPage)?"opacity-50":"opacity-100")+" text-xl hover:bg-sky-300 hover:text-white cursor-pointer",onClick:()=>y(),disabled:(e==null?void 0:e.currentPage)==(e==null?void 0:e.lastPage)&&!0,children:"➡️"})}),t.jsx("abbr",{title:"Last Page",children:t.jsxs("button",{className:"cursor-pointer hover:bg-sky-300 p-2 hover:text-white",onClick:()=>e==null?void 0:e.goLast(),disabled:(e==null?void 0:e.currentPage)==(e==null?void 0:e.lastPage)&&!0,children:["  ",t.jsx(X,{})]})})]})]})]})})]})}const le=e=>{const[g,s]=n.useState(10),[P,u]=n.useState(1),[r,B]=n.useState(0),[j,w]=n.useState(0),[h,o]=n.useState(0),[C,F]=n.useState(),[O,S]=n.useState(!1),[T,m]=n.useState(!1),[v,q]=n.useState([]),[y,b]=n.useState(!1),l=()=>{m(!1),b(!0),Object.keys(e==null?void 0:e.requestBody).length!==0&&e.loader(!0),console.log(`data before hitting api (${e==null?void 0:e.api}) => `,{...e==null?void 0:e.requestBody,perPage:g,page:P}),_.post(e==null?void 0:e.api,{...e==null?void 0:e.requestBody,perPage:g,page:P},V()).then(a=>{var d,x,f,E,N,c,L,H,M,R;((d=a==null?void 0:a.data)==null?void 0:d.status)==!0?(console.log("search success => ",a),e!=null&&e.getData&&(e==null||e.allData((x=a==null?void 0:a.data)==null?void 0:x.data)),q((E=(f=a==null?void 0:a.data)==null?void 0:f.data)==null?void 0:E.data),o((c=(N=a==null?void 0:a.data)==null?void 0:N.data)==null?void 0:c.total),B((H=(L=a==null?void 0:a.data)==null?void 0:L.data)==null?void 0:H.current_page),w((R=(M=a==null?void 0:a.data)==null?void 0:M.data)==null?void 0:R.last_page),m(!1)):(console.log("error while search => ",a),m(!0))}).catch(a=>(console.log("error while search => ",a),m(!0))).finally(()=>{b(!1),Object.keys(e==null?void 0:e.requestBody).length!==0&&e.loader(!1),m(!1)})},i=()=>{u(r+1)},k=()=>{u(r-1)},D=a=>{let d=parseInt(h/a),x=parseInt(h%a);if(x==0){d<r&&u(d),s(a);return}if(x!=0){d+1<r&&u(d+1),s(a);return}},A=()=>{u(1)},$=()=>{u(j)},J=a=>{u(a)},K=a=>(console.log(e==null?void 0:e.columns),a==null?void 0:a.map((x,f)=>{var N;const E=(N=e==null?void 0:e.columns)==null?void 0:N.map((c,L)=>(c==null?void 0:c.Header)!="Action"&&{[c==null?void 0:c.Header]:c!=null&&c.accessor?x[c==null?void 0:c.accessor]:f+1});return Object.assign({},...E)})),Q=()=>{b(!0),S(!1),_.post(e==null?void 0:e.api,{...e==null?void 0:e.requestBody,perPage:h},V()).then(a=>{var d,x,f;((d=a==null?void 0:a.data)==null?void 0:d.status)==!0&&(F(K((f=(x=a==null?void 0:a.data)==null?void 0:x.data)==null?void 0:f.data)),U()),b(!1)}).catch(a=>{b(!1)})},U=()=>{S(!0)};return n.useEffect(()=>{(e==null?void 0:e.requestBody)!=null&&(u(1),s(10),l())},[e==null?void 0:e.changeData]),n.useEffect(()=>{b(!0),l()},[P,g]),t.jsxs(t.Fragment,{children:[T&&t.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 pl-4 pr-16 py-3 rounded relative text-center",role:"alert",children:[t.jsx("strong",{className:"font-bold",children:"Sorry! "}),t.jsx("span",{className:"block sm:inline",children:"Some error occured while fetching list. Please try again later."}),t.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3"})]}),O&&t.jsx(Y,{data:C}),y&&t.jsx(Z,{}),!y&&(v==null?void 0:v.length)>0?t.jsx(t.Fragment,{children:t.jsx(ee,{search:e==null?void 0:e.search,currentPage:r,lastPage:j,goFirst:A,goLast:$,count1:h,columns:e==null?void 0:e.columns,dataList:v,exportStatus:!0,perPage:g,perPageC:D,totalCount:h,nextPage:i,prevPage:k,exportDataF:Q,exportData:C,gotoPage:a=>J(a)})}):t.jsx(t.Fragment,{children:!y&&t.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 pl-4 pr-16 py-3 rounded relative text-center",role:"alert",children:[t.jsx("span",{className:"block sm:inline",children:"Oops! No data available."}),t.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3"})]})})]})};export{le as L};
