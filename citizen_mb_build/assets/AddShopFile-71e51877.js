import{e as le,u as re,r as L,R as z,j as r,F as w,b as t,Q as P}from"./index-fda89f2b.js";import{u as ie}from"./formik.esm-d0db91c3.js";import{c as ne,a as y}from"./index.esm-1490c6a3.js";import{T as te}from"./ThemeStyle-994f51bc.js";import{R as f}from"./RentalApiList-bb99fa22.js";import{F as se,S as d,T as g,a as oe}from"./LoadingButton-3458d456.js";import{b as ue,a as v,c as x}from"./useCustomQuery-2e0b10e1.js";import{u as ae}from"./useCustomGeoLocation-43f3875a.js";import{r as ce}from"./resizeImage-f1558408.js";import{O as pe}from"./OverLayLoader-db17b969.js";import{R as de}from"./RotatingLoader-6db05d96.js";import"./hoist-non-react-statics.cjs-46e71829.js";import"./index.esm-392245a4.js";import"./ApiHeader2-b363f7b8.js";import"./Hourglass-5ed10f41.js";const F=[{isRequired:!0,isVisible:!0,name:"shopNo",label:"Shop no",type:"text",isDisabled:!0},{isRequired:!0,isVisible:!0,name:"circle",label:"Market",type:"select"},{isRequired:!0,isVisible:!0,name:"market",label:"Floor",type:"select"},{isRequired:!0,isVisible:!0,name:"location",label:"Location",type:"text"},{isRequired:!0,isVisible:!0,name:"building_name",label:"Building name",type:"text"},{isRequired:!0,isVisible:!0,name:"wardNo",label:"Ward no",type:"select"},{isRequired:!0,isVisible:!0,name:"allottee",label:"Allottee",type:"text",inputValidation:["removeDoubleSpace","string"]},{isRequired:!0,isVisible:!0,name:"address",label:"Address",type:"text",inputValidation:["removeDoubleSpace"]},{isRequired:!0,isVisible:!0,name:"rate",label:"Rate",type:"text",inputValidation:["rupee"]},{isRequired:!0,isVisible:!0,name:"arrear",label:"Arrear",type:"text",inputValidation:["rupee"]},{isRequired:!0,isVisible:!0,name:"lastPayDt",label:"Last payment date",type:"date"},{isRequired:!0,isVisible:!0,name:"lastPayAmt",label:"Last payment amount",type:"text",inputValidation:["rupee"]},{isRequired:!0,isVisible:!0,name:"allottedLength",label:"Allotted Length",type:"text",inputValidation:["rupee"]},{isRequired:!0,isVisible:!0,name:"allottedBreadth",label:"Allotted Breadth",type:"text",inputValidation:["rupee"]},{isRequired:!0,isVisible:!0,name:"allottedHeight",label:"Allotted Height",type:"text",inputValidation:["rupee"]},{isRequired:!0,isVisible:!0,name:"area",label:"Area",type:"text",inputValidation:["rupee"]},{isRequired:!0,isVisible:!0,name:"presentLength",label:"Present Length",type:"text",inputValidation:["rupee"]},{isRequired:!0,isVisible:!0,name:"presentBreadth",label:"Present Breadth",type:"text",inputValidation:["rupee"]},{isRequired:!0,isVisible:!0,name:"presentHeight",label:"Present Height",type:"text",inputValidation:["rupee"]},{isRequired:!0,isVisible:!0,name:"noOfFloors",label:"No. Of Floors",type:"text",inputValidation:["number"]},{isRequired:!0,isVisible:!0,name:"presentOccupier",label:"Present Occupier",type:"text",inputValidation:["removeDoubleSpace","string"]},{isRequired:!0,isVisible:!0,name:"tradeLicense",label:"Trade license no.",type:"text",inputValidation:["removeDoubleSpace"]},{isRequired:!0,isVisible:!0,name:"construction",label:"Construction",type:"select",options:N=>N.map(o=>r("option",{value:o==null?void 0:o.id,children:o==null?void 0:o.construction_type},o.id))},{isRequired:!0,isVisible:!0,name:"electricity",label:"Electricity",type:"select",options:[{value:1,label:"Yes"},{value:0,label:"No"}]},{isRequired:!1,isVisible:!1,name:"electricityNo",label:"Electricity no.",type:"text",inputValidation:["removeDoubleSpace"]},{isRequired:!0,isVisible:!0,name:"water",label:"Water",type:"select",options:[{value:1,label:"Yes"},{value:0,label:"No"}]},{isRequired:!1,isVisible:!1,name:"waterConsumerNo",label:"Water consumer no.",type:"text",inputValidation:["removeDoubleSpace"]},{isRequired:!0,isVisible:!0,name:"contactNo",label:"Contact no.",type:"text",inputValidation:["mobile","number"]},{isRequired:!0,isVisible:!0,name:"longitude",label:t("span",{children:["Longitude ",r("br",{}),r("small",{className:"text-blue-700",children:"(When you choose the photo1, it will be auto filled)"})]}),type:"text",placeholder:"Longitude"},{isRequired:!0,isVisible:!0,name:"latitude",label:t("span",{children:["Latitude ",r("br",{}),r("small",{className:"text-blue-700",children:"(When you choose the photo1, it will be auto filled)"})]}),type:"text",placeholder:"Latitude"},{isRequired:!0,isVisible:!0,name:"photo1Path",label:"Photo 1",type:"file"},{isRequired:!0,isVisible:!0,name:"photo2Path",label:"Photo 2",type:"file"},{isRequired:!0,isVisible:!0,name:"remarks",label:"Remarks",type:"textarea",inputValidation:["removeDoubleSpace"]}];function Fe(){var S,B,C;const[N]=le(),o=N.get("id"),{titleStyle:M}=te(),{api_UlbCircleList:Y,api_locationByCircleList:D,api_addShops:G,api_getConstructionType:Q}=f(),J=re(),{coords:h}=ae(),[_,K]=L.useState(""),[k,X]=L.useState(""),A=ue({}),V=(e,l)=>{P.dismiss(),l=="success"&&P.success(e),l=="error"&&P.error(e)},i=ie({initialValues:F.reduce((e,l)=>(e[l.name]="",e),{}),enableReinitialize:!0,onSubmit:async e=>{await Z(e)},validationSchema:ne().shape({electricityNo:y().when("electricity",{is:e=>e==1,then:()=>y().required("This field is required")}),waterConsumerNo:y().when("water",{is:e=>e==1,then:()=>y().required("This field is required")}),...F.reduce((e,l)=>(l.isRequired&&(e[l.name]=y().required("This field is required")),e),{})})}),R=v({api:Y,options:{enabled:!0}});v({api:D,config:{circleId:i.values.circle},value:[i.values.circle],options:{enabled:!!i.values.circle}});const q=v({api:Q,options:{enabled:!0}}),b=v({api:(S=f())==null?void 0:S.getUlbByWard,config:{},options:{enabled:!0}}),c=x({api:`${f().shopById}?id=${o}`,options:{enabled:!!o}});x({api:f().circleApi,options:{enabled:!0}}),x({api:`${(B=f())==null?void 0:B.marketApi}?location_id=${i.values.circle}`,options:{enabled:!!i.values.circle}});const m=x({api:f().assetsBuildingDropdown,options:{enabled:!0}});L.useEffect(()=>{var e;if((e=c==null?void 0:c.data)!=null&&e.data&&o){const l=c.data.data;i.setValues({...i.values,circle:l.asset_id||"",market:l.floor_id||"",floorName:(l==null?void 0:l.floorName)||"",assetName:(l==null?void 0:l.assetName)||"",wardNo:l.ward_no||"",location:l.location||"",building_name:(l==null?void 0:l.building_name)||"",ulbId:(l==null?void 0:l.ulb_id)||"",shopNo:(l==null?void 0:l.shop_no)||"",allottee:l.owner_name||"",address:l.address||"",rate:"",arrear:"",lastPayDt:"",lastPayAmt:"",allottedLength:l.length||"",allottedBreadth:l.breadth||"",allottedHeight:l.height||"",area:parseInt(l.length)*parseInt(l.breadth)||l.building_area||"",presentLength:"",presentBreadth:"",presentHeight:"",noOfFloors:l.no_of_floors||"",presentOccupier:l.name||"",tradeLicense:"",construction:"",electricity:"",electricityNo:"",water:"",waterConsumerNo:"",contactNo:"",longitude:"",latitude:"",photo1Path:"",photo2Path:"",remarks:""})}},[(C=c==null?void 0:c.data)==null?void 0:C.data,o]);const Z=async e=>{var p;let l,s;l=G,s={assetId:e==null?void 0:e.circle,assetName:e==null?void 0:e.assetName,floorName:e==null?void 0:e.floorName,floorId:e==null?void 0:e.market,allottee:e==null?void 0:e.allottee,ulbId:e==null?void 0:e.ulbId,wardNo:e==null?void 0:e.wardNo,marketName:e==null?void 0:e.building_name,circleName:e==null?void 0:e.location,shopNo:e==null?void 0:e.shopNo,address:e==null?void 0:e.address,rate:e==null?void 0:e.rate,arrear:e==null?void 0:e.arrear,lastPayDt:e==null?void 0:e.lastPayDt,lastPayAmt:e==null?void 0:e.lastPayAmt,allottedLength:e==null?void 0:e.allottedLength,allottedBreadth:e==null?void 0:e.allottedBreadth,allottedHeight:e==null?void 0:e.allottedHeight,area:e==null?void 0:e.area,presentLength:e==null?void 0:e.presentLength,presentBreadth:e==null?void 0:e.presentBreadth,presentHeight:e==null?void 0:e.presentHeight,noOfFloors:e==null?void 0:e.noOfFloors,presentOccupier:e==null?void 0:e.presentOccupier,tradeLicense:e==null?void 0:e.tradeLicense,construction:e==null?void 0:e.construction,electricity:e==null?void 0:e.electricity,electricityNo:e==null?void 0:e.electricityNo,water:e==null?void 0:e.water,waterConsumerNo:e==null?void 0:e.waterConsumerNo,contactNo:e==null?void 0:e.contactNo,longitude:e==null?void 0:e.longitude,latitude:e==null?void 0:e.latitude,photo1Path:e==null?void 0:e.photo1Path,photo2Path:e==null?void 0:e.photo2Path,remarks:e==null?void 0:e.remarks};try{const u=await A.mutateAsync({api:l,data:s});(p=u==null?void 0:u.data)!=null&&p.status?(V("Data saved successfully","success"),J("/shopList")):V("Data not saved","error")}catch{V("Data not saved","error")}},ee=async(e,l)=>{const s=e.target.files[0],p=await ce(s),u=new File([p],s==null?void 0:s.name,{type:s==null?void 0:s.type});l==="photo1Path"?(i.setFieldValue("photo1Path",u),i.setFieldValue("latitude",h==null?void 0:h.latitude),i.setFieldValue("longitude",h==null?void 0:h.longitude),K(URL.createObjectURL(u))):(i.setFieldValue("photo2Path",u),X(URL.createObjectURL(u)))};return z.useEffect(()=>{i.values.electricity==0&&i.setFieldValue("electricityNo",""),i.values.water==0&&i.setFieldValue("waterConsumerNo","")},[i.values.electricity,i.values.water]),z.useEffect(()=>{i.values.allottedLength&&i.values.allottedBreadth&&i.setFieldValue("area",parseInt(i.values.allottedLength)*parseInt(i.values.allottedBreadth))},[i.values.allottedLength,i.values.allottedBreadth]),R!=null&&R.isLoading?r(w,{children:r(de,{})}):t(w,{children:[A.isLoading&&r(pe,{}),r("div",{className:"bg-[#eff2f0] ",children:t("div",{className:" container mx-auto p-4",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-12 lg:grid-cols-12 p-4 border-b",children:[t("div",{className:"col-span-6 flex space-x-3",children:[r("img",{src:"https://cdn-icons-png.flaticon.com/128/2981/2981313.png",className:"h-10 -mt-2"}),r("h1",{className:`${M}`,children:"Add Shops"})]}),r("div",{className:"col-span-6 flex space-x-3 justify-end"})]}),r(se,{formik:i,children:t("div",{className:"bg-[#fdfdfd]  rounded-2xl shadow-md p-2",children:[r("div",{className:"p-2",children:F.map((e,l)=>{var s,p,u,O,T,H,I,$,E,j;if(e.name==="circle")return r("div",{className:"form-group flex-shrink max-w-full px-0 w-full md:w-1/4 mb-4",children:t(d,{name:e.name,formik:i,label:e.label,selectedText:"assetName",children:[r("option",{selected:!0,children:"select"}),(p=(s=m==null?void 0:m.data)==null?void 0:s.data)==null?void 0:p.map(n=>r("option",{value:n==null?void 0:n.id,children:n==null?void 0:n.building_name},n.id))]})},l);if(e.name==="market")return r("div",{className:"form-group flex-shrink max-w-full px-0 w-full md:w-1/4 mb-4",children:t(d,{name:e.name,formik:i,label:e.label,selectedText:"floorName",children:[r("option",{selected:!0,children:"select"}),(O=(u=m==null?void 0:m.data)==null?void 0:u.data)==null?void 0:O.map(n=>{var U,W;if((n==null?void 0:n.id)==((U=i==null?void 0:i.values)==null?void 0:U.circle))return(W=n==null?void 0:n.floor_data)==null?void 0:W.map(a=>r("option",{value:a==null?void 0:a.id,children:a==null?void 0:a.floor},a==null?void 0:a.id))})]})},l);if(e.name==="ulbId")return r("div",{className:"form-group flex-shrink max-w-full px-0 w-full md:w-1/4 mb-4",children:t(d,{name:e.name,formik:i,label:e.label,children:[r("option",{selected:!0,children:"select"}),(H=(T=b==null?void 0:b.data)==null?void 0:T.data)==null?void 0:H.map(n=>r("option",{value:n==null?void 0:n.ward_name,children:n==null?void 0:n.ward_name},n.id))]})},l);if(e.name==="wardNo")return r("div",{className:"form-group flex-shrink max-w-full px-0 w-full md:w-1/4 mb-4",children:t(d,{name:e.name,formik:i,label:e.label,children:[r("option",{selected:!0,children:"select"}),($=(I=b==null?void 0:b.data)==null?void 0:I.data)==null?void 0:$.map(n=>r("option",{value:n==null?void 0:n.ward_name,children:n==null?void 0:n.ward_name},n.id))]})},l);if(e.name==="electricity")return t(w,{children:[r("div",{className:"form-group flex-shrink max-w-full px-0 w-full md:w-1/4 mb-4",children:t(d,{name:e.name,formik:i,label:e.label,children:[r("option",{selected:!0,children:"select"}),e.options.map(n=>r("option",{value:n.value,children:n.label},n.value))]})},l),i.values.electricity==1&&r("div",{className:"form-group flex-shrink max-w-full px-0 w-full md:w-1/4 mb-4",children:r(g,{name:"electricityNo",formik:i,label:" Electricity No"})},l)]});if(e.name==="water")return t(w,{children:[r("div",{className:"form-group flex-shrink max-w-full px-0 w-full md:w-1/4 mb-4",children:t(d,{name:e.name,formik:i,label:e.label,children:[r("option",{selected:!0,children:"select"}),e.options.map(n=>r("option",{value:n.value,children:n.label},n.value))]})},l),i.values.water==1&&r("div",{className:"form-group flex-shrink max-w-full px-0 w-full md:w-1/4 mb-4",children:r(g,{name:"waterConsumerNo",formik:i,label:" Consumer No"})},l)]});if(e.name==="construction")return r("div",{className:"form-group flex-shrink max-w-full px-0 w-full md:w-1/4 mb-4",children:t(d,{name:e.name,formik:i,label:e.label,children:[r("option",{selected:!0,children:"select"}),(j=(E=q==null?void 0:q.data)==null?void 0:E.data)==null?void 0:j.map(n=>r("option",{value:n==null?void 0:n.id,children:n==null?void 0:n.construction_type},n.id))]})},l);if(e.type==="text"&&e.isVisible)return r("div",{className:"form-group flex-shrink max-w-full px-0 w-full md:w-1/4 mb-4",children:r(g,{name:e.name,formik:i,label:e.label,inputValidation:e.inputValidation,placeholder:e.placeholder,disabled:e.name==="latitude"||e.name==="longitude"?!0:e==null?void 0:e.isDisabled})},l);if(e.type==="date")return r("div",{className:"form-group flex-shrink max-w-full px-0 w-full md:w-1/4 mb-4",children:r(g,{name:e.name,formik:i,label:e.label,type:"date"})},l);if(e.type==="file")return t("div",{className:"form-group flex-shrink max-w-full px-0 w-full md:w-1/4 mb-4",children:[r(g,{name:e.name,label:e.label,type:"file",onChange:n=>ee(n,e.name)}),r("p",{className:"text-red-600 text-xs",children:(i==null?void 0:i.touched[e.name])&&(i==null?void 0:i.errors[e.name])}),e.name==="photo1Path"&&_&&r("img",{src:_,className:"h-20"}),e.name==="photo2Path"&&k&&r("img",{src:k,className:"h-20"})]},l);if(e.type==="textarea")return r("div",{className:"form-group flex-shrink max-w-full px-0 w-full md:w-1/4 mb-4",children:r(oe,{name:e.name,formik:i,label:e.label,inputValidation:e.inputValidation})},l)})}),r("div",{className:"pb-8",children:r("button",{type:"submit",className:"bg-[#6AB783] px-7 py-2 text-white font-semibold rounded leading-5 shadow-lg w-full",children:"Save"})})]})})]})})]})}export{Fe as default};
