import{u as D,j as e,b as s,M as G,c as J,r as p,d as K,A as W,F as z,Q as w}from"./index-a5fcf8e9.js";import{T as X}from"./ThemeStyle-994f51bc.js";import{u as Z}from"./formik.esm-87560db8.js";import{c as L,a as i}from"./index.esm-de8323ef.js";import{l as R,n as m}from"./PowerupFunctions-b533bb54.js";import{R as ee}from"./RentalApiList-ef8d1e90.js";import{u as ae,a as C}from"./useCustomQuery-1acd3bcc.js";import{B as te}from"./index.esm-02f80419.js";function se({shopReceiptListData:o}){var x,N,y;const h=D();return o!=null&&o.isLoading?e("div",{className:"w-full h-32    flex justify-center items-center ",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})}):o!=null&&o.error?e("div",{className:"w-full h-32    flex justify-center items-center ",children:s("div",{className:"text-red-500",children:["Error: ",(x=o==null?void 0:o.error)==null?void 0:x.message]})}):e("div",{className:"p-5",children:(y=(N=o==null?void 0:o.data)==null?void 0:N.data)==null?void 0:y.map((r,b)=>s("div",{className:"w-full relative rounded-lg pb-2 mb-4 cursor-pointer shadow-lg ",children:[e("div",{className:"font-semibold bg-[#838FCE] px-4 py-2 text-white rounded-t-lg text-sm",children:"Shop Payment Details"}),e("div",{className:"w-full rounded-lg p-4 space-b-2",children:s("div",{className:"flex flex-row flex-wrap gap-x-4 gap-y-2 w-full",children:[s("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Vendor Name."}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:r==null?void 0:r.allottee})]}),s("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Amount"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:r==null?void 0:r.amount})]}),s("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Payment Date"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:r==null?void 0:r.payment_date})]}),s("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Payment Mode"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:r==null?void 0:r.pmt_mode})]})]})}),s("div",{onClick:()=>h(`/shop-payment-receipt/${r==null?void 0:r.id}`),className:"mb-2 mx-4 relative text-white px-2 2xl:px-4 py-[0.3rem] text-xs 2xl:text-sm md:absolute md:bottom-3 2xl:bottom-2 md:right-2 rounded-md bg-indigo-500 border-indigo-400 hover:border-indigo-600 hover:bg-indigo-600 hover:text-white shadow-sm  cursor-pointer poppins md:mt-0 w-max",children:["View Receipt",e(te,{className:"inline font-semibold text-xl"})]})]},b))})}G.setAppElement("#root");function be(){var _,M,S,E;const o=D(),{id:h}=J(),x=ae({}),{api_shopDetailsById:N,api_shopTcPayment:y,api_shop_month_demand:r,api_shop_calculate_price:b,api_shop_payment:P,api_shop_receipt_list:k,api_shop_Payment_chq_dd:le}=ee(),{titleColor:A,bgHeaderColor:ne}=X(),f=(t,n)=>{w.dismiss(),n=="success"&&w.success(t),n=="error"&&w.error(t)},[F,v]=p.useState(!1),[l,H]=p.useState(),[re,I]=p.useState(""),[de,U]=p.useState(""),[oe,$]=p.useState(""),[ce,j]=p.useState("");p.useState(!1);const g=C({api:r,config:{shopId:h},options:{enabled:!0}}),B=t=>{console.log("==2======",t);const n=new Date,c=t,u=(n.getFullYear()-c.getFullYear())*12+(n.getMonth()-c.getMonth())+1;console.log("==3======",u),I(u)},Q=t=>{console.log("==1======",t);const[n,c,u]=t.split("/"),d=new Date(`${u}/${c}/${n}`);console.log("===1.1= after splitting==",d),B(d)},a=Z({initialValues:{month:"",amount:0,paymentMode:"",bankName:"",branchName:"",chequeNo:"",chequeDdDate:"",photo:null},validationSchema:L({month:i().required("Month is required"),paymentMode:i().required("Payment Mode is required"),bankName:i().when("paymentMode",{is:t=>t=="CHEQUE"||t=="DD",then:()=>i().required("Bank Name is required")}),branchName:i().when("paymentMode",{is:t=>t=="CHEQUE"||t=="DD",then:()=>i().required("Branch Name is required")}),chequeNo:i().when("paymentMode",{is:t=>t=="CHEQUE"||t=="DD",then:()=>i().required("Cheque No is required")}),chequeDdDate:i().when("paymentMode",{is:t=>t=="CHEQUE"||t=="DD",then:()=>i().required("Cheque/DD Date is required")})}),onSubmit:async t=>{await V()}});C({api:b,config:{shopId:h,month:a.values.month},value:[a.values.month],options:{enabled:!!a.values.month,onSuccess:t=>{var n;a.setFieldValue("amount",(n=t==null?void 0:t.data)==null?void 0:n.amount)}}});const T=C({api:k,config:{shopId:h},options:{enabled:!!h}}),O=t=>{console.log("target value",t.target.value),console.log("target value",t.target.name);let n=t.target.name,c=t.target.value;console.log("value to ...",c),n=="ddmmyy"&&U(c),n=="fromDate"&&$(c),n=="uptoDate"&&j(c)},V=async t=>{var n,c,u;if(a.values.paymentMode!="ONLINE"){const d=await(x==null?void 0:x.mutateAsync({api:P,data:{shopId:h,month:a.values.month,paymentMode:a.values.paymentMode}}));console.log("res",(n=d==null?void 0:d.data)==null?void 0:n.status),(c=d==null?void 0:d.data)!=null&&c.status?(f((u=d==null?void 0:d.data)==null?void 0:u.message,"success"),g==null||g.refetch(),q()):f(d==null?void 0:d.message,"error")}},Y=()=>{if(!a.values.month)return f("Please select month","error");o(`/shop-demand-details?shop_id=${h}&month=${a.values.month}`)};p.useEffect(()=>{q()},[]);const q=()=>{v(!0);const t={shopId:h};K.post(N,t,W()).then(n=>{n.data.status&&(H(n.data.data),Q(n.data.data.payment_upto)),v(!1)}).catch(n=>{v(!1)})};return s(z,{children:[F&&R(),s("div",{className:"bg-[#eff2f0]",children:[s("div",{className:"col-span-12",children:[" ",e("h1",{className:`font-bold ${A} text-xl px-4 py-2 text-gray-600`,children:"Shop Details"})]}),e("div",{className:"flex justify-center items-center  overflow-hidden p-4",children:s("div",{class:"w-full md:w-1/3 rounded-lg bg-[#fdfdfd] shadow-indigo-50 shadow-md",children:[s("div",{className:"bg-[#6c68f0] rounded-lg p-4 text-white",children:[s("p",{class:"text-sm text-center font-semibold ",children:["Toll No. : ",e("span",{children:m(l==null?void 0:l.shop_no)})]}),e("p",{class:"text-center py-1",children:s("span",{class:"text-sm justify-center text-gray-50 flex",children:[e("span",{className:"",children:"Payable Amount : "}),a.values.amount]})}),s("form",{onSubmit:a.handleSubmit,onChange:O,children:[s("div",{className:"space-x-2 py-1",children:[s("select",{name:"paymentMode",className:"p-1 text-gray-800 border border-gray-300 rounded-sm w-full",onChange:a.handleChange,value:a.values.paymentMode,children:[e("option",{value:"",children:"Select Payment Mode"}),e("option",{value:"CASH",children:"Cash"}),e("option",{value:"ONLINE",children:"Online"}),e("option",{value:"CHEQUE",children:"Cheque"}),e("option",{value:"DD",children:"DD"})]}),e("span",{className:"text-red-400 text-sm",children:a.touched.paymentMode&&a.errors.paymentMode})]}),((_=a==null?void 0:a.values)==null?void 0:_.paymentMode)=="CHEQUE"||((M=a==null?void 0:a.values)==null?void 0:M.paymentMode)=="DD"?s(z,{children:[s("div",{className:"flex space-x-2  py-1",children:[s("div",{className:"w-1/2",children:[e("p",{className:"capitalize text-xs",children:"Bank Name"}),e("input",{type:"text",name:"bankName",className:"p-1 text-gray-800 border border-gray-300 rounded-sm w-full",onChange:a.handleChange,value:a.values.bankName}),e("span",{className:"text-red-400 text-sm",children:a.touched.bankName&&a.errors.bankName})]}),s("div",{className:"w-1/2",children:[e("p",{className:"capitalize text-xs",children:"Branch Name"}),e("input",{type:"text",name:"branchName",className:"p-1 text-gray-800 border border-gray-300 rounded-sm w-full",onChange:a.handleChange,value:a.values.branchName}),e("span",{className:"text-red-400 text-sm",children:a.touched.branchName&&a.errors.branchName})]})]}),s("div",{className:"flex space-x-2  py-1",children:[s("div",{className:"w-1/2",children:[e("p",{className:"capitalize text-xs",children:"Cheque No."}),e("input",{type:"text",name:"chequeNo",className:"p-1 text-gray-800 border border-gray-300 rounded-sm w-full",onChange:a.handleChange,value:a.values.chequeNo}),e("span",{className:"text-red-400 text-sm",children:a.touched.chequeNo&&a.errors.chequeNo})]}),s("div",{className:"w-1/2",children:[e("p",{className:"capitalize text-xs",children:"Cheque/DD Date"}),e("input",{type:"date",name:"chequeDdDate",className:"p-1 text-gray-800 border border-gray-300 rounded-sm w-full",onChange:a.handleChange,value:a.values.chequeDdDate}),e("span",{className:"text-red-400 text-sm",children:a.touched.chequeDdDate&&a.errors.chequeDdDate})]})]}),e("div",{className:"flex space-x-2  py-1",children:s("div",{className:"w-1/2",children:[e("p",{className:"capitalize text-xs",children:"Upload Photo"}),e("input",{type:"file",name:"photo",onChange:a.handleChange,value:a.values.photo}),e("span",{className:"text-red-400 text-sm",children:a.touched.photo&&a.errors.photo})]})})]}):null,e("div",{className:"flex space-x-2 py-1  ",children:s("div",{className:"w-full",children:[e("p",{className:"capitalize text-xs",children:"Select Month"}),s("select",{name:"month",className:"p-1 text-gray-800 border border-gray-300 rounded-sm w-full",onChange:a.handleChange,value:a.values.month,children:[e("option",{value:"",children:"Select Month"}),(E=(S=g==null?void 0:g.data)==null?void 0:S.data)==null?void 0:E.map(t=>e("option",{value:t==null?void 0:t.monthly,children:t==null?void 0:t.monthly},t==null?void 0:t.id))]}),e("span",{className:"text-red-400 text-sm",children:a.touched.month&&a.errors.month})]})}),s("div",{className:"flex gap-5",children:[e("button",{type:"button",onClick:Y,className:"bg-green-400 mt-1 py-2 px-2 rounded-sm capitalize text-xs w-full ",children:"Demand Detail"}),e("button",{type:"submit",className:"bg-amber-500 mt-1 py-2 px-2 rounded-sm capitalize text-xs w-full ",children:"Pay Now"})]})]})]}),e("div",{class:"bg-white shadow-lg rounded-lg  w-full mt-4",children:e("div",{children:s("ul",{children:[s("li",{className:"p-2 px-5 text-xs text-gray-600 font-semibold capitalize  border-b shadow-sm",children:["sairat Name :",e("span",{className:"px-4 text-xs text-gray-500 uppercase",children:m(l==null?void 0:l.allottee)})]}),s("li",{className:"p-2 px-5 text-xs text-gray-600 font-semibold capitalize border-b shadow-sm ",children:["Present occupier :",e("span",{className:"px-4 text-xs text-gray-500 uppercase",children:m(l==null?void 0:l.present_occupier)})]}),s("li",{className:"p-2 px-5 text-xs text-gray-600 font-semibold capitalize  border-b shadow-sm",children:["Contact no. :",e("span",{className:"px-4 text-xs text-gray-500 uppercase",children:m(l==null?void 0:l.contact_no)})]}),s("li",{className:"p-2 px-5 text-xs text-gray-600 font-semibold capitalize border-b shadow-sm ",children:["circle :",e("span",{className:"px-4 text-xs text-gray-500 uppercase",children:m(l==null?void 0:l.circle_name)})]}),s("li",{className:"p-2 px-5 text-xs text-gray-600 font-semibold capitalize border-b shadow-sm ",children:["market :",e("span",{className:"px-4 text-xs text-gray-500 uppercase",children:m(l==null?void 0:l.market_name)})]}),s("li",{className:"p-2 px-5 text-xs text-gray-600 font-semibold capitalize border-b shadow-sm ",children:["monthly rent :",e("span",{className:"px-4 text-xs text-gray-500 uppercase",children:m(l==null?void 0:l.rate)})]}),s("li",{className:"p-2 px-5 text-xs text-gray-600 font-semibold capitalize border-b shadow-sm ",children:["last demand :",e("span",{className:"px-4 text-xs text-gray-500 uppercase",children:m(l==null?void 0:l.last_payment_amount)})]}),s("li",{className:"p-2 px-5 text-xs text-gray-600 font-semibold capitalize border-b shadow-sm ",children:["paid upto :",e("span",{className:"px-4 text-xs text-gray-500 uppercase",children:m(l==null?void 0:l.payment_upto)})]}),s("li",{className:"p-2 px-5 text-xs text-gray-600 font-semibold capitalize border-b shadow-sm ",children:["last pmt on :",e("span",{className:"px-4 text-xs text-gray-500 uppercase",children:m(l==null?void 0:l.last_payment_date)})]})]})})})]})}),e(se,{shopReceiptListData:T})]})]})}export{be as default};
