import{M as L,R as $,r as i,u as T,a as F,j as e,b as a,F as l}from"./index-ace27d6f.js";import{u as q}from"./formik.esm-70d5e597.js";import{c as E,a as p}from"./index.esm-70f5a44d.js";import{h as b}from"./moment-db06c914.js";import{W as R}from"./WaterApiList-1274c4b1.js";import z from"./CommonLoader-b1db4592.js";import"./Hourglass-eaf35b74.js";import"./BeatLoader-dab182db.js";const H={overlay:{background:"#e6e6fc"},content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-40%",transform:"translate(-50%, -50%)",backgroundColor:"transparent",border:"none",height:"500px"}};function P(d){L.setAppElement("#root");const[v,D]=$.useState(!1),[h,x]=i.useState(!1),u=d.id,w=T(),{api_waterInspectionSaveDate:f,header:S}=R(),y=E({inspectionTime:p().required("Enter Meter Reading"),inspectionDate:p().required("Select Connection Date")}),r=q({enableReinitialize:!0,initialValues:{inspectionTime:"",inspectionDate:"",applicationId:u},onSubmit:(o,N)=>{k(o)},validationSchema:y}),M=o=>{o.target.name,o.target.value},k=o=>{x(!1);const N={applicationId:o==null?void 0:o.applicationId,inspectionDate:b(o==null?void 0:o.inspectionDate,"YYYY-MM-DD").format("DD-MM-YYYY"),inspectionTime:o==null?void 0:o.inspectionTime};F.post(f,N,S).then(s=>{s.data.status?s.data.data.canView?w(`/water-site-inspection-form/${u}`):m():x("Failed to Save")}).catch(s=>{x("Exception While Saving..")})};i.useEffect(()=>{d.openModal>0&&D(!0)},[d.openModal]);function Y(){}function m(){D(!1),d.refetch()}return e("div",{className:"",children:e(L,{isOpen:v,onAfterOpen:Y,onRequestClose:m,style:H,contentLabel:"Example Modal",children:e("div",{children:e("div",{className:"relative w-full h-full max-w-3xl md:h-auto border-indigo-600 shadow-indigo-200 shadow-sm rounded",children:a("div",{className:"relative bg-white rounded-lg shadow ",children:[a("div",{className:"flex items-start justify-between p-4 border-b rounded-t dark:border-gray-600",children:[a("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Set Date and Time",e("p",{className:"text-sm font-light",children:"For Site Inspection"})]}),a("button",{onClick:m,className:"text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center dark:hover:bg-gray-600 dark:hover:text-white","data-modal-hide":"defaultModal",children:[e("svg",{"aria-hidden":"true",className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})}),e("span",{className:"sr-only",children:"Close modal"})]})]}),e("div",{className:" bg-white rounded-lg shadow-xl p-4",children:a("form",{onSubmit:r.handleSubmit,onChange:M,className:"p-4 relative",children:[a("div",{className:"",children:[e("div",{className:"flex-1",children:a("div",{className:"form-group mb-3 col-span-12 md:col-span-6 md:px-4",children:[a("label",{className:"form-label inline-block mb-1 text-gray-900 text-sm font-semibold",children:["Date"," ",e("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]}),e("input",{...r.getFieldProps("inspectionDate"),type:"date",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md cursor-pointer"}),e("span",{className:"text-red-600 absolute text-xs",children:r.touched.inspectionDate&&r.errors.inspectionDate?r.errors.inspectionDate:null})]})}),e("div",{className:"flex-1",children:a("div",{className:"form-group mb-3 col-span-12 md:col-span-6 md:px-4",children:[a("label",{className:"form-label inline-block mb-1 text-gray-900 text-sm font-semibold",children:["Time"," ",e("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]}),e("input",{...r.getFieldProps("inspectionTime"),type:"time",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md cursor-pointer",placeholder:"Enter Meter Reading"}),e("span",{className:"text-red-600 absolute text-xs",children:r.touched.inspectionTime&&r.errors.inspectionTime?r.errors.inspectionTime:null})]})})]}),h&&e("div",{children:e("div",{className:" absolute text-red-500",children:e("p",{className:"text-center",children:h})})}),a("div",{className:"flex justify-center p-2 border-t border-gray-200 rounded-b",children:[e("button",{type:"button",onClick:m,className:"mx-2 text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 rounded border border-red-200 text-sm font-medium px-5 py-1 focus:z-10 ",children:"Cancel"}),e("button",{type:"submit",className:"mx-2 text-white disabled:bg-gray-500 disabled:scale-100 bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded text-sm px-5 py-1 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800",children:"Submit"})]})]})})]})})})})})}function ae(){const[d,v]=i.useState(),[D,h]=i.useState(!1),[x,u]=i.useState(!1),[w,f]=i.useState(!1),[S,y]=i.useState(!1),[r,M]=i.useState(0),[k,Y]=i.useState(),{api_waterSiteInspectionList:m,header:o}=R(),N=E({fromDate:p().when("searchBy",{is:"byDate",then:p().required("Field is required")}),toDate:p().when("searchBy",{is:"byDate",then:p().required("Field is required")}),searchBy:p().required("This is a required field !")}),s=q({initialValues:{fromDate:"",toDate:"",searchBy:""},onSubmit:t=>{O(t)},validationSchema:N}),j=T(),O=t=>{u(!0),h(!1);const c={fromDate:b(t.fromDate).format("DD-MM-YYYY"),toDate:b(t.toDate).format("DD-MM-YYYY"),filterBy:t.searchBy,parameter:t.applicationNo};F.post(m,c,o).then(n=>{var g;v((g=n==null?void 0:n.data)==null?void 0:g.data),h(!0),u(!1)}).catch(n=>{h(!1),u(!1)})},V=t=>{let c=t.target.name,n=t.target.value;c==="searchBy"&&(n=="byDate"?f(!0):f(!1)),c==="searchBy"&&(n=="byApplication"?y(!0):y(!1))},W=(t,c)=>{c?j(`/water-site-inspection-form/${t}`):(Y(t),M(n=>n+1))};return a(l,{children:[e(P,{refetch:()=>{s.handleSubmit()},openModal:r,id:k}),x&&e(z,{}),a("div",{className:"border shadow-xl bg-white mt-6",children:[e("div",{className:"flex justify-between mx-5 my-3",children:e("div",{className:"flex ",children:e("p",{className:"font-bold text-2xl text-gray-600",children:"List of Site Inspection"})})}),e("form",{onSubmit:s.handleSubmit,onChange:V,children:a("div",{className:"justify-center m-10 space-y-5",children:[a("div",{className:"",children:[a("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:["Search By",e("span",{className:"text-red-500",children:"*"})]}),a("select",{name:"searchBy",onChange:s.handleChange,className:"cursor-pointer w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md",children:[e("option",{value:"",children:"Select"}),e("option",{value:"byDate",children:"Date"}),e("option",{value:"byApplication",children:"Application No"})]}),e("p",{className:"text-red-500 text-xs",children:s.touched.searchBy&&s.errors.searchBy?s.errors.searchBy:null})]}),w&&a("div",{className:"space-y-5",children:[a("div",{children:[a("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:["From Data",e("span",{className:"text-red-500",children:"*"})]}),e("input",{type:"date",name:"fromDate",onChange:s.handleChange,className:"cursor-pointer w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md"}),e("p",{className:"text-red-500 text-xs",children:s.touched.fromDate&&s.errors.fromDate?s.errors.fromDate:null})]}),a("div",{children:[a("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:["To Data",e("span",{className:"text-red-500",children:"*"})]}),e("input",{type:"date",name:"toDate",onChange:s.handleChange,className:"cursor-pointer w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md"}),e("p",{className:"text-red-500 text-xs",children:s.touched.toDate&&s.errors.toDate?s.errors.toDate:null})]})]}),S&&a("div",{children:[a("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:["Application No",e("span",{className:"text-red-500",children:"*"})]}),e("input",{type:"text",name:"applicationNo",onChange:s.handleChange,className:"cursor-pointer w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md"}),e("p",{className:"text-red-500 text-xs",children:s.touched.applicationNo&&s.errors.applicationNo?s.errors.applicationNo:null})]}),e("div",{className:"text-center ",children:e("button",{type:"submit",className:"mt-3 w-full border border-indigo-600 bg-indigo-600 hover:bg-indigo-400 text-white hover:text-black shadow-lg rounded-sm text-base font-semibold px-5 py-1",children:e("p",{className:"",children:" Search record "})})})]})}),e("div",{className:"m-10"}),e("div",{className:"mt-10 mx-4",children:d?a("div",{className:"w-full relative bg-indigo-50 shadow-md  rounded-sm pb-2 border-2 border-indigo-600 mb-4 select-none cursor-pointer",children:[e("div",{className:"font-semibold bg-indigo-600 px-4 text-white",children:"Consumer Details"}),e("div",{className:"w-full rounded-lg space-b-2",children:e("div",{className:"",children:d&&d.map((t,c)=>{var n,g,C,I,B,_;return a("div",{children:[a("div",{className:"w-full md:w-[40%] grid grid-cols-12 p-4",children:[a(l,{children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Application No"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-sm",children:t==null?void 0:t.application_no})]}),a(l,{children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Ward No"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-sm",children:t==null?void 0:t.ward_name})]}),a(l,{children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Apply Date"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-sm",children:t!=null&&t.apply_date?b(t==null?void 0:t.apply_date,"YYYY-MM-DD").format("DD-MMM-yy"):"N/A"})]}),a(l,{children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Scheduled Date"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-sm",children:(n=t==null?void 0:t.SiteInspectionDate)!=null&&n.inspection_date?b((g=t==null?void 0:t.SiteInspectionDate)==null?void 0:g.inspection_date,"YYYY-MM-DD").format("DD-MMM-yy"):"N/A"})]}),a(l,{children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Scheduled Time"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-sm",children:(C=t==null?void 0:t.SiteInspectionDate)!=null&&C.inspection_time?b((I=t==null?void 0:t.SiteInspectionDate)==null?void 0:I.inspection_time,"h:mm:ss A").format("HH:mm A"):"N/A"})]}),(t==null?void 0:t.holding_no)&&a(l,{children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Holding No"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-sm",children:t==null?void 0:t.holding_no})]}),(t==null?void 0:t.saf_no)&&a(l,{children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Saf No"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-sm",children:t==null?void 0:t.saf_no})]}),a(l,{children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Property Type"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-sm",children:t==null?void 0:t.property_type})]}),a(l,{children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Address"}),a("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-sm",children:[t==null?void 0:t.address,", ",t==null?void 0:t.pin]})]})]},c),e("div",{className:"float-right -mt-4 -pl-1",children:e("button",{type:"button",onClick:()=>{var A;return W(t.id,(A=t==null?void 0:t.SiteInspectionDate)==null?void 0:A.inspection_date)},className:"px-3 mt-1 rounded-l-sm -mr-0.5 bg-indigo-600 hover:bg-indigo-700 text-white text-sm",children:(B=t==null?void 0:t.SiteInspectionDate)!=null&&B.site_verify_status?"Start Re-Inspection":(_=t==null?void 0:t.SiteInspectionDate)!=null&&_.inspection_date?"View Details":"Schedule Inspection"})})]})})})})]}):e("div",{})})]})]})}export{ae as default};
