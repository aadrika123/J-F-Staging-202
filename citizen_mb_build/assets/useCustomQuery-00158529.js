import{z as B,C as g,D as K,E as x,H as w,I as J,J as X,K as k,N as L,O as Y,S as Z,U as O,V as N,W as G,R as v,X as tt,Y as q,Z as et,d as Q,A as I}from"./index-7d6593b7.js";import{A as rt}from"./ApiHeader2-b363f7b8.js";var st=function(a){B(i,a);function i(s,e){var t;return t=a.call(this)||this,t.client=s,t.options=e,t.trackedProps=[],t.selectError=null,t.bindMethods(),t.setOptions(e),t}var r=i.prototype;return r.bindMethods=function(){this.remove=this.remove.bind(this),this.refetch=this.refetch.bind(this)},r.onSubscribe=function(){this.listeners.length===1&&(this.currentQuery.addObserver(this),_(this.currentQuery,this.options)&&this.executeFetch(),this.updateTimers())},r.onUnsubscribe=function(){this.listeners.length||this.destroy()},r.shouldFetchOnReconnect=function(){return C(this.currentQuery,this.options,this.options.refetchOnReconnect)},r.shouldFetchOnWindowFocus=function(){return C(this.currentQuery,this.options,this.options.refetchOnWindowFocus)},r.destroy=function(){this.listeners=[],this.clearTimers(),this.currentQuery.removeObserver(this)},r.setOptions=function(e,t){var u=this.options,n=this.currentQuery;if(this.options=this.client.defaultQueryObserverOptions(e),typeof this.options.enabled<"u"&&typeof this.options.enabled!="boolean")throw new Error("Expected enabled to be a boolean");this.options.queryKey||(this.options.queryKey=u.queryKey),this.updateQuery();var c=this.hasListeners();c&&D(this.currentQuery,n,this.options,u)&&this.executeFetch(),this.updateResult(t),c&&(this.currentQuery!==n||this.options.enabled!==u.enabled||this.options.staleTime!==u.staleTime)&&this.updateStaleTimeout();var o=this.computeRefetchInterval();c&&(this.currentQuery!==n||this.options.enabled!==u.enabled||o!==this.currentRefetchInterval)&&this.updateRefetchInterval(o)},r.getOptimisticResult=function(e){var t=this.client.defaultQueryObserverOptions(e),u=this.client.getQueryCache().build(this.client,t);return this.createResult(u,t)},r.getCurrentResult=function(){return this.currentResult},r.trackResult=function(e,t){var u=this,n={},c=function(l){u.trackedProps.includes(l)||u.trackedProps.push(l)};return Object.keys(e).forEach(function(o){Object.defineProperty(n,o,{configurable:!1,enumerable:!0,get:function(){return c(o),e[o]}})}),(t.useErrorBoundary||t.suspense)&&c("error"),n},r.getNextResult=function(e){var t=this;return new Promise(function(u,n){var c=t.subscribe(function(o){o.isFetching||(c(),o.isError&&(e!=null&&e.throwOnError)?n(o.error):u(o))})})},r.getCurrentQuery=function(){return this.currentQuery},r.remove=function(){this.client.getQueryCache().remove(this.currentQuery)},r.refetch=function(e){return this.fetch(g({},e,{meta:{refetchPage:e==null?void 0:e.refetchPage}}))},r.fetchOptimistic=function(e){var t=this,u=this.client.defaultQueryObserverOptions(e),n=this.client.getQueryCache().build(this.client,u);return n.fetch().then(function(){return t.createResult(n,u)})},r.fetch=function(e){var t=this;return this.executeFetch(e).then(function(){return t.updateResult(),t.currentResult})},r.executeFetch=function(e){this.updateQuery();var t=this.currentQuery.fetch(this.options,e);return e!=null&&e.throwOnError||(t=t.catch(K)),t},r.updateStaleTimeout=function(){var e=this;if(this.clearStaleTimeout(),!(x||this.currentResult.isStale||!w(this.options.staleTime))){var t=J(this.currentResult.dataUpdatedAt,this.options.staleTime),u=t+1;this.staleTimeoutId=setTimeout(function(){e.currentResult.isStale||e.updateResult()},u)}},r.computeRefetchInterval=function(){var e;return typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.currentResult.data,this.currentQuery):(e=this.options.refetchInterval)!=null?e:!1},r.updateRefetchInterval=function(e){var t=this;this.clearRefetchInterval(),this.currentRefetchInterval=e,!(x||this.options.enabled===!1||!w(this.currentRefetchInterval)||this.currentRefetchInterval===0)&&(this.refetchIntervalId=setInterval(function(){(t.options.refetchIntervalInBackground||X.isFocused())&&t.executeFetch()},this.currentRefetchInterval))},r.updateTimers=function(){this.updateStaleTimeout(),this.updateRefetchInterval(this.computeRefetchInterval())},r.clearTimers=function(){this.clearStaleTimeout(),this.clearRefetchInterval()},r.clearStaleTimeout=function(){this.staleTimeoutId&&(clearTimeout(this.staleTimeoutId),this.staleTimeoutId=void 0)},r.clearRefetchInterval=function(){this.refetchIntervalId&&(clearInterval(this.refetchIntervalId),this.refetchIntervalId=void 0)},r.createResult=function(e,t){var u=this.currentQuery,n=this.options,c=this.currentResult,o=this.currentResultState,l=this.currentResultOptions,f=e!==u,p=f?e.state:this.currentQueryInitialState,m=f?this.currentResult:this.previousQueryResult,h=e.state,b=h.dataUpdatedAt,U=h.error,T=h.errorUpdatedAt,E=h.isFetching,d=h.status,M=!1,P=!1,R;if(t.optimisticResults){var A=this.hasListeners(),H=!A&&_(e,t),V=A&&D(e,u,t,n);(H||V)&&(E=!0,b||(d="loading"))}if(t.keepPreviousData&&!h.dataUpdateCount&&(m!=null&&m.isSuccess)&&d!=="error")R=m.data,b=m.dataUpdatedAt,d=m.status,M=!0;else if(t.select&&typeof h.data<"u")if(c&&h.data===(o==null?void 0:o.data)&&t.select===this.selectFn)R=this.selectResult;else try{this.selectFn=t.select,R=t.select(h.data),t.structuralSharing!==!1&&(R=k(c==null?void 0:c.data,R)),this.selectResult=R,this.selectError=null}catch(S){L().error(S),this.selectError=S}else R=h.data;if(typeof t.placeholderData<"u"&&typeof R>"u"&&(d==="loading"||d==="idle")){var y;if(c!=null&&c.isPlaceholderData&&t.placeholderData===(l==null?void 0:l.placeholderData))y=c.data;else if(y=typeof t.placeholderData=="function"?t.placeholderData():t.placeholderData,t.select&&typeof y<"u")try{y=t.select(y),t.structuralSharing!==!1&&(y=k(c==null?void 0:c.data,y)),this.selectError=null}catch(S){L().error(S),this.selectError=S}typeof y<"u"&&(d="success",R=y,P=!0)}this.selectError&&(U=this.selectError,R=this.selectResult,T=Date.now(),d="error");var z={status:d,isLoading:d==="loading",isSuccess:d==="success",isError:d==="error",isIdle:d==="idle",data:R,dataUpdatedAt:b,error:U,errorUpdatedAt:T,failureCount:h.fetchFailureCount,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>p.dataUpdateCount||h.errorUpdateCount>p.errorUpdateCount,isFetching:E,isRefetching:E&&d!=="loading",isLoadingError:d==="error"&&h.dataUpdatedAt===0,isPlaceholderData:P,isPreviousData:M,isRefetchError:d==="error"&&h.dataUpdatedAt!==0,isStale:F(e,t),refetch:this.refetch,remove:this.remove};return z},r.shouldNotifyListeners=function(e,t){if(!t)return!0;var u=this.options,n=u.notifyOnChangeProps,c=u.notifyOnChangePropsExclusions;if(!n&&!c||n==="tracked"&&!this.trackedProps.length)return!0;var o=n==="tracked"?this.trackedProps:n;return Object.keys(e).some(function(l){var f=l,p=e[f]!==t[f],m=o==null?void 0:o.some(function(b){return b===l}),h=c==null?void 0:c.some(function(b){return b===l});return p&&!h&&(!o||m)})},r.updateResult=function(e){var t=this.currentResult;if(this.currentResult=this.createResult(this.currentQuery,this.options),this.currentResultState=this.currentQuery.state,this.currentResultOptions=this.options,!Y(this.currentResult,t)){var u={cache:!0};(e==null?void 0:e.listeners)!==!1&&this.shouldNotifyListeners(this.currentResult,t)&&(u.listeners=!0),this.notify(g({},u,e))}},r.updateQuery=function(){var e=this.client.getQueryCache().build(this.client,this.options);if(e!==this.currentQuery){var t=this.currentQuery;this.currentQuery=e,this.currentQueryInitialState=e.state,this.previousQueryResult=this.currentResult,this.hasListeners()&&(t==null||t.removeObserver(this),e.addObserver(this))}},r.onQueryUpdate=function(e){var t={};e.type==="success"?t.onSuccess=!0:e.type==="error"&&!Z(e.error)&&(t.onError=!0),this.updateResult(t),this.hasListeners()&&this.updateTimers()},r.notify=function(e){var t=this;O.batch(function(){e.onSuccess?(t.options.onSuccess==null||t.options.onSuccess(t.currentResult.data),t.options.onSettled==null||t.options.onSettled(t.currentResult.data,null)):e.onError&&(t.options.onError==null||t.options.onError(t.currentResult.error),t.options.onSettled==null||t.options.onSettled(void 0,t.currentResult.error)),e.listeners&&t.listeners.forEach(function(u){u(t.currentResult)}),e.cache&&t.client.getQueryCache().notify({query:t.currentQuery,type:"observerResultsUpdated"})})},i}(N);function nt(a,i){return i.enabled!==!1&&!a.state.dataUpdatedAt&&!(a.state.status==="error"&&i.retryOnMount===!1)}function _(a,i){return nt(a,i)||a.state.dataUpdatedAt>0&&C(a,i,i.refetchOnMount)}function C(a,i,r){if(i.enabled!==!1){var s=typeof r=="function"?r(a):r;return s==="always"||s!==!1&&F(a,i)}return!1}function D(a,i,r,s){return r.enabled!==!1&&(a!==i||s.enabled===!1)&&(!r.suspense||a.state.status!=="error")&&F(a,r)}function F(a,i){return a.isStaleByTime(i.staleTime)}var it=function(a){B(i,a);function i(s,e){var t;return t=a.call(this)||this,t.client=s,t.setOptions(e),t.bindMethods(),t.updateResult(),t}var r=i.prototype;return r.bindMethods=function(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)},r.setOptions=function(e){this.options=this.client.defaultMutationOptions(e)},r.onUnsubscribe=function(){if(!this.listeners.length){var e;(e=this.currentMutation)==null||e.removeObserver(this)}},r.onMutationUpdate=function(e){this.updateResult();var t={listeners:!0};e.type==="success"?t.onSuccess=!0:e.type==="error"&&(t.onError=!0),this.notify(t)},r.getCurrentResult=function(){return this.currentResult},r.reset=function(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})},r.mutate=function(e,t){return this.mutateOptions=t,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,g({},this.options,{variables:typeof e<"u"?e:this.options.variables})),this.currentMutation.addObserver(this),this.currentMutation.execute()},r.updateResult=function(){var e=this.currentMutation?this.currentMutation.state:G(),t=g({},e,{isLoading:e.status==="loading",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset});this.currentResult=t},r.notify=function(e){var t=this;O.batch(function(){t.mutateOptions&&(e.onSuccess?(t.mutateOptions.onSuccess==null||t.mutateOptions.onSuccess(t.currentResult.data,t.currentResult.variables,t.currentResult.context),t.mutateOptions.onSettled==null||t.mutateOptions.onSettled(t.currentResult.data,null,t.currentResult.variables,t.currentResult.context)):e.onError&&(t.mutateOptions.onError==null||t.mutateOptions.onError(t.currentResult.error,t.currentResult.variables,t.currentResult.context),t.mutateOptions.onSettled==null||t.mutateOptions.onSettled(void 0,t.currentResult.error,t.currentResult.variables,t.currentResult.context))),e.listeners&&t.listeners.forEach(function(u){u(t.currentResult)})})},i}(N);function ut(){var a=!1;return{clearReset:function(){a=!1},reset:function(){a=!0},isReset:function(){return a}}}var at=v.createContext(ut()),ot=function(){return v.useContext(at)};function W(a,i,r){return typeof i=="function"?i.apply(void 0,r):typeof i=="boolean"?i:!!a}function $(a,i,r){var s=v.useRef(!1),e=v.useState(0),t=e[1],u=tt(a,i,r),n=q(),c=v.useRef();c.current?c.current.setOptions(u):c.current=new it(n,u);var o=c.current.getCurrentResult();v.useEffect(function(){s.current=!0;var f=c.current.subscribe(O.batchCalls(function(){s.current&&t(function(p){return p+1})}));return function(){s.current=!1,f()}},[]);var l=v.useCallback(function(f,p){c.current.mutate(f,p).catch(K)},[]);if(o.error&&W(void 0,c.current.options.useErrorBoundary,[o.error]))throw o.error;return g({},o,{mutate:l,mutateAsync:o.mutate})}function ct(a,i){var r=v.useRef(!1),s=v.useState(0),e=s[1],t=q(),u=ot(),n=t.defaultQueryObserverOptions(a);n.optimisticResults=!0,n.onError&&(n.onError=O.batchCalls(n.onError)),n.onSuccess&&(n.onSuccess=O.batchCalls(n.onSuccess)),n.onSettled&&(n.onSettled=O.batchCalls(n.onSettled)),n.suspense&&(typeof n.staleTime!="number"&&(n.staleTime=1e3),n.cacheTime===0&&(n.cacheTime=1)),(n.suspense||n.useErrorBoundary)&&(u.isReset()||(n.retryOnMount=!1));var c=v.useState(function(){return new i(t,n)}),o=c[0],l=o.getOptimisticResult(n);if(v.useEffect(function(){r.current=!0,u.clearReset();var f=o.subscribe(O.batchCalls(function(){r.current&&e(function(p){return p+1})}));return o.updateResult(),function(){r.current=!1,f()}},[u,o]),v.useEffect(function(){o.setOptions(n,{listeners:!1})},[n,o]),n.suspense&&l.isLoading)throw o.fetchOptimistic(n).then(function(f){var p=f.data;n.onSuccess==null||n.onSuccess(p),n.onSettled==null||n.onSettled(p,null)}).catch(function(f){u.clearReset(),n.onError==null||n.onError(f),n.onSettled==null||n.onSettled(void 0,f)});if(l.isError&&!u.isReset()&&!l.isFetching&&W(n.suspense,n.useErrorBoundary,[l.error,o.getCurrentQuery()]))throw l.error;return n.notifyOnChangeProps==="tracked"&&(l=o.trackResult(l,n)),l}function j(a,i,r){var s=et(a,i,r);return ct(s,st)}function pt({key:a,api:i,options:r,value:s,config:e}){return j({queryKey:[a??i,...s??[]],queryFn:async()=>{const u=await Q.get(i,I(),{...e});return u==null?void 0:u.data},refetchOnReconnect:"always",refetchOnWindowFocus:!1,...r})}function vt({key:a,api:i,options:r,value:s,config:e}){return j({queryKey:[a??i,...s??[]],queryFn:async()=>{const u=await Q.post(i,{...e},I());return u==null?void 0:u.data},refetchOnReconnect:"always",refetchOnWindowFocus:!1,...r})}const lt=(a,i)=>Q.post(a,i,{...I()}),Rt=({options:a})=>$({mutationFn:({api:i,data:r})=>lt(i,r),...a}),ht=(a,i)=>Q.post(a,i,{...rt()}),yt=({options:a})=>$({mutationFn:({api:i,data:r})=>ht(i,r),...a});export{vt as a,yt as b,pt as c,Rt as u};
