import{u as S,j as e,C as V,p as q,_ as d}from"./index-CJanrnS1.js";import{u as F,r as l}from"./router-DLL89Qev.js";import{u as E,P as C}from"./index-CbF4Q5F8.js";import{s as I}from"./index-DXEukT1i.js";import{o as P,c as Y,a as c}from"./yup-BJBSUlIq.js";import{b as z,F as B,R as u,B as A}from"./switch-03ThOzMD.js";import{h as j}from"./moment-BjLXg0w5.js";import{S as D}from"./separator-UdM07sKW.js";import{u as H}from"./useScheduleIncharge-B2enmimD.js";import"./axios-DmypytPv.js";import"./headlessui-DXpdh5LM.js";const L=Y().shape({vehicleType:c().required("Vehicle Type is required"),vehicleNumber:c().required("Vehicle Number is required"),date:c().required("Date is required"),inTime:c().required("In Time is required")});function te(){var x;const b=F(),h=E({}),o=H(),{user:n}=S(),[m]=l.useState(),[M,p]=l.useState(!1),[R,T]=l.useState(null),t=z({defaultValues:{vehicleType:"",vehicleNumber:"",date:j().format("YYYY-MM-DD"),inTime:j().format("HH:mm")},resolver:P(L)}),{handleSubmit:N}=t,_=async a=>{var s,r,f,g,v,w,y;if(await V("Are you sure you want to book ticket?",{title:"Please Confirm",subTitle:"You will be redirected to receipt page",buttonTitle:"Yes, I am sure"}))try{const i=await h.mutateAsync({api:(s=q)==null?void 0:s.bookTicket,data:{vehicle_no:a.vehicleNumber,vehicle_type:a.vehicleType,type_parking_space:"Organized",incharge_id:n==null?void 0:n.emp_id,area_id:(g=(f=(r=o==null?void 0:o.data)==null?void 0:r.data)==null?void 0:f.data[0])==null?void 0:g.location_id,in_time:a.inTime}});(v=i==null?void 0:i.data)!=null&&v.error?d.error("Something went wrong"):(d.success("Ticket Booked Successfully"),b(`/parking-app/in-receipt?receipt_no=${(y=(w=i==null?void 0:i.data)==null?void 0:w.data)==null?void 0:y.receipt_no}`,{replace:!0}))}catch{d.error("Something went wrong")}},k=async()=>{p(!0),T(null);const a=await I.createWorker({});await a.load(),await a.loadLanguage("eng"),await a.initialize("eng");const{data:{text:s}}=await a.recognize(m),r=s.split(`
`);t.setValue("vehicleNumber",r&&r.length>0?r[0].trim():""),await a.terminate(),p(!1)};return l.useEffect(()=>{m&&k()},[m]),e.jsx(C,{title:"Home",children:e.jsx("div",{className:"py-8 mx-auto px-4",children:e.jsx("div",{children:e.jsx("div",{className:"px-8",children:e.jsxs(B,{methods:t,onSubmit:N(_),children:[e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"flex justify-between items-center gap-6",children:[e.jsxs("div",{className:"flex justify-center items-center gap-1 ",children:[e.jsx("input",{type:"radio",id:"two_wheeler",name:"vehicleType",value:"two_wheeler",className:"w-4 h-4",onChange:a=>t.setValue("vehicleType",a.target.value),checked:t.watch("vehicleType")==="two_wheeler"}),e.jsx("label",{htmlFor:"two_wheeler",className:"text-gray-800 text-sm font-semibold",children:"Two Wheeler"})]}),e.jsxs("div",{className:"flex justify-center items-center gap-1 ",children:[e.jsx("input",{type:"radio",id:"four_wheeler",name:"vehicleType",value:"four_wheeler",className:"w-4 h-4",onChange:a=>t.setValue("vehicleType",a.target.value),checked:t.watch("vehicleType")==="four_wheeler"}),e.jsx("label",{htmlFor:"four_wheeler",className:"text-gray-800 text-sm font-semibold",children:"Four Wheeler"})]})]}),(t==null?void 0:t.formState.errors.vehicleType)&&!(t!=null&&t.watch("vehicleType"))&&e.jsx("small",{className:"text-red-500 text-xs flex justify-center mt-2",children:(x=t==null?void 0:t.formState.errors.vehicleType)==null?void 0:x.message})]}),e.jsx("div",{className:"py-3",children:e.jsx(D,{})}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 w-full",children:[e.jsx("div",{children:e.jsx(u,{className:"w-full h-10 border border-gray-300 rounded-lg",name:"vehicleNumber",label:"Vehicle Number",placeholder:"Enter Vehicle Number",inputValidation:["removeSpace","Uppercase","vehicleNumber"]})}),e.jsx("div",{children:e.jsx(u,{name:"date",label:"Date",type:"date",placeholder:"Enter Date"})}),e.jsx("div",{children:e.jsx(u,{name:"inTime",type:"time",label:"In Time",placeholder:"Enter In Time"})}),e.jsx("div",{className:"flex justify-center w-full mt-4",children:e.jsx(A,{isLoading:h.isPending,type:"submit",size:"sm",className:"w-full",children:"Book Ticket"})})]})]})})})})})}export{te as default};
