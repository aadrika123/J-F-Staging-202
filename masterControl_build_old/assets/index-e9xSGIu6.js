import{u as G,i as A,j as a,m as u,_ as c,r as n,k as ea,B as sa}from"./index-CE0lAO7R.js";import{a as ra}from"./index-C1-MkYab.js";import{C as ta,a as da,c as la,d as na}from"./card-CIsyB1je.js";import{S as K,a as ca,T as oa,b as ia,c as V,d as I,e as ua,f as b}from"./Spinner-Cpqkl0aS.js";import{a as Q,o as W,F as X,S as M,B as Y,c as Z,d as O,b as $}from"./SelectField-DUAu5PzZ.js";import"./input-DVxzQLqQ.js";import{g as aa}from"./services-KQnp_8oA.js";import{D as xa}from"./index-BjpmOdTO.js";import{L as pa,c as ha}from"./index.es-DwP9r8gU.js";import{L as ja}from"./label-CeDqEV9t.js";import{q as fa}from"./switch-BBMh81Tb.js";const ma=Z().shape({ulb_id:O().required("ulb id is required"),service_id:O().required("service id is required")});function ga({open:C,setOpen:k,title:T,edit:S,setEdit:L,serviceList:P}){var y,l,N,i,r,w,h;const B=G({}),x=Q({defaultValues:{ulb_id:0,service_id:0},resolver:W(ma)}),v=async s=>{var j,f,m,g;try{const t=await B.mutateAsync({api:(j=u)==null?void 0:j.createServiceMapping,data:s});(f=t==null?void 0:t.data)!=null&&f.success?(c.success((m=t==null?void 0:t.data)==null?void 0:m.message),k(!1),L(!1),P.refetch()):c.error((g=t==null?void 0:t.data)==null?void 0:g.message)}catch(t){c.error(aa(t))}},p=A({api:`${(y=u)==null?void 0:y.getAllJuidcoUlbList}`,key:"getAllJuidcoUlbList",options:{enabled:!0}}),o=A({api:`${(l=u)==null?void 0:l.serviceList}`,key:"serviceList",options:{enabled:!0}});return a.jsx(xa,{open:C,setOpen:k,title:T,setEdit:L,edit:S,children:a.jsx(X,{methods:x,onSubmit:x.handleSubmit(v),children:a.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[a.jsx("div",{children:a.jsx(M,{name:"service_id",data:((r=(i=(N=o==null?void 0:o.data)==null?void 0:N.data)==null?void 0:i.data)==null?void 0:r.map(s=>({value:s==null?void 0:s.id,label:s==null?void 0:s.service_name})))??[]})}),a.jsx("div",{children:a.jsx(M,{name:"ulb_id",data:((h=(w=p==null?void 0:p.data)==null?void 0:w.data)==null?void 0:h.map(s=>({value:s==null?void 0:s.id,label:s==null?void 0:s.ulb_name})))??[]})}),a.jsx(K,{}),a.jsx("div",{children:a.jsx(Y,{isLoading:x.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}const ba=Z().shape({ulbId:$(),moduleId:$(),complaintRefNo:$()});function Sa(){var h,s,j,f,m,g,t,F;const[C,k]=n.useState(1),T=G({}),[S,L]=n.useState(10),[P,B]=n.useState(!1);n.useState(""),n.useState("");const[x,v]=n.useState(!1),[p]=n.useState(""),[o,y]=n.useState(!1),l=Q({resolver:W(ba),defaultValues:{ulbId:"",moduleId:"",complaintTypeId:"",priorityId:"",targetTypeId:"",complaintSourceTypeId:"",fDate:"",toDate:"",complaintRefNo:""}}),N=async e=>{r==null||r.refetch()},i=ea({api:(h=u)==null?void 0:h.userManagementModuleList,key:"userManagementModuleList",options:{enabled:!0}}),r=A({api:`${(s=u)==null?void 0:s.getServiceMapping}`,key:"getServiceMapping",options:{enabled:!0}}),w=async e=>{var _,q,D,U,E,J,R,H,z;try{const d=await T.mutateAsync({api:`${(_=u)==null?void 0:_.updateServiceMapping}`,data:{id:e}});(q=d==null?void 0:d.data)!=null&&q.success?(r.refetch(),((U=(D=d==null?void 0:d.data)==null?void 0:D.data)==null?void 0:U.status)==1&&c.success((E=d.data)==null?void 0:E.message),((R=(J=d==null?void 0:d.data)==null?void 0:J.data)==null?void 0:R.status)==0&&c.error((H=d.data)==null?void 0:H.message)):c.error((z=d.data)==null?void 0:z.message)}catch(d){c.error(aa(d))}};return a.jsxs("main",{className:"grid items-start",children:[P&&a.jsx("div",{style:{zIndex:1001},className:"fixed left-0 top-0 z-50 flex h-full w-full items-center justify-center bg-white",children:a.jsxs("div",{className:"flex flex-col items-center justify-center",children:[a.jsx(pa,{className:"w-24",animationData:ha,loop:!0}),a.jsx("div",{className:"font-semibold",children:"Permission Updated"})]})}),a.jsx(ga,{open:x,setOpen:v,title:o?"Edit Service":"Add Service",id:p,edit:o,setEdit:y,serviceList:r}),a.jsx("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:a.jsxs(ta,{children:[a.jsx(X,{methods:l,onSubmit:l.handleSubmit(N),children:a.jsxs("div",{className:"grid grid-cols-4 gap-x-2 gap-y-4 bg-background px-10 pt-4",children:[a.jsxs("div",{children:[a.jsx(ja,{htmlFor:"moduleId",children:"Module name"}),a.jsx(M,{className:"cursor-pointer bg-background",name:"moduleId",data:((f=(j=i==null?void 0:i.data)==null?void 0:j.data)==null?void 0:f.map(e=>({value:e==null?void 0:e.id,label:e==null?void 0:e.module_name})))??[]})]}),a.jsx("div",{className:"mt-6 flex justify-start",children:a.jsx(Y,{variant:"secondary",isLoading:(m=l==null?void 0:l.formState)==null?void 0:m.isSubmitting,type:"submit",className:"float-right  w-auto px-10",children:"Search"})}),a.jsx("div",{className:"mt-6 flex justify-end",children:a.jsx(sa,{type:"button",className:"flex items-center gap-2",onClick:()=>v(!0),children:"Add New"})})]})}),a.jsx(da,{className:"px-7",children:a.jsx(la,{})}),a.jsx(na,{children:r!=null&&r.isLoading?a.jsx("div",{className:"flex h-32 items-center justify-center",children:a.jsx(ca,{})}):a.jsxs(a.Fragment,{children:[a.jsxs(oa,{children:[a.jsx(ia,{children:a.jsxs(V,{children:[a.jsx(I,{className:"",children:"#"}),a.jsx(I,{className:"",children:"Service"}),a.jsx(I,{className:"",children:"Module"}),a.jsx(I,{className:"",children:"ULB"})]})}),a.jsx(ua,{children:(F=(t=(g=r==null?void 0:r.data)==null?void 0:g.data)==null?void 0:t.data)==null?void 0:F.map((e,_)=>a.jsxs(V,{children:[a.jsx(b,{children:C*S-S+_+1}),a.jsx(b,{children:e==null?void 0:e.service_name}),a.jsx(b,{children:e==null?void 0:e.module_name}),a.jsx(b,{children:e==null?void 0:e.ulb_name}),a.jsx(b,{children:a.jsxs(fa,{checked:(e==null?void 0:e.status)==1,onChange:()=>w(e==null?void 0:e.id),className:`${e!=null&&e.status?"bg-primary":"bg-gray-200"} relative inline-flex items-center h-6 rounded-full w-11`,children:[a.jsx("span",{className:"sr-only",children:"Enable notifications"}),a.jsx("span",{className:`${e!=null&&e.status?"translate-x-6":"translate-x-1"} inline-block w-4 h-4 transform bg-white rounded-full`})]})})]},e==null?void 0:e.id))})]}),a.jsx(K,{className:"mb-2 mt-4"}),a.jsx("div",{className:"flex w-full justify-end"})]})})]})})]})}function $a(){return a.jsx(ra,{title:"JUIDCO Service Mapping",subTitle:"Control all services here",children:a.jsx("div",{children:a.jsx(Sa,{})})})}export{$a as default};
